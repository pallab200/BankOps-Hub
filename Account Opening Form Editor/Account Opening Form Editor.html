<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Account Opening Form Editor</title>
  <link href="assets/poppins.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/font-awesome.min.css">
  <style>
/* Modern Unified Design System with Animations */
:root {
  --primary: #6366f1;
  --primary-dark: #4f46e5;
  --primary-light: #818cf8;
  --primary-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
  --accent: #ec4899;
  --accent-light: #f472b6;
  --accent-gradient: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
  --success: #10b981;
  --success-light: #34d399;
  --success-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
  --warning: #f59e0b;
  --warning-light: #fbbf24;
  --warning-gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  --danger: #ef4444;
  --danger-light: #f87171;
  --danger-gradient: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  --info: #0ea5e9;
  --info-light: #38bdf8;
  --info-gradient: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
  --bg-primary: #f8fafc;
  --bg-secondary: #f1f5f9;
  --bg-gradient: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f1f5f9 100%);
  --text-primary: #0f172a;
  --text-secondary: #475569;
  --text-muted: #94a3b8;
  --border-color: #e2e8f0;
  --border-light: #f1f5f9;
  --card-bg: rgba(255, 255, 255, 0.98);
  --card-hover-bg: rgba(255, 255, 255, 1);
  --glass-bg: rgba(255, 255, 255, 0.85);
  --glass-border: rgba(255, 255, 255, 0.5);
  --shadow-xs: 0 1px 2px rgba(15, 23, 42, 0.04);
  --shadow-sm: 0 2px 8px rgba(15, 23, 42, 0.06);
  --shadow-md: 0 8px 30px rgba(15, 23, 42, 0.1);
  --shadow-lg: 0 20px 50px rgba(15, 23, 42, 0.15);
  --shadow-xl: 0 25px 60px rgba(15, 23, 42, 0.2);
  --shadow-glow: 0 0 40px rgba(99, 102, 241, 0.2);
  --shadow-glow-accent: 0 0 40px rgba(236, 72, 153, 0.15);
  --radius-xs: 6px;
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --radius-2xl: 32px;
  --transition-fast: 0.15s ease;
  --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-bounce: 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

/* Smooth scrolling */
html { scroll-behavior: smooth; }

body {
  font-family: 'Poppins', 'Segoe UI', Roboto, Arial, sans-serif;
  background: var(--bg-gradient);
  background-attachment: fixed;
  color: var(--text-primary);
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
}

/* Animated floating background shapes */
body::before,
body::after {
  content: '';
  position: fixed;
  border-radius: 50%;
  pointer-events: none;
  z-index: -1;
  opacity: 0.4;
  filter: blur(80px);
}

body::before {
  width: 600px;
  height: 600px;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(139, 92, 246, 0.1));
  top: -200px;
  right: -100px;
  animation: floatBg 20s ease-in-out infinite;
}

body::after {
  width: 500px;
  height: 500px;
  background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), rgba(168, 85, 247, 0.08));
  bottom: -150px;
  left: -100px;
  animation: floatBg 25s ease-in-out infinite reverse;
}

@keyframes floatBg {
  0%, 100% { transform: translate(0, 0) scale(1); }
  25% { transform: translate(30px, -30px) scale(1.05); }
  50% { transform: translate(-20px, 20px) scale(0.95); }
  75% { transform: translate(20px, 30px) scale(1.02); }
}

/* Keyframe Animations */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeInDown {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideInRight {
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-30px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.3); }
  50% { box-shadow: 0 0 35px rgba(99, 102, 241, 0.5); }
}

@keyframes rgbCycle {
  0% {
    color: #8b5cf6;
    text-shadow: 0 0 6px rgba(139,92,246,0.85), 0 0 18px rgba(139,92,246,0.45);
    transform: translateY(0);
  }
  25% {
    color: #ff6b6b;
    text-shadow: 0 0 6px rgba(255,107,107,0.85), 0 0 18px rgba(255,107,107,0.35);
    transform: translateY(-2px);
  }
  50% {
    color: #ffd166;
    text-shadow: 0 0 6px rgba(255,209,102,0.9), 0 0 20px rgba(255,209,102,0.25);
    transform: translateY(0);
  }
  75% {
    color: #4ade80;
    text-shadow: 0 0 6px rgba(74,222,128,0.85), 0 0 18px rgba(74,222,128,0.35);
    transform: translateY(2px);
  }
  100% {
    color: #8b5cf6;
    text-shadow: 0 0 6px rgba(139,92,246,0.85), 0 0 18px rgba(139,92,246,0.45);
    transform: translateY(0);
  }
}

.developer-credit {
  text-align: center;
  padding: 20px;
  margin-top: 30px;
  font-size: 1.1rem;
  font-weight: 600;
  letter-spacing: 1px;
  animation: rgbCycle 6s ease-in-out infinite;
}

.developer-credit.small {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 8px 14px;
  margin-top: 8px;
  font-size: 0.8rem;
  font-weight: 700;
  letter-spacing: 0.5px;
  border-radius: 20px;
  background: linear-gradient(135deg, rgba(99,102,241,0.08) 0%, rgba(139,92,246,0.06) 50%, rgba(236,72,153,0.05) 100%);
  color: #0f172a;
  box-shadow: 0 4px 15px rgba(15, 23, 42, 0.06), inset 0 1px 0 rgba(255,255,255,0.8);
  border: 1px solid rgba(99,102,241,0.1);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-transform: none;
  animation: rgbCycle 4s linear infinite;
}
  /* Footer RGB style: cooler, softer palette and smoother motion */
  .footer-rgb .rgb-text{
    padding:8px 14px;
    border-radius:999px;
    font-weight:600;
    background: linear-gradient(90deg,
      #5b21b6 0%,
      #7c3aed 12%,
      #ec4899 24%,
      #fb7185 36%,
      #f97316 48%,
      #f59e0b 60%,
      #06b6d4 72%,
      #0ea5a1 84%,
      #5b21b6 100%
    );
    background-size:300% 300%;
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
    -webkit-text-fill-color:transparent;
    animation: rgbShift 6s linear infinite;
    text-align:center;
  }
  @keyframes rgbShift{
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }
  @media (max-width:520px){
    .footer-rgb .rgb-text{font-size:0.92rem}
  }

/* Page Navigation - Enhanced */
.page-nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.95) 0%, rgba(79, 70, 229, 0.98) 50%, rgba(139, 92, 246, 0.95) 100%);
  padding: 14px 28px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 4px 30px rgba(99, 102, 241, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(255,255,255,0.1);
  animation: fadeInDown 0.5s ease-out;
}

.page-nav::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
  background-size: 200% 100%;
  animation: shimmer 3s infinite;
  pointer-events: none;
}

.page-nav h1 {
  color: white;
  font-size: 1.4rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 12px;
  text-shadow: 0 2px 10px rgba(0,0,0,0.2);
  animation: slideInLeft 0.6s ease-out;
}

.page-nav h1 i {
  font-size: 1.5rem;
  animation: float 3s ease-in-out infinite;
}

.nav-buttons {
  display: flex;
  align-items: center;
  gap: 12px;
  animation: slideInRight 0.6s ease-out;
}

.nav-btn {
  padding: 10px 22px;
  border-radius: var(--radius-md);
  border: none;
  cursor: pointer;
  font-weight: 600;
  font-size: 0.95rem;
  transition: var(--transition-normal);
  display: flex;
  align-items: center;
  gap: 8px;
  position: relative;
  overflow: hidden;
}

.nav-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: rgba(255,255,255,0.3);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.nav-btn:hover::before {
  width: 300px;
  height: 300px;
}

.nav-btn.active {
  background: white;
  color: var(--primary);
  box-shadow: 0 4px 20px rgba(255, 255, 255, 0.5), inset 0 1px 0 rgba(255,255,255,1);
  animation: pulse 2s ease-in-out infinite;
  font-weight: 700;
}

.nav-btn:not(.active) {
  background: rgba(255, 255, 255, 0.12);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.nav-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.nav-btn:active {
  transform: translateY(-1px);
}

/* Header Actions */
.header-actions {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-left: 16px;
  padding-left: 16px;
  border-left: 1px solid rgba(255,255,255,0.2);
}

.header-actions .btn {
  padding: 10px 18px;
  font-size: 0.85rem;
  font-weight: 600;
}

/* Page Containers - Enhanced */
.page-container {
  display: none;
  padding-top: 90px;
  min-height: 100vh;
  animation: fadeIn 0.4s ease-out;
}

.page-container.active {
  display: block;
}

/* Information Page Styles - Compact Variant */
.info-page {
  max-width: 1440px; /* reduced by ~10% */
  margin: 0 auto;
  padding: 18px; /* reduced by ~10% */
  padding-bottom: 90px; /* reduced by ~10% */
}

.form-sections {
  display: flex;
  flex-direction: column;
  gap: 11px; /* ~10% tighter */
}

.form-section {
  background: var(--card-bg);
  border-radius: var(--radius-xl);
  padding: 16px; /* ~10% tighter */
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border-color);
  transition: var(--transition-normal);
  animation: fadeInUp 0.45s ease-out backwards;
  position: relative;
  overflow: hidden;
  border-left: 4px solid transparent;
  background-image: linear-gradient(var(--card-bg), var(--card-bg)), linear-gradient(180deg, var(--primary), var(--accent));
  background-origin: border-box;
  background-clip: padding-box, border-box;
}

.form-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent), var(--primary));
  background-size: 200% 100%;
  opacity: 0;
  transition: var(--transition-normal);
}

.form-section:hover {
  transform: translateY(-6px);
  box-shadow: var(--shadow-lg), var(--shadow-glow);
  border-color: transparent;
}

.form-section:hover::before {
  opacity: 1;
  animation: shimmer 2s infinite;
}

/* Stagger animation for form sections */
.form-section:nth-child(1) { animation-delay: 0.1s; }
.form-section:nth-child(2) { animation-delay: 0.2s; }
.form-section:nth-child(3) { animation-delay: 0.3s; }
.form-section:nth-child(4) { animation-delay: 0.4s; }
.form-section:nth-child(5) { animation-delay: 0.5s; }
.form-section:nth-child(6) { animation-delay: 0.6s; }
.form-section:nth-child(7) { animation-delay: 0.7s; }
.form-section:nth-child(8) { animation-delay: 0.8s; }

.section-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 16px; /* ~10% reduced */
  padding-bottom: 11px;
  border-bottom: 1px solid var(--border-light);
  position: relative;
  cursor: pointer;
  user-select: none;
  transition: var(--transition-normal);
}

.section-header:hover {
  opacity: 0.95;
}

.section-toggle {
  margin-left: auto;
  font-size: 1rem;
  color: var(--text-muted);
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), color 0.2s ease, background 0.2s ease;
  padding: 10px;
  border-radius: var(--radius-sm);
  background: var(--bg-secondary);
}

.section-header:hover .section-toggle {
  color: var(--primary);
  background: rgba(99, 102, 241, 0.12);
}

.form-section.collapsed .section-toggle {
  transform: rotate(-90deg);
}

.form-section.collapsed .section-header {
  margin-bottom: 0;
  padding-bottom: 0;
  border-bottom: none;
}

/* Smooth collapse animation */
.form-fields {
  overflow: hidden;
  max-height: 2000px;
  opacity: 1;
  transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
              opacity 0.3s ease,
              padding 0.3s ease,
              margin 0.3s ease;
}

.form-section.collapsed .form-fields {
  max-height: 0;
  opacity: 0;
  padding-top: 0;
  padding-bottom: 0;
  margin: 0;
}

.form-section.collapsed .section-header::after {
  opacity: 0;
  transition: opacity 0.2s ease;
}

.section-header::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 80px;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  border-radius: 3px;
  transition: width 0.3s ease, opacity 0.2s ease;
}

.section-header i {
  font-size: 1.3rem;
  color: var(--primary);
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(139, 92, 246, 0.08));
  padding: 14px;
  border-radius: var(--radius-md);
  transition: var(--transition-normal);
  box-shadow: var(--shadow-xs);
}

.form-section:hover .section-header i {
  transform: scale(1.1) rotate(-5deg);
  background: linear-gradient(135deg, var(--primary), var(--accent));
  color: white;
  box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
}

.section-header h2 {
  font-size: 1.15rem;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: -0.02em;
  flex: 1;
}

/* Form Elements - Enhanced */
.form-group {
  margin-bottom: 18px;
  animation: fadeIn 0.3s ease-out backwards;
}

.form-group label {
  display: block;
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 8px;
  transition: var(--transition-fast);
}

/* Inline checkbox variant: place checkbox immediately left of its label text */
.form-group.checkbox-inline label {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 0;
  font-weight: 600;
  white-space: nowrap;
  flex-wrap: nowrap;
}

/* Generic inline checkbox wrapper for other checkbox/label pairs */
.checkbox-inline {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}
.checkbox-inline label {
  margin: 0;
  font-size: 0.85rem;
  white-space: nowrap;
}


.form-group:focus-within label {
  color: var(--primary);
  transform: translateX(2px);
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 14px 16px;
  border: 2px solid var(--border-color);
  border-radius: var(--radius-md);
  font-size: 0.95rem;
  font-family: inherit;
  transition: var(--transition-normal);
  background: linear-gradient(180deg, #ffffff 0%, #fafbfc 100%);
  color: var(--text-primary);
  box-shadow: var(--shadow-xs);
}

.form-group input::placeholder,
.form-group textarea::placeholder {
  color: var(--text-muted);
  font-weight: 400;
}

.form-group input:hover,
.form-group select:hover,
.form-group textarea:hover {
  border-color: var(--primary-light);
  background: #ffffff;
  box-shadow: var(--shadow-sm);
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15), var(--shadow-md);
  background: white;
}

.form-group textarea {
  resize: vertical;
  min-height: 90px;
}

/* Horizontal Form Layout */
.form-fields {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
}

.form-fields .form-group {
  margin-bottom: 0;
}

.form-fields .form-group.span-2 {
  grid-column: span 2;
}

.form-fields .form-group.span-3 {
  grid-column: span 3;
}

.form-fields .form-group.span-4 {
  grid-column: span 4;
}

/* Transaction Profile Styles */
.transaction-table-wrapper {
  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
  border-radius: 16px;
  padding: 0;
  box-shadow: 0 4px 20px rgba(15, 23, 42, 0.08), 0 0 0 1px rgba(148, 163, 184, 0.1);
  overflow: visible;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Layout: place deposits left and withdrawals right on wider screens */
#transaction-info .form-fields {
  display: grid;
  grid-template-columns: 1fr;
  gap: 24px;
  align-items: stretch;
}

@media (min-width: 900px) {
  #transaction-info .form-fields {
    grid-template-columns: 1fr 1fr;
  }
}

/* Make tables non-scrollable and avoid cutting content */
.table-responsive {
  overflow: visible; /* allow content to expand without inner scroll */
}

.transaction-table {
  width: 100%;
  table-layout: auto;
}

.transaction-table th,
.transaction-table td {
  white-space: normal;
  word-break: break-word;
  overflow: visible;
}

.table-input {
  min-width: 0;
  box-sizing: border-box;
}

.transaction-table-wrapper:hover {
  box-shadow: 0 8px 30px rgba(15, 23, 42, 0.12), 0 0 0 1px rgba(148, 163, 184, 0.15);
  transform: translateY(-2px);
}

.transaction-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 20px 24px;
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  border-bottom: 3px solid;
  position: relative;
  overflow: hidden;
}

.transaction-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, transparent 0%, rgba(255,255,255,0.05) 100%);
  pointer-events: none;
}

.transaction-header i {
  font-size: 20px;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  z-index: 1;
}

.transaction-header h3 {
  margin: 0;
  font-size: 18px;
  font-weight: 700;
  color: #ffffff;
  letter-spacing: 0.3px;
  z-index: 1;
  flex: 1;
}

.transaction-header .badge {
  padding: 6px 14px;
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  color: #ffffff;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  z-index: 1;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.deposit-header {
  border-bottom-color: #10b981;
}

.deposit-header i {
  color: #10b981;
  animation: depositPulse 2s ease-in-out infinite;
}

.withdrawal-header {
  border-bottom-color: #ef4444;
}

.withdrawal-header i {
  color: #ef4444;
  animation: withdrawalPulse 2s ease-in-out infinite;
}

@keyframes depositPulse {
  0%, 100% { transform: translateY(0); opacity: 1; }
  50% { transform: translateY(-3px); opacity: 0.8; }
}

@keyframes withdrawalPulse {
  0%, 100% { transform: translateY(0); opacity: 1; }
  50% { transform: translateY(3px); opacity: 0.8; }
}

.table-responsive {
  overflow-x: auto;
  width: 100%;
}

.transaction-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  background: #ffffff;
}

.transaction-table thead tr {
  background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
}

.transaction-table th {
  padding: 16px 20px;
  text-align: left;
  font-weight: 700;
  font-size: 13px;
  color: #334155;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 2px solid #cbd5e1;
  white-space: nowrap;
}

.transaction-table th.number-col,
.transaction-table th.amount-col,
.transaction-table th.total-col {
  text-align: center;
}

.transaction-table tbody tr {
  transition: all 0.2s ease;
  border-bottom: 1px solid #f1f5f9;
}

.transaction-table tbody tr:hover {
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
}

.transaction-table tbody tr.total-row {
  background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
  border-top: 2px solid #3b82f6;
}

.transaction-table tbody tr.total-row:hover {
  background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
}

.transaction-table td {
  padding: 16px 20px;
  font-size: 14px;
  color: #475569;
}

.transaction-table td.particulars-col {
  font-weight: 500;
}

.transaction-table td.number-col,
.transaction-table td.amount-col,
.transaction-table td.total-col {
  text-align: center;
}

.td-content {
  display: flex;
  align-items: center;
  gap: 12px;
}

.td-content i {
  font-size: 16px;
  color: #64748b;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
  border-radius: 8px;
  transition: all 0.2s ease;
}

.transaction-table tbody tr:hover .td-content i {
  background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
  color: #6366f1;
  transform: scale(1.1);
}

.td-content.total-label {
  font-weight: 700;
  color: #1e40af;
}

.td-content.total-label i {
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  color: #ffffff;
}

.table-input {
  width: 100%;
  padding: 10px 14px;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  color: #1e293b;
  background: #ffffff;
  transition: all 0.2s ease;
  text-align: center;
  font-family: 'Poppins', sans-serif;
}

/* Ensure deposit & withdrawal boxes are equal height on wide screens */
#transaction-info .form-fields > .transaction-table-wrapper {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.transaction-table-wrapper .table-responsive {
  /* allow table area to grow and push footer/total row to bottom */
  flex: 1 1 auto;
  min-height: 0; /* allow proper flexbox shrinking in Firefox/Chrome */
}

.transaction-header {
  flex: 0 0 auto;
}

.transaction-table {
  /* prevent inner horizontal scrolling by allowing wrap and auto layout */
  table-layout: auto;
}

.transaction-table th,
.transaction-table td {
  white-space: normal;
  word-break: break-word;
  overflow: visible;
}

.table-input:focus {
  outline: none;
  border-color: #3b82f6;
  background: #f0f9ff;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.table-input::placeholder {
  color: #94a3b8;
  font-weight: 400;
}

.table-input.total-input {
  background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
  border-color: #3b82f6;
  font-weight: 700;
  color: #1e40af;
  cursor: not-allowed;
}

.table-input.total-input:focus {
  background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
}

@media (max-width: 1200px) {
  .form-fields {
    grid-template-columns: repeat(3, 1fr);
  }
  .form-fields .form-group.span-4 {
    grid-column: span 3;
  }
}

@media (max-width: 900px) {
  .form-fields {
    grid-template-columns: repeat(2, 1fr);
  }
  .form-fields .form-group.span-3,
  .form-fields .form-group.span-4 {
    grid-column: span 2;
  }
}

@media (max-width: 600px) {
  .form-fields {
    grid-template-columns: 1fr;
  }
  .form-fields .form-group.span-2,
  .form-fields .form-group.span-3,
  .form-fields .form-group.span-4 {
    grid-column: span 1;
  }
  
  /* Transaction table responsive */
  .transaction-header {
    padding: 16px 18px;
    flex-wrap: wrap;
  }
  
  .transaction-header h3 {
    font-size: 16px;
  }
  
  .transaction-header i {
    width: 32px;
    height: 32px;
    font-size: 16px;
  }
  
  .transaction-header .badge {
    padding: 5px 12px;
    font-size: 11px;
  }
  
  .transaction-table th,
  .transaction-table td {
    padding: 12px 10px;
    font-size: 12px;
  }
  
  .transaction-table th {
    font-size: 11px;
  }
  
  .td-content {
    gap: 8px;
  }
  
  .td-content i {
    width: 28px;
    height: 28px;
    font-size: 14px;
  }
  
  .table-input {
    padding: 8px 10px;
    font-size: 13px;
  }
}

@media (max-width: 480px) {
  .transaction-table-wrapper {
    border-radius: 12px;
  }
  
  .transaction-header {
    padding: 14px 16px;
  }
  
  .transaction-table {
    font-size: 11px;
  }
  
  .transaction-table th,
  .transaction-table td {
    padding: 10px 8px;
  }
  
  .td-content span {
    font-size: 12px;
  }
  
  .td-content i {
    display: none;
  }
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.form-row-3 {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 16px;
}

/* Action Buttons - Compact Variant */
.action-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.98) 100%);
  backdrop-filter: blur(18px);
  -webkit-backdrop-filter: blur(18px);
  padding: 12px 18px; /* reduced padding */
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  box-shadow: 0 -8px 30px rgba(15, 23, 42, 0.08), inset 0 1px 0 rgba(255,255,255,0.85);
  z-index: 100;
  border-top: 1px solid rgba(226, 232, 240, 0.85);
  animation: fadeInUp 0.35s ease-out;
}

.action-bar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  border-radius: 0 0 4px 4px;
  opacity: 0.6;
}

.btn {
  padding: 10px 18px; /* reduced button padding */
  border-radius: 10px; /* slightly smaller radius */
  border: none;
  cursor: pointer;
  font-weight: 700;
  font-size: 0.92rem; /* slightly smaller text */
  transition: var(--transition-normal);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  position: relative;
  overflow: hidden;
  text-decoration: none;
  letter-spacing: 0.02em;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
  transition: left 0.5s ease;
}

.btn:hover::before {
  left: 100%;
}

.btn i {
  transition: var(--transition-bounce);
}

.btn:hover i {
  transform: scale(1.12) rotate(-4deg);
}

.btn-primary {
  background: var(--primary-gradient);
  color: white;
  box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-primary:hover {
  box-shadow: 0 8px 35px rgba(99, 102, 241, 0.5), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-secondary {
  background: linear-gradient(135deg, #64748b 0%, #475569 100%);
  color: white;
  box-shadow: 0 4px 15px rgba(71, 85, 105, 0.35), inset 0 1px 0 rgba(255,255,255,0.15);
}

.btn-secondary:hover {
  box-shadow: 0 8px 25px rgba(71, 85, 105, 0.45), inset 0 1px 0 rgba(255,255,255,0.15);
}

.btn-success {
  background: var(--success-gradient);
  color: white;
  box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-success:hover {
  box-shadow: 0 8px 35px rgba(16, 185, 129, 0.5), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-warning {
  background: var(--warning-gradient);
  color: white;
  box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-warning:hover {
  box-shadow: 0 8px 35px rgba(245, 158, 11, 0.5), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-danger {
  background: var(--danger-gradient);
  color: white;
  box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-danger:hover {
  box-shadow: 0 8px 35px rgba(239, 68, 68, 0.5), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-info {
  background: var(--info-gradient);
  color: white;
  box-shadow: 0 4px 20px rgba(14, 165, 233, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-info:hover {
  box-shadow: 0 8px 35px rgba(14, 165, 233, 0.5), inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn:hover {
  transform: translateY(-4px);
}

.btn:active {
  transform: translateY(-2px);
}

/* Form Preview Page - Enhanced */
.preview-page {
  padding: 24px;
  padding-bottom: 120px;
  animation: fadeIn 0.4s ease-out;
}

.preview-controls {
  max-width: 1000px;
  margin: 0 auto 28px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 16px;
  background: var(--card-bg);
  padding: 20px 28px;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-md);
  border: 1px solid var(--border-color);
  animation: fadeInDown 0.5s ease-out;
  position: relative;
  overflow: hidden;
}

.preview-controls::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent), var(--primary));
  background-size: 200% 100%;
  opacity: 0.5;
}

.page-selector {
  display: flex;
  align-items: center;
  gap: 12px;
}

.page-selector label {
  font-weight: 600;
  color: var(--text-secondary);
  display: flex;
  align-items: center;
  gap: 8px;
}

.page-selector label i {
  color: var(--primary);
}

.page-selector select {
  padding: 10px 18px;
  border: 2px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-size: 0.95rem;
  font-family: inherit;
  cursor: pointer;
  transition: var(--transition-normal);
}

.page-selector select:hover {
  border-color: var(--primary-light);
}

.page-selector select:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
  outline: none;
}

.preview-actions {
  display: flex;
  gap: 12px;
}

.preview-container {
  max-width: 1000px;
  margin: 0 auto;
}

/* Make on-screen form preview text uppercase (excluding images) */
.preview-container .form-page,
.preview-container .form-page *:not(img) {
  text-transform: uppercase;
}
.preview-container .overlay,
.preview-container .overlay-empty {
  text-transform: uppercase;
}
/* Hide overlays that are marked empty in the preview (don't show placeholder labels) */
.preview-container .overlay.overlay-empty { display: none; }

/* Form Page Cards - Enhanced */
.form-page {
  display: none;
  position: relative;
  background: white;
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-lg);
  margin-bottom: 28px;
  transition: var(--transition-normal);
  animation: scaleIn 0.5s ease-out backwards;
  border: 1px solid var(--border-color);
}

.form-page:nth-child(1) { animation-delay: 0.1s; }
.form-page:nth-child(2) { animation-delay: 0.2s; }
.form-page:nth-child(3) { animation-delay: 0.3s; }
.form-page:nth-child(4) { animation-delay: 0.4s; }
.form-page:nth-child(5) { animation-delay: 0.5s; }
.form-page:nth-child(6) { animation-delay: 0.6s; }

.form-page:hover {
  box-shadow: var(--shadow-xl), 0 0 0 3px var(--primary-light);
  transform: translateY(-4px);
}

.form-page.active {
  display: block;
}

.form-page img {
  width: 100%;
  height: auto;
  display: block;
}

/* Text Overlays */
.overlay {
  position: absolute;
  color: #000;
  font-size: 13px;
  font-weight: 500;
  font-family: 'Times New Roman', Times, serif;
  pointer-events: none;
  white-space: nowrap;
}

.overlay.editing {
  pointer-events: auto;
  cursor: move;
  background: rgba(255, 243, 205, 0.9);
  border: 1px dashed #b71c1c;
  padding: 2px 4px;
}

.overlay-empty {
  color: #999;
  font-style: italic;
}

/* Static overlay styled like a textbox for labels such as AML Tracking Number */
.overlay-static {
  border: 1px solid rgba(0,0,0,0.9);
  background: rgba(255,255,255,0.9);
  padding: 6px 8px;
  border-radius: 4px;
  min-width: 160px;
  text-align: center;
  pointer-events: none;
}

/* Checkbox / tick overlays — larger so ticks are more visible (digits kept small) */
.overlay-check {
  position: absolute;
  font-size: 22px;
  font-weight: 700;
  color: #000;
  pointer-events: none;
  line-height: 1;
}

/* Larger text for the printed/preview date overlay */
.overlay[data-field="todayDate"] {
  font-size: 15px;
  font-weight: 400;
}

/* Toast Notification - Enhanced */
.overlay[data-field="dob"],
.overlay[data-field="nomineeDob"] {
  font-size: 15px;
  font-weight: 400;
}

.toast {
  position: fixed;
  bottom: 140px;
  left: 50%;
  transform: translateX(-50%) translateY(30px);
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  color: white;
  padding: 18px 32px;
  border-radius: var(--radius-lg);
  font-weight: 600;
  font-size: 0.95rem;
  z-index: 2000;
  opacity: 0;
  transition: var(--transition-normal);
  box-shadow: 0 15px 50px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255,255,255,0.1);
  display: flex;
  align-items: center;
  gap: 12px;
  border: 1px solid rgba(255,255,255,0.1);
}

.toast::before {
  content: '✓';
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 26px;
  height: 26px;
  background: var(--success-gradient);
  border-radius: 50%;
  font-size: 0.85rem;
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
}

.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

/* Others Popup - Enhanced */
.others-popup-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1200;
  /* removed outer padding so modal can sit flush to edges */
  padding: 0;
  backdrop-filter: blur(4px);
  animation: fadeIn 0.3s ease-out;
}

.others-popup-backdrop.open {
  display: flex;
}

.others-popup {
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  /* Increased width for wide screens */
  max-width: 1100px;
  /* occupy full available width of backdrop (no outer gap) */
  width: 100%;
  margin: 0 auto;
  max-height: 90vh;
  overflow-y: auto;
  border: 1px solid var(--border-color);
  animation: scaleIn 0.3s ease-out;
}

.others-popup-header {
  padding: 24px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  position: relative;
  overflow: hidden;
}

.others-popup-header::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 100%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
  animation: float 6s ease-in-out infinite;
}

.others-popup-header h3 {
  font-size: 1.3rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 12px;
  position: relative;
  z-index: 1;
}

.others-popup-header i {
  font-size: 1.4rem;
}

.others-popup-close {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition-normal);
  position: relative;
  z-index: 1;
}

.others-popup-close:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: rotate(90deg);
}

.others-popup-body {
  padding: 28px;
}

.others-info-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-bottom: 0;
}

/* Editable inputs inside Others popup */
.others-input,
.others-popup select {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  font-family: inherit;
  font-size: 0.95rem;
  background: #fff;
  color: var(--text-primary);
  box-shadow: none;
}

.others-input:focus,
.others-popup select:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(99,102,241,0.06);
}

.others-info-item {
  background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
  padding: 18px;
  border-radius: var(--radius-md);
  border: 1px solid var(--border-color);
  transition: var(--transition-normal);
}

.others-info-item:hover,
.kyc-field:hover {
  background: #f8fafc;
}

.others-info-item label {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 10px;
  font-size: 0.95rem;
}

.others-info-item label i {
  color: var(--primary);
  font-size: 1.1rem;
}

.others-info-value {
  font-size: 1rem;
  font-weight: 600;
  color: var(--text-primary);
  word-break: break-word;
  padding: 8px 0;
}

/* Make all popup fields share the same simple container/label/value styling */
.others-popup .others-info-item,
.others-popup .kyc-field {
  padding: 8px;
  border-radius: 6px;
  background: #fff;
  border: 1px solid #e0e7f1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.others-popup .others-info-item label,
.others-popup .kyc-field label {
  margin: 0 0 4px 0;
  color: #64748b;
  font-size: 0.9rem;
  font-weight: 500;
}

.others-popup .others-info-value,
.others-popup .kyc-value {
  padding: 0;
  margin: 0;
  font-size: 0.9rem;
  font-weight: 400;
  color: #1e293b;
}

.others-popup input.others-input,
.others-popup textarea.others-input,
.others-popup select.others-input {
  width: 100%;
  box-sizing: border-box;
  padding: 6px 8px;
  font-size: 0.9rem;
  background: #fff;
  border: 1px solid #e0e7f1;
  border-radius: 4px;
  font-family: inherit;
  color: #1e293b;
}

/* Prevent textarea in Others popup from being resizable (match Transection Profile appearance) */
.others-popup textarea,
.others-popup textarea.others-input,
.others-popup .others-info-item textarea,
.others-popup .kyc-field textarea {
  resize: none;
}

.others-kyc-section {
  margin-top: 18px;
}

.kyc-fields-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.kyc-field {
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
  padding: 14px;
  border-radius: var(--radius-sm);
  border: 1px solid #bae6fd;
}

.kyc-field label {
  display: block;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 8px;
  font-size: 0.9rem;
}

.kyc-value {
  font-size: 0.95rem;
  font-weight: 500;
  color: var(--text-primary);
  word-break: break-word;
}

@media (max-width: 1024px) {
  .others-info-grid,
  .kyc-fields-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .others-popup {
    max-width: 90%;
  }
  .others-info-grid {
    grid-template-columns: 1fr;
  }
  .kyc-fields-grid {
    grid-template-columns: 1fr;
  }
  .others-popup-body {
    padding: 20px;
  }
}


/* Saved Presets Panel - Enhanced */
.presets-panel {
  position: fixed;
  top: 0;
  right: -420px;
  width: 400px;
  height: 100%;
  background: var(--card-bg);
  box-shadow: -8px 0 40px rgba(0, 0, 0, 0.15);
  z-index: 1100;
  transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  border-left: 1px solid var(--border-color);
}

.presets-panel.open {
  right: 0;
}

.presets-header {
  padding: 24px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  overflow: hidden;
}

.presets-header::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 100%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
  animation: float 6s ease-in-out infinite;
}

.presets-header h3 {
  font-size: 1.15rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 12px;
  position: relative;
}

.presets-close {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 1.2rem;
  transition: var(--transition-normal);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.presets-close:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: rotate(90deg);
}

.presets-list {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  background: var(--bg-primary);
}

.preset-item {
  background: white;
  border-radius: var(--radius-md);
  padding: 18px;
  margin-bottom: 14px;
  cursor: pointer;
  transition: var(--transition-normal);
  border: 2px solid var(--border-color);
  animation: fadeInUp 0.3s ease-out backwards;
}

.preset-item:nth-child(1) { animation-delay: 0.1s; }
.preset-item:nth-child(2) { animation-delay: 0.15s; }
.preset-item:nth-child(3) { animation-delay: 0.2s; }
.preset-item:nth-child(4) { animation-delay: 0.25s; }
.preset-item:nth-child(5) { animation-delay: 0.3s; }

.preset-item:hover {
  border-color: var(--primary);
  transform: translateX(-6px);
  box-shadow: var(--shadow-md);
}

.preset-item h4 {
  font-size: 1rem;
  margin-bottom: 8px;
  color: var(--text-primary);
  font-weight: 700;
}

.preset-item p {
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.preset-actions {
  display: flex;
  gap: 10px;
  margin-top: 14px;
}

.preset-btn {
  padding: 8px 16px;
  border-radius: var(--radius-sm);
  border: none;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 600;
  transition: var(--transition-normal);
}

.preset-btn.load {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
}

.preset-btn.load:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
}

.preset-btn.delete {
  background: linear-gradient(135deg, var(--danger), #dc2626);
  color: white;
}

.preset-btn.delete:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
}

/* Overlay for panel backdrop - Enhanced */
.panel-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(15, 23, 42, 0.6);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  z-index: 1050;
  opacity: 0;
  visibility: hidden;
  transition: var(--transition-normal);
}

.panel-backdrop.show {
  opacity: 1;
  visibility: visible;
}

/* Edit mode toggle - Enhanced */
.edit-toggle {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 14px;
  background: var(--bg-primary);
  border-radius: var(--radius-sm);
  transition: var(--transition-normal);
}

.edit-toggle:hover {
  background: var(--bg-secondary);
}

.edit-toggle input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: var(--primary);
}

.edit-toggle label {
  cursor: pointer;
  font-weight: 600;
  font-size: 0.9rem;
  color: var(--text-secondary);
  display: flex;
  align-items: center;
  gap: 8px;
}

.edit-toggle label i {
  color: var(--primary);
}

/* Print styles */
@media print {
  @page {
    margin: 0;
    padding: 0;
    size: auto;
  }
  
  .page-nav, .action-bar, .preview-controls, .toast, .presets-panel, .panel-backdrop {
    display: none !important;
  }
  
  /* Remove all margins and paddings from body and all containers */
  body {
    margin: 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
  }
  
  html {
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .page-container {
    padding: 0 !important;
    margin: 0 !important;
    height: auto !important;
  }
  
  .preview-page {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  .preview-container {
    margin: 0 !important;
    padding: 0 !important;
    max-width: none !important;
  }
  
  .form-page {
    box-shadow: none !important;
    border-radius: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    animation: none !important;
    page-break-after: auto !important;
    page-break-inside: avoid !important;
    border: none !important;
    height: auto !important;
    display: block !important;
  }
  
  .form-page:not(.active) {
    display: none !important;
  }
  
  .form-page:last-child {
    margin-bottom: 0 !important;
    page-break-after: avoid !important;
  }
  
  /* Ensure images fit perfectly within page bounds */
  .form-page img {
    display: block !important;
    width: 100% !important;
    height: auto !important;
    max-width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    page-break-inside: avoid !important;
    page-break-after: avoid !important;
  }

  /* Make all printable text uppercase while keeping images unchanged */
  .form-page, .form-page *:not(img) {
    text-transform: uppercase !important;
  }
  /* Ensure overlays are uppercase too */
  .overlay, .overlay-empty {
    text-transform: uppercase !important;
  }
  /* Do not print placeholder overlays when empty */
  .form-page .overlay.overlay-empty { display: none !important; }
}

/* Responsive - Enhanced */
@media (max-width: 1024px) {
  .header-actions {
    display: none;
  }
  
  .info-page {
    padding: 16px;
  }
  
  .form-sections {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  .page-nav {
    padding: 10px 16px;
  }
  
  .page-nav h1 {
    font-size: 1.1rem;
  }
  
  .page-nav h1 span {
    display: none;
  }
  
  .form-sections {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  
  .form-section {
    padding: 20px;
    border-radius: var(--radius-lg);
  }
  
  .form-row, .form-row-3 {
    grid-template-columns: 1fr;
  }
  
  .nav-btn span {
    display: none;
  }
  
  .nav-btn {
    padding: 10px 14px;
  }
  
  .presets-panel {
    width: 100%;
    right: -100%;
  }
  
  .action-bar {
    padding: 14px 16px;
    gap: 10px;
  }
  
  .btn {
    padding: 12px 18px;
    font-size: 0.85rem;
  }
  
  .btn span {
    display: none;
  }
  
  .preview-controls {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: var(--bg-primary);
  border-radius: 5px;
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, var(--primary-light), var(--primary));
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
}

/* Focus visible for accessibility */
:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

/* Selection color */
::selection {
  background: var(--primary-light);
  color: white;
}

/* Left Slide Menu */
.slide-menu-toggle {
  position: fixed;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  z-index: 1001;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: #fff;
  border: none;
  border-radius: 0 var(--radius-md) var(--radius-md) 0;
  padding: 14px 9px; /* slightly reduced */
  cursor: pointer;
  box-shadow: var(--shadow-md);
  transition: var(--transition-normal);
  display: flex;
  align-items: center;
  justify-content: center;
}
.slide-menu-toggle:hover {
  padding-left: 14px;
  background: linear-gradient(135deg, var(--primary-dark), var(--accent));
}
.slide-menu-toggle i {
  font-size: 1.2rem;
}

.slide-menu-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.4);
  z-index: 1002;
  opacity: 0;
  visibility: hidden;
  transition: var(--transition-normal);
}
.slide-menu-backdrop.show {
  opacity: 1;
  visibility: visible;
}

.slide-menu {
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  width: 252px; /* reduced by 10% */
  max-width: 85vw;
  background: var(--card-bg);
  z-index: 1003;
  box-shadow: var(--shadow-lg);
  transform: translateX(-100%);
  transition: var(--transition-normal);
  display: flex;
  flex-direction: column;
}
.slide-menu.open {
  transform: translateX(0);
}
.slide-menu-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px; /* slightly reduced */
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: #fff;
}
.slide-menu-header h3 {
  font-size: 1.1rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 10px;
}
.slide-menu-close {
  background: rgba(255,255,255,0.2);
  border: none;
  color: #fff;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition-fast);
}
.slide-menu-close:hover {
  background: rgba(255,255,255,0.3);
}
.slide-menu-body {
  flex: 1;
  overflow-y: auto;
  padding: 14px; /* slightly reduced */
}
.slide-menu-nav {
  list-style: none;
}
.slide-menu-nav li {
  margin-bottom: 4px;
}
.slide-menu-nav a {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  border-radius: var(--radius-md);
  color: var(--text-primary);
  text-decoration: none;
  font-weight: 500;
  transition: var(--transition-fast);
}
.slide-menu-nav a:hover {
  background: var(--bg-secondary);
  color: var(--primary);
}
.slide-menu-nav a i {
  width: 20px;
  text-align: center;
  color: var(--primary);
}

/* Account Type Popup */
.account-type-popup-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(15, 23, 42, 0.6);
  backdrop-filter: blur(4px);
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}
.account-type-popup-backdrop.show {
  opacity: 1;
  visibility: visible;
}
.account-type-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  background: var(--card-bg);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  width: 90%;
  max-width: 600px;
  max-height: 80vh;
  overflow: hidden;
  z-index: 2001;
  opacity: 0;
  visibility: hidden;
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s ease;
}
.account-type-popup-backdrop.show .account-type-popup {
  opacity: 1;
  visibility: visible;
  transform: translate(-50%, -50%) scale(1);
}
.account-type-popup-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
}
.account-type-popup-header h3 {
  font-size: 1.1rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 10px;
}
.account-type-popup-close {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  cursor: pointer;
  transition: var(--transition-fast);
}
.account-type-popup-close:hover {
  background: rgba(255,255,255,0.3);
}
.account-type-popup-body {
  padding: 16px 20px;
  max-height: 60vh;
  overflow-y: auto;
}
.account-type-table {
  width: 100%;
  border-collapse: collapse;
}
.account-type-table th,
.account-type-table td {
  padding: 12px 14px;
  text-align: left;
  border-bottom: 1px solid var(--border-color);
}
.account-type-table th {
  background: var(--bg-secondary);
  font-weight: 600;
  color: var(--text-primary);
  position: sticky;
  top: 0;
}
.account-type-table tr:hover td {
  background: rgba(99, 102, 241, 0.05);
}
.account-type-table td:first-child {
  font-weight: 600;
  color: var(--primary);
}
.account-type-table .action-btns {
  display: flex;
  gap: 6px;
  justify-content: flex-end;
}
.account-type-table .action-btns button {
  padding: 6px 10px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.8rem;
  transition: var(--transition-fast);
}
.account-type-table .btn-edit {
  background: var(--primary-light);
  color: white;
}
.account-type-table .btn-edit:hover {
  background: var(--primary);
}
.account-type-table .btn-delete {
  background: var(--danger-light);
  color: white;
}
.account-type-table .btn-delete:hover {
  background: var(--danger);
}
.account-type-add-form {
  display: flex;
  gap: 10px;
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border-color);
}
.account-type-add-form input {
  flex: 1;
  padding: 10px 12px;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  font-size: 0.9rem;
}
.account-type-add-form input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}
.account-type-add-form button {
  padding: 10px 16px;
  background: var(--success);
  color: white;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition-fast);
  display: flex;
  align-items: center;
  gap: 6px;
}
.account-type-add-form button:hover {
  background: #059669;
}
.account-type-empty {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-muted);
}
.account-type-empty i {
  font-size: 2.5rem;
  margin-bottom: 12px;
  display: block;
}

/* Officer Seal Popup */
.officer-seal-popup-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(15, 23, 42, 0.6);
  backdrop-filter: blur(4px);
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}
.officer-seal-popup-backdrop.show {
  opacity: 1;
  visibility: visible;
}
.officer-seal-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  background: var(--card-bg);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  width: 80%;
  max-width: 648px;
  overflow: hidden;
  z-index: 2001;
  opacity: 0;
  visibility: hidden;
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s ease;
}
.officer-seal-popup-backdrop.show .officer-seal-popup {
  opacity: 1;
  visibility: visible;
  transform: translate(-50%, -50%) scale(1);
}
.officer-seal-popup-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: linear-gradient(135deg, #059669 0%, #047857 100%);
  color: white;
}
.officer-seal-popup-header h3 {
  font-size: 0.88rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}
.officer-seal-popup-close {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  cursor: pointer;
  transition: var(--transition-fast);
}
.officer-seal-popup-close:hover {
  background: rgba(255,255,255,0.3);
}
.officer-seal-popup-body {
  padding: 18px;
  overflow-y: visible;
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.officer-seal-fields {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 22px;
  padding-bottom: 22px;
  border-bottom: 2px solid var(--border-color);
}
.officer-seal-field {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.officer-seal-field label {
  font-weight: 700;
  color: var(--primary);
  font-size: 0.78rem;
  display: flex;
  align-items: center;
  gap: 6px;
}
.officer-seal-field label i {
  font-size: 0.9rem;
}
.officer-seal-field input,
.officer-seal-field textarea {
  padding: 10px 11px;
  border: 2px solid var(--border-color);
  border-radius: 6px;
  font-size: 0.70rem;
  transition: var(--transition-fast);
  font-family: inherit;
  resize: vertical;
}
.officer-seal-field textarea {
  min-height: 80px;
  line-height: 1.3;
}
.officer-seal-field input:focus,
.officer-seal-field textarea:focus {
  outline: none;
  border-color: #059669;
  box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.15);
  background: rgba(5, 150, 105, 0.02);
}
.seal-preview-section {
  margin-bottom: 0;
  text-align: center;
  flex-shrink: 0;
}
.seal-preview-title {
  font-weight: 700;
  color: var(--text-secondary);
  margin-bottom: 12px;
  font-size: 0.78rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.seal-preview {
  display: flex;
  justify-content: center;
  gap: 19px;
  margin-bottom: 20px;
  flex-wrap: nowrap;
}
.seal-item {
  width: 114px;
  height: 114px;
  border: none;
  border-radius: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-size: 0.53rem;
  font-weight: 800;
  color: #000;
  padding: 10px;
  word-break: break-word;
  background: rgba(0, 0, 0, 0.02);
  line-height: 1.2;
  overflow: hidden;
  position: relative;
  box-shadow: none;
}
.seal-item::before {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 0;
  background: none;
  opacity: 0;
  pointer-events: none;
}
.seal-item-text {
  position: relative;
  z-index: 1;
  white-space: pre-wrap;
}
.seal-example {
  text-align: center;
  padding: 10px;
  background: rgba(5, 150, 105, 0.08);
  border-radius: 6px;
  margin-bottom: 12px;
  font-size: 0.70rem;
  color: var(--text-secondary);
}
.seal-example strong {
  color: #000;
  display: block;
  margin-bottom: 6px;
}
.seal-example-item {
  width: 81px;
  height: 81px;
  border: none;
  border-radius: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-size: 0.65rem;
  font-weight: 800;
  color: #000;
  padding: 8px;
  margin: 12px auto;
  background: rgba(0, 0, 0, 0.02);
  line-height: 1.2;
  box-shadow: none;
}
.officer-seal-save-btn {
  width: 100%;
  padding: 14px 24px;
  background: linear-gradient(135deg, #059669 0%, #047857 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: var(--transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}
.officer-seal-save-btn:hover {
  box-shadow: 0 4px 15px rgba(5, 150, 105, 0.4);
  transform: translateY(-2px);
}
.officer-seal-save-btn:active {
  transform: translateY(0);
}

@media (max-width: 1024px) {
  .officer-seal-fields {
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
  }
}
@media (max-width: 768px) {
  .officer-seal-fields {
    grid-template-columns: 1fr;
    gap: 14px;
  }
  .seal-preview {
    gap: 16px;
  }
  .seal-item {
    width: 120px;
    height: 120px;
  }
}

@media print {
  .slide-menu-toggle, .slide-menu-backdrop, .slide-menu { display: none !important; }
  .account-type-popup-backdrop { display: none !important; }
  .officer-seal-popup-backdrop { display: none !important; }
  /* Ensure officer seals appear in print */
  .overlay[data-field*="Seal"] {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    background: rgba(0, 0, 0, 0.02) !important;
    color: #000 !important;
  }
}
  </style>
</head>
<body>
  <!-- Left Slide Menu Toggle -->
  <button class="slide-menu-toggle" id="slideMenuToggle" title="Open Menu"><i class="fas fa-bars"></i></button>
  <!-- Slide Menu Backdrop -->
  <div class="slide-menu-backdrop" id="slideMenuBackdrop"></div>
  <!-- Slide Menu Panel -->
  <div class="slide-menu" id="slideMenu">
    <div class="slide-menu-header">
      <h3><i class="fas fa-list"></i> Quick Navigation</h3>
      <button class="slide-menu-close" id="slideMenuClose"><i class="fas fa-times"></i></button>
    </div>
    <div class="slide-menu-body">
      <div class="slide-quick-field" style="padding:5px 7px; border-bottom:1px solid var(--border-color);">
        <label for="slideBranchInput" style="display:block; font-weight:600; color:var(--text-secondary); margin-bottom:3px; font-size:0.95rem;">Branch Name</label>
        <input id="slideBranchInput" type="text" placeholder="Branch name" style="width:100%; padding:6px 8px; border-radius:4px; border:1px solid var(--border-color); font-size:0.95rem;">
      </div>
      <ul class="slide-menu-nav" style="padding:7px; display:flex; flex-direction:column; gap:5px;">
        <li style="margin-bottom:2.5px;"><a href="#" id="slideMenuAccountType"><i class="fas fa-list-alt"></i> Type of Account</a></li>
        <li style="margin-bottom:2.5px;"><a href="#" id="slideMenuOfficerSeal"><i class="fas fa-stamp"></i> Officer Seal</a></li>
        <li style="margin-bottom:2.5px;"><a href="#" id="slideMenuSavePreset"><i class="fas fa-save"></i> Save Preset</a></li>
        <li style="margin-bottom:2.5px;"><a href="#" id="slideMenuPresets"><i class="fas fa-folder-open"></i> Presets</a></li>
        <li style="margin-bottom:2.5px;"><a href="#" id="slideMenuExport"><i class="fas fa-file-export"></i> Export</a></li>
        <li style="margin-bottom:2.5px;"><a href="#" id="slideMenuImport"><i class="fas fa-file-import"></i> Import</a></li>
      </ul>
      <div style="padding:6px;border-top:1px solid var(--border-color); margin-top:4px; display:flex; justify-content:center;">
        <div class="developer-credit small footer-rgb" style="margin:0;"><span class="rgb-text">Developed by Tanzil Ahmed — EID 7966.</span></div>
      </div>
    </div>
  </div>

  <!-- Account Type Popup -->
  <div class="account-type-popup-backdrop" id="accountTypeBackdrop">
    <div class="account-type-popup">
      <div class="account-type-popup-header">
        <h3><i class="fas fa-list-alt"></i> Type of Account</h3>
        <button class="account-type-popup-close" id="accountTypeClose"><i class="fas fa-times"></i></button>
      </div>
      <div class="account-type-popup-body">
        <div class="account-type-add-form">
          <input type="text" id="accountTypeCode" placeholder="Product Code">
          <input type="text" id="accountTypeName" placeholder="Type of Account">
          <button type="button" id="addAccountTypeBtn"><i class="fas fa-plus"></i> Add</button>
        </div>
        <table class="account-type-table">
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Type of Account</th>
              <th style="width:100px; text-align:right;">Actions</th>
            </tr>
          </thead>
          <tbody id="accountTypeTableBody">
            <!-- Rows will be added dynamically -->
          </tbody>
        </table>
        <div class="account-type-empty" id="accountTypeEmpty">
          <i class="fas fa-folder-open"></i>
          <p>No account types added yet.<br>Use the form above to add one.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Officer Seal Popup -->
  <div class="officer-seal-popup-backdrop" id="officerSealBackdrop">
    <div class="officer-seal-popup">
      <div class="officer-seal-popup-header">
        <h3><i class="fas fa-stamp"></i> Officer Seal</h3>
        <button class="officer-seal-popup-close" id="officerSealClose"><i class="fas fa-times"></i></button>
      </div>
      <div class="officer-seal-popup-body">
        <div class="officer-seal-fields">
          <div class="officer-seal-field">
            <label for="officer1Name"><i class="fas fa-user-tie"></i> Officer 1</label>
            <textarea id="officer1Name" placeholder="Name&#10;Designation&#10;Bank/Organization&#10;Branch&#10;ID/Reference"></textarea>
          </div>
          <div class="officer-seal-field">
            <label for="officer2Name"><i class="fas fa-user-tie"></i> Officer 2</label>
            <textarea id="officer2Name" placeholder="Name&#10;Designation&#10;Bank/Organization&#10;Branch&#10;ID/Reference"></textarea>
          </div>
          <div class="officer-seal-field">
            <label for="officer3Name"><i class="fas fa-user-tie"></i> Officer 3</label>
            <textarea id="officer3Name" placeholder="Name&#10;Designation&#10;Bank/Organization&#10;Branch&#10;ID/Reference"></textarea>
          </div>
        </div>
        <div class="officer-seal-controls" style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">
          <label for="officerSealSize" style="font-weight:600;color:var(--text-secondary);">Seal Size</label>
          <input id="officerSealSize" type="range" min="80" max="220" value="140" />
          <span id="officerSealSizeValue" style="min-width:56px;display:inline-block;text-align:left;">140px</span>
        </div>
        <div class="seal-preview-section">
          <div class="seal-preview-title"><i class="fas fa-square"></i> Seal Preview</div>
          <div class="seal-preview">
            <div class="seal-item" id="sealPreview1"><div class="seal-item-text">Officer 1</div></div>
            <div class="seal-item" id="sealPreview2"><div class="seal-item-text">Officer 2</div></div>
            <div class="seal-item" id="sealPreview3"><div class="seal-item-text">Officer 3</div></div>
          </div>
        </div>
        <button type="button" class="officer-seal-save-btn" id="saveOfficerSealBtn"><i class="fas fa-save"></i> Save Officer Seals</button>
      </div>
    </div>
  </div>

  <!-- Others Popup -->
  <div class="others-popup-backdrop" id="othersBackdrop">
    <div class="others-popup">
        <div class="others-popup-header">
          <h3>KYC, TP, SBS Information</h3>
          <button class="others-popup-close" id="othersClose"><i class="fas fa-times"></i></button>
        </div>
      <div class="others-popup-body">
        <div class="others-info-grid">
          <div class="others-info-item">
            <label>Account Number</label>
            <div class="others-info-value" id="othersAccountNumber">—</div>
          </div>
          <div class="others-info-item">
            <label>Applicant Name</label>
            <div class="others-info-value" id="othersFullName">—</div>
          </div>
          <div class="others-info-item">
            <label>National ID (NID)</label>
            <div class="others-info-value" id="othersNID">—</div>
          </div>
          <div class="others-info-item">
            <label>Birth Certificate No.</label>
            <div class="others-info-value" id="othersBirthCertNo">—</div>
          </div>
          <div class="others-info-item">
            <label>Passport No.</label>
            <div class="others-info-value" id="othersPassportNo">—</div>
          </div>
          <div class="others-info-item">
            <label>Occupation/Profession (In details)</label>
            <div class="others-info-value" id="othersOccupation">—</div>
          </div>
          <div class="others-info-item">
            <label>Monthly Income (BDT)</label>
            <div class="others-info-value" id="othersMonthlyIncome">—</div>
          </div>
          <div class="others-info-item">
            <label>Number of Deposit/Withdrawal</label>
            <div class="others-info-value" id="othersNumberOfDepositWithdrawal">—</div>
          </div>
          <div class="others-info-item">
            <label>Transection Profile</label>
            <div class="others-info-value" id="kycTransection">—</div>
          </div>
          <div class="others-info-item">
            <label>Sector Code</label>
            <div class="others-info-value" id="kycSectorCode">—</div>
          </div>
          <div class="others-info-item">
            <label>Occupation/Profession (SBS)</label>
            <div class="others-info-value" id="kycOccupationProfession">—</div>
          </div>
          <div class="others-info-item">
            <label>Source of Fund</label>
            <div class="others-info-value" id="kycSourceOfFund">—</div>
          </div>
          <div class="others-info-item">
            <label>Client's Business</label>
            <div class="others-info-value" id="kycClientBusiness">—</div>
          </div>
          <div class="others-info-item">
            <label>Client's Profession</label>
            <div class="others-info-value" id="kycClientProfession">—</div>
          </div>
          <div class="others-info-item">
            <label>Type of On-boarding Score</label>
            <div class="others-info-value" id="kycTypeOfOnboarding">—</div>
          </div>
        </div>
        <div class="others-kyc-section">
          <div class="kyc-fields-grid">
            <!-- Type of On-boarding Score moved to the top info grid -->
            <div class="kyc-field">
              <label>PEP/IP/CEO</label>
              <div class="kyc-value" id="kycPepIpCeo">—</div>
            </div>
            <div class="kyc-field">
              <label>Close Associate of PEP/IP/CEO</label>
              <div class="kyc-value" id="kycCloseAssociatePep">—</div>
            </div>
            <div class="kyc-field">
              <label>Customer's Avg Yearly Transaction</label>
              <div class="kyc-value" id="kycAvgYearlyTransaction">—</div>
            </div>
            <div class="kyc-field">
              <label>Credible Source of Funds?</label>
              <div class="kyc-value" id="kycCredibleSourceOfFunds">—</div>
            </div>
            <div class="kyc-field">
              <label>Source(s) of Funds Verify</label>
              <div class="kyc-value" id="kycSourceOfFundsVerify">—</div>
            </div>
            <div class="kyc-field">
              <label>Beneficial Owner(s)</label>
              <div class="kyc-value" id="kycBeneficialOwners">—</div>
            </div>
            <div class="kyc-field" style="display:flex; align-items:center; justify-content:space-between; padding:12px; gap:8px;">
              <button type="button" id="popupPrintOthersBtn" class="btn btn-info" style="padding:10px 16px; font-size:0.9rem;"><i class="fas fa-print"></i> Print KYC, TP, SBS</button>
              <select id="popupPrintTargetSelect" style="padding:8px 10px; border:1px solid #ccc; border-radius:6px; font-size:0.9rem; width:220px; text-align:left;">
                <option value="accountHolder">Account Holder</option>
                <option value="secondApplicant" style="display:none;">2nd Applicant</option>
                <option value="thirdApplicant" style="display:none;">3rd Applicant</option>
                <option value="guardian" style="display:none;">Guardian</option>
                <option value="beneficialOwner" style="display:none;">Beneficial Owner</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page Navigation -->
  <nav class="page-nav">
    <h1><i class="fas fa-file-alt"></i>Account Opening Form</h1>
    <div class="nav-buttons">
      <button class="nav-btn active" data-page="info"><i class="fas fa-edit"></i> <span>Information Input</span></button>
      <button class="nav-btn" data-page="form"><i class="fas fa-file-image"></i> <span>Form Preview</span></button>
      <div class="header-actions">
        <button class="btn btn-info" id="othersBtn" title="View KYC, TP, SBS Information"><i class="fas fa-info-circle"></i> <span>KYC, TP, SBS Information</span></button>
      </div>
    </div>
  </nav>

  <!-- Page 1: Information Input -->
  <div class="page-container active" id="info-page">
    <div class="info-page">
      <form id="account-form">
        <!-- Hidden branch field (moved to Quick Navigation) -->
        <input type="hidden" name="branchName" id="branchNameHidden">
        <div class="form-sections">
          
          <!-- Personal Information -->
          <div class="form-section" id="personal-info">
            <div class="section-header">
              <i class="fas fa-user"></i>
              <h2>Personal Information</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields">
              <div class="form-group">
                <label>Full Name (English)</label>
                <input type="text" name="fullNameEn" placeholder="Enter full name in English">
              </div>
              <div class="form-group">
                <label>Full Name (Bangla)</label>
                <input type="text" name="fullNameBn" placeholder="পূর্ণ নাম বাংলায়">
              </div>
              <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" name="dob">
              </div>
              <div class="form-group">
                <label>Gender</label>
                <select name="accountGender">
                  <option value="">Select Gender</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                </select>
              </div>
              <div class="form-group">
                <label>Father's Name</label>
                <input type="text" name="fatherName" placeholder="Father's full name">
              </div>
              <div class="form-group">
                <label>Mother's Name</label>
                <input type="text" name="motherName" placeholder="Mother's full name">
              </div>
              <div class="form-group">
                <label>Spouse's Name</label>
                <input type="text" name="spouseName" placeholder="Spouse's full name">
              </div>
              <div class="form-group">
                <label>National ID (NID)</label>
                <input type="text" name="nid" placeholder="Enter NID number">
              </div>
              <div class="form-group">
                <label>Passport No.</label>
                <input type="text" name="passportNo" placeholder="Enter passport number">
              </div>
              <div class="form-group">
                <label>Birth Certificate No.</label>
                <input type="text" name="birthCertNo" placeholder="Enter birth certificate number">
              </div>
              <div class="form-group">
                <label>E-TIN Number</label>
                <input type="text" name="etin" placeholder="Enter E-TIN number">
              </div>
              <div class="form-group">
                <label>Mobile Number</label>
                <input type="tel" name="mobile" placeholder="01XXXXXXXXX">
              </div>
              <div class="form-group">
                <label>Email Address</label>
                <input type="email" name="email" placeholder="example@email.com">
              </div>
              <div class="form-group">
                <label>Occupation/Profession (In details)</label>
                <input type="text" name="occupation" placeholder="Occupation / Profession">
              </div>
              <div class="form-group">
                <label>Monthly Income (BDT)</label>
                <input type="text" name="monthlyIncome" placeholder="Monthly income">
              </div>
              <div class="form-group">
                <label>Source of Fund</label>
                <input type="text" name="sourceOfFund" placeholder="Source of fund">
              </div>
            </div>
          </div>
          <!-- Guardian Information (New - similar to Beneficial Owner) -->
          <div class="form-section" id="guardian-info-new">
            <div class="section-header">
              <i class="fas fa-user-shield"></i>
              <h2>Guardian Information</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields" style="display:grid; grid-template-columns: repeat(4, 1fr); gap:12px;">
              <div class="form-group">
                <label>Name of Guardian (In English)</label>
                <input type="text" name="gNameEn" placeholder="Enter name in English">
              </div>
              <div class="form-group">
                <label>Name of Guardian (In Bangla)</label>
                <input type="text" name="gNameBn" placeholder="Guardians name in Bangla">
              </div>
              <div class="form-group">
                <label>AML Tracking Number</label>
                <input type="text" name="gAmlTrackingNumber" placeholder="AML Tracking Number">
              </div>
              <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" name="gDob">
              </div>
              <div class="form-group">
                <label>Father's Name</label>
                <input type="text" name="gFatherName" placeholder="Father's full name">
              </div>
              <div class="form-group">
                <label>Mother's Name</label>
                <input type="text" name="gMotherName" placeholder="Mother's full name">
              </div>
              <div class="form-group">
                <label>Spouse Name</label>
                <input type="text" name="gSpouseName" placeholder="Spouse's full name">
              </div>
              <div class="form-group">
                <label>Gender</label>
                <select name="gGender">
                  <option value="">Select Gender</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div class="form-group">
                <label>National ID No</label>
                <input type="text" name="gNid" placeholder="Enter National ID no">
              </div>
              <div class="form-group">
                <label>Passport No</label>
                <input type="text" name="gPassport" placeholder="Enter Passport no">
              </div>
              <div class="form-group">
                <label>Birth Registration No</label>
                <input type="text" name="gBirthReg" placeholder="Enter Birth Registration no">
              </div>
              <div class="form-group">
                <label>Phone Number</label>
                <input type="tel" name="gPhone" placeholder="01XXXXXXXXX">
              </div>
              <div class="form-group">
                <label>Email Address</label>
                <input type="email" name="gEmail" placeholder="example@email.com">
              </div>
              <div class="form-group">
                <label>Occupation (In detail)</label>
                <input type="text" name="gOccupation" placeholder="Occupation in detail">
              </div>
              <div class="form-group">
                <label>Monthly Income</label>
                <input type="text" name="gMonthlyIncome" placeholder="Monthly income">
              </div>
              <div class="form-group">
                <label>Source of fund (In detail)</label>
                <input type="text" name="gSourceOfFund" placeholder="Source of fund in detail">
              </div>
              <div class="form-group">
                <label>TIN No. (If any)</label>
                <input type="text" name="gTin" placeholder="TIN number (if any)">
              </div>
              <div class="form-group">
                <label>Nationality</label>
                <input type="text" name="gNationality" placeholder="Nationality" value="Bangladeshi">
              </div>

              <!-- Present Address header full width -->
              <div class="form-group span-4">
                <label style="font-weight:700;">Present Address</label>
              </div>
              <div class="form-group">
                <label>House, Street, Block, Sector</label>
                <input type="text" name="gPresentHouse" placeholder="House, Street, Block, Sector">
              </div>
              <div class="form-group">
                <label>Area / Village</label>
                <input type="text" name="gPresentArea" placeholder="Area / Village">
              </div>
              <div class="form-group">
                <label>Post Office</label>
                <input type="text" name="gPresentPO" placeholder="Post Office">
              </div>
              <div class="form-group">
                <label>Upazila/Thana</label>
                <input type="text" name="gPresentThana" placeholder="Upazila/Thana">
              </div>
              <div class="form-group">
                <label>District</label>
                <input type="text" name="gPresentDistrict" placeholder="District">
              </div>
              <div class="form-group">
                <label>Post Code</label>
                <input type="text" name="gPresentPostCode" placeholder="Post Code">
              </div>
              <div class="form-group">
                <label>Country</label>
                <input type="text" name="gPresentCountry" value="Bangladesh">
              </div>
              <!-- Nearest Landmark removed for guardian present address -->

              <!-- Permanent Address header with inline Same-as-Present checkbox -->
              <div class="form-group span-4" style="display:flex; align-items:center; justify-content:flex-start; gap:8px;">
                <label style="font-weight:700; margin:0;">Permanent Address</label>
                <div class="checkbox-inline" style="margin:0 0 0 4px;">
                  <label style="margin:0;"><input type="checkbox" id="gSameAddress" style="margin-right:4px; vertical-align:middle;">Same as Present Address</label>
                </div>
              </div>
              <div class="form-group">
                <label>House, Street, Block, Sector</label>
                <input type="text" name="gPermanentHouse" placeholder="House, Street, Block, Sector">
              </div>
              <div class="form-group">
                <label>Area / Village</label>
                <input type="text" name="gPermanentArea" placeholder="Area / Village">
              </div>
              <div class="form-group">
                <label>Post Office</label>
                <input type="text" name="gPermanentPO" placeholder="Post Office">
              </div>
              <div class="form-group">
                <label>Upazila/Thana</label>
                <input type="text" name="gPermanentThana" placeholder="Upazila/Thana">
              </div>
              <div class="form-group">
                <label>District</label>
                <input type="text" name="gPermanentDistrict" placeholder="District">
              </div>
              <div class="form-group">
                <label>Post Code</label>
                <input type="text" name="gPermanentPostCode" placeholder="Post Code">
              </div>
              <div class="form-group">
                <label>Country</label>
                <input type="text" name="gPermanentCountry" value="Bangladesh">
              </div>
              <!-- Nearest Landmark removed for guardian permanent address -->

              <!-- Client's Business & Profession removed for Guardian section -->
            </div>
          </div>

          <!-- Introducer Information (moved here) -->
          <div class="form-section" id="introducer-info">
            <div class="section-header">
              <i class="fas fa-handshake"></i>
              <h2>Introducer Information</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields">
              <div class="form-group">
                <label>Introducer Name</label>
                <input type="text" name="introducerName" placeholder="Introducer's full name">
              </div>
              <div class="form-group">
                <label>Introducer Date of Birth</label>
                <input type="date" name="introducerDob">
              </div>
              <div class="form-group">
                <label>Introducer Account Number</label>
                <input type="text" name="introducerAccount" placeholder="Introducer's account number">
              </div>
            </div>
          </div>

          <!-- Account Information -->
          <div class="form-section" id="account-info">
            <div class="section-header">
              <i class="fas fa-university"></i>
              <h2>Account Information</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields">
              <div class="form-group">
                <label>Account Number</label>
                <input type="text" name="accountNumber" placeholder="Account number">
                <input type="hidden" name="accountNumberNoSpace" />
              </div>
              <div class="form-group">
                <label>CIF Number</label>
                <input type="text" name="cif" placeholder="CIF number">
              </div>
              <div class="form-group">
                <label>Account Ownership</label>
                <select name="accountOwnership">
                  <option value="">Select Ownership</option>
                  <option value="single" selected>Single</option>
                  <option value="joint">Joint</option>
                </select>
              </div>
              <div class="form-group owner-joint-only" style="display:none;">
                <label>2nd Applicant Name</label>
                <input type="text" name="secondApplicantName" placeholder="Second applicant full name">
              </div>
              <div class="form-group owner-joint-only" style="display:none;">
                <label>3rd Applicant Name</label>
                <input type="text" name="thirdApplicantName" placeholder="Third applicant full name">
              </div>
              <div class="form-group">
                <label>Initial Deposit (BDT)</label>
                <input type="text" name="initialDeposit" placeholder="Initial deposit amount">
              </div>
              <div class="form-group">
                <label>AML Tracking Number</label>
                <input type="text" name="amlTrackingNumber" placeholder="AML Tracking Number">
              </div>
              <div class="form-group">
                <label>RM Code</label>
                <input type="text" name="rmCode" placeholder="RM Code">
              </div>
              <div class="form-group">
                <label>Cheque Book</label>
                <select name="chequeBook">
                  <option value="">Select</option>
                  <option value="Yes">Yes</option>
                  <option value="No">No</option>
                </select>
              </div>
              <div class="form-group">
                <label>Debit Card</label>
                <select name="debitCard">
                  <option value="">Select</option>
                  <option value="Yes">Yes</option>
                  <option value="No">No</option>
                </select>
              </div>
              <div class="form-group">
                <label>ISR Bank</label>
                <input type="text" name="isrBank" placeholder="ISR Bank">
              </div>
              <div class="form-group">
                <label>ISR Customer</label>
                <input type="text" name="isrCustomer" placeholder="ISR Customer">
              </div>
            </div>
          </div>

          
          <div class="form-section" id="present-address">
            <div class="section-header">
              <i class="fas fa-map-marker-alt"></i>
              <h2>Present Address</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields">
              <div class="form-group">
                <label>House/Holding No.</label>
                <input type="text" name="presentHouse" placeholder="House/Holding number">
              </div>
              <div class="form-group">
                <label>Area/Village</label>
                <input type="text" name="presentRoad" placeholder="Area/Village">
              </div>
              <div class="form-group">
                <label>Post Office</label>
                <input type="text" name="presentPO" placeholder="Post Office">
              </div>
              <div class="form-group">
                <label>Post Code</label>
                <input type="text" name="presentPostCode" placeholder="Post Code">
              </div>
              <div class="form-group">
                <label>Thana/Upazila</label>
                <input type="text" name="presentThana" placeholder="Thana/Upazila">
              </div>
              <div class="form-group">
                <label>District</label>
                <input type="text" name="presentDistrict" placeholder="District">
              </div>
              <div class="form-group">
                <label>Country</label>
                <input type="text" name="presentCountry" value="Bangladesh">
              </div>
            </div>
          </div>

          <!-- Permanent Address -->
          <div class="form-section" id="permanent-address">
            <div class="section-header">
              <i class="fas fa-home"></i>
              <h2>Permanent Address</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields">
              <div class="form-group span-4 checkbox-inline">
                <label><input type="checkbox" id="sameAddress"> Same as Present Address</label>
              </div>
              <div class="form-group">
                <label>House/Holding No.</label>
                <input type="text" name="permanentHouse" placeholder="House/Holding number">
              </div>
              <div class="form-group">
                <label>Area/Village</label>
                <input type="text" name="permanentRoad" placeholder="Area/Village">
              </div>
              <div class="form-group">
                <label>Post Office</label>
                <input type="text" name="permanentPO" placeholder="Post Office">
              </div>
              <div class="form-group">
                <label>Post Code</label>
                <input type="text" name="permanentPostCode" placeholder="Post Code">
              </div>
              <div class="form-group">
                <label>Thana/Upazila</label>
                <input type="text" name="permanentThana" placeholder="Thana/Upazila">
              </div>
              <div class="form-group">
                <label>District</label>
                <input type="text" name="permanentDistrict" placeholder="District">
              </div>
              <div class="form-group">
                <label>Country</label>
                <input type="text" name="permanentCountry" value="Bangladesh">
              </div>
            </div>
          </div>

          <!-- Nominee Information -->
          <div class="form-section" id="nominee-info">
            <div class="section-header">
              <i class="fas fa-user-shield"></i>
              <h2>Nominee Information</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields">
              <div class="form-group">
                <label>Nominee Name</label>
                <input type="text" name="nomineeName" placeholder="Nominee's full name">
              </div>
              <div class="form-group">
                <label>Nominee Date of Birth</label>
                <input type="date" name="nomineeDob">
              </div>
              <div class="form-group">
                <label>Relationship</label>
                <input type="text" name="nomineeRelation" placeholder="e.g., Father, Mother, Spouse">
              </div>
              <div class="form-group">
                <label>Nominee NID</label>
                <input type="text" name="nomineeNid" placeholder="Nominee's NID number">
              </div>
              <div class="form-group">
                <label>Nominee Mobile</label>
                <input type="tel" name="nomineeMobile" placeholder="Nominee's mobile number">
              </div>
              <div class="form-group">
                <label>Share (%)</label>
                <input type="text" name="nomineeShare" value="100" placeholder="Percentage">
              </div>
              <div class="form-group span-2">
                <label>Nominee Address</label>
                <div class="checkbox-inline">
                  <input type="checkbox" id="nomineeSameAddress" name="nomineeSameAddress">
                  <label for="nomineeSameAddress">Same as Account Holder Present Address</label>
                </div>
                <textarea name="nomineeAddress" placeholder="Nominee's complete address"></textarea>
              </div>
            </div>
          </div>
            <!-- Guardian Information (moved here) -->
            <div class="form-section" id="guardian-info">
              <div class="section-header">
                <i class="fas fa-user-shield"></i>
                <h2>Guardian Information (Nominee)</h2>
                <i class="fas fa-chevron-down section-toggle"></i>
              </div>
              <div class="form-fields">
                <div class="form-group">
                  <label>Guardian's Name</label>
                  <input type="text" name="guardianName" placeholder="Guardian's full name">
                </div>
                <div class="form-group">
                  <label>Relationship with Nominee</label>
                  <input type="text" name="guardianRelation" placeholder="Relationship with nominee">
                </div>
                <div class="form-group">
                  <label>Guardian NID</label>
                  <input type="text" name="guardianNid" placeholder="Guardian's NID number">
                </div>
                <div class="form-group">
                  <label>Phone / Mobile No.</label>
                  <input type="tel" name="guardianMobile" placeholder="Guardian's phone/mobile number">
                </div>
                <div class="form-group span-2">
                  <label>Guardian Permanent Address</label>
                  <div class="checkbox-inline">
                    <input type="checkbox" id="guardianSameAddress" name="guardianSameAddress">
                    <label for="guardianSameAddress">Same as Account Holder Present Address</label>
                  </div>
                  <textarea name="guardianPermanentAddress" placeholder="Guardian's permanent address"></textarea>
                </div>
              </div>
            </div>

            <!-- KYC Information -->
          <div class="form-section" id="kyc-info-main">
            <div class="section-header">
              <i class="fas fa-id-card"></i>
              <h2>KYC, TP, SBS Information</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:12px;">
              <!-- Row 1 -->
              <div class="form-group">
                <label>Occupation/Profession (SBS)</label>
                <input type="text" name="occupationProfession" placeholder="Enter Occupation/Profession" />
              </div>
              <div class="form-group">
                <label>Number of Deposit/Withdrawal</label>
                <input type="text" name="numberOfDepositWithdrawal" placeholder="Enter number of deposit/withdrawal" />
              </div>
              <div class="form-group">
                <label>Transection Profile</label>
                <input type="text" name="transectionProfile" placeholder="Enter Transection Profile" />
              </div>
              <div class="form-group">
                <label>Sector Code</label>
                <input type="text" name="sectorCode" placeholder="Enter Sector Code" list="sectorCodeHints" title="Farmer/Fishermen 901009; Businessmen/Industrialists 903009; NRB 910500; Service Holders 911000; Professionals/Self-employed 910000; Foreign Individuals 912050; Housewives 915001; Students 915002; Minor/Autistics/Disabled 915003; Retired 915004; Old/Widowed/Distressed 915005; Land Lords/Ladies 915006; Other Local Individuals 915059" />
                <datalist id="sectorCodeHints">
                  <option value="901009">Farmer/Fishermen</option>
                  <option value="903009">Businessmen/Industrialists</option>
                  <option value="910500">Non-Resident Bangladeshi</option>
                  <option value="911000">Service Holders (Salaried Person)</option>
                  <option value="910000">Professionals and Self-employed Persons</option>
                  <option value="912050">Foreign Individuals</option>
                  <option value="915001">Housewives</option>
                  <option value="915002">Students</option>
                  <option value="915003">Minor/Autistics/Disabled and other dependent persons</option>
                  <option value="915004">Retired Persons</option>
                  <option value="915005">Old/Widowed/Distressed person</option>
                  <option value="915006">Land Lords/Ladies</option>
                  <option value="915059">Other Local Individuals not mentioned above</option>
                </datalist>
              </div>

              <!-- Row 2 -->
              <div class="form-group">
                <label>Client's Business</label>
                <select name="clientBusiness">
                  <option value="">Select Client's Business</option>
                  <option value="Jewelry/Gold/Valuable Metals Business|5">Jewelry/Gold/Valuable Metals Business — Score: 5</option>
                  <option value="NGO/NPO|5">NGO/NPO — Score: 5</option>
                  <option value="Money Changer/Courier Service/Mobile Banking Agent|5">Money Changer/Courier Service/Mobile Banking Agent — Score: 5</option>
                  <option value="Film Production/Distribution agency|5">Film Production/Distribution agency — Score: 5</option>
                  <option value="Real Estate Developer/Agent|5">Real Estate Developer/Agent — Score: 5</option>
                  <option value="Mobile phone operator/Internet or cable TV operator|5">Mobile phone operator/Internet or cable TV operator — Score: 5</option>
                  <option value="Promoter/Contractor-Construction Projects|5">Promoter/Contractor-Construction Projects — Score: 5</option>
                  <option value="Intermediary of buying/selling of land/house|5">Intermediary of buying/selling of land/house — Score: 5</option>
                  <option value="Art and Antiquities Dealer|5">Art and Antiquities Dealer — Score: 5</option>
                  <option value="Insurance/brokerage agency|5">Insurance/brokerage agency — Score: 5</option>
                  <option value="Restaurant/Bar/Night Club/Parlour/Residential Hotel|5">Restaurant/Bar/Night Club/Parlour/Residential Hotel — Score: 5</option>
                  <option value="Islamic Institute/organization & educational Institute|5">Islamic Institute/organization & educational Institute — Score: 5</option>
                  <option value="Export/Import & Export/Import Agent|5">Export/Import & Export/Import Agent — Score: 5</option>
                  <option value="Trust|5">Trust — Score: 5</option>
                  <option value="Manpower export|5">Manpower export — Score: 5</option>
                  <option value="Business (Petrol Pump/CNG Station)|5">Business (Petrol Pump/CNG Station) — Score: 5</option>
                  <option value="Firearms|5">Firearms — Score: 5</option>
                  <option value="Ship Breaking business|5">Ship Breaking business — Score: 5</option>
                  <option value="RMG/Garments Accessories/packaging/Buying House|5">RMG/Garments Accessories/packaging/Buying House — Score: 5</option>
                  <option value="Bank/leasing/Finance Company|4">Bank/leasing/Finance Company — Score: 4</option>
                  <option value="Share/Stocks dealer, broker, portfolio manager, merchant banker|5">Share/Stocks dealer, broker, portfolio manager, merchant banker — Score: 5</option>
                  <option value="Business (Indenting)|4">Business (Indenting) — Score: 4</option>
                  <option value="Software/Information and Technology business|5">Software/Information and Technology business — Score: 5</option>
                  <option value="Business (outsourcing)|4">Business (outsourcing) — Score: 4</option>
                  <option value="Offshore/Non-Resident Corporation|5">Offshore/Non-Resident Corporation — Score: 5</option>
                  <option value="Law firm/engineering firm/consultancy firm|4">Law firm/engineering firm/consultancy firm — Score: 4</option>
                  <option value="Fuel & electricity Producing company|4">Fuel & electricity Producing company — Score: 4</option>
                  <option value="Service Provider|3">Service Provider — Score: 3</option>
                  <option value="Print & Electronic Media|4">Print & Electronic Media — Score: 4</option>
                  <option value="Tobacco and Cigarettes Business|3">Tobacco and Cigarettes Business — Score: 3</option>
                  <option value="Travel Agent/Tourism Company|4">Travel Agent/Tourism Company — Score: 4</option>
                  <option value="Amusement Park/Entertainment Provider|3">Amusement Park/Entertainment Provider — Score: 3</option>
                  <option value="Merchant over 10 million investments in business|4">Merchant over 10 million investments in business — Score: 4</option>
                  <option value="Motor Parts Trader/Workshop|3">Motor Parts Trader/Workshop — Score: 3</option>
                  <option value="Chain Store/shopping mall|4">Chain Store/shopping mall — Score: 4</option>
                  <option value="Poultry/dairy/fishing firm|2">Poultry/dairy/fishing firm — Score: 2</option>
                  <option value="Freight/Shipping/Cargo Agent/C&F agent|4">Freight/Shipping/Cargo Agent/C&F agent — Score: 4</option>
                  <option value="Agro business/rice mill/beverage|2">Agro business/rice mill/beverage — Score: 2</option>
                  <option value="Automobiles business (New or Reconditioned)|4">Automobiles business (New or Reconditioned) — Score: 4</option>
                  <option value="Small Business (Investment below BDT 5 million)|2">Small Business (Investment below BDT 5 million) — Score: 2</option>
                  <option value="Leather/Leather goods Business|4">Leather/Leather goods Business — Score: 4</option>
                  <option value="Computer/Mobile Phone Dealer|2">Computer/Mobile Phone Dealer — Score: 2</option>
                  <option value="Construction Materials Trader|4">Construction Materials Trader — Score: 4</option>
                  <option value="Manufacturer (except weapons)|2">Manufacturer (except weapons) — Score: 2</option>
                  <option value="Business Agent|3">Business Agent — Score: 3</option>
                  <option value="Transport Operator|3">Transport Operator — Score: 3</option>
                  <option value="Thread/'Jhut' Merchant|3">Thread/'Jhut' Merchant — Score: 3</option>
                  <option value="Business (medicine production and Marketing)|3">Business (medicine production and Marketing) — Score: 3</option>
                  <option value="Cold storage business|3">Cold storage business — Score: 3</option>
                  <option value="Business (Advertisement)|3">Business (Advertisement) — Score: 3</option>
                  <option value="Others|01-05">Others — Score: 01-05</option>
                </select>
              </div>
              <div class="form-group">
                <label>Client's Profession</label>
                <select name="clientProfession">
                  <option value="">Select Client's Profession</option>
                  <option value="Pilot/Flight Attendant|5">Pilot/Flight Attendant — Score: 5</option>
                  <option value="High Official of Multinational Company (MNC)|4">High Official of Multinational Company (MNC) — Score: 4</option>
                  <option value="Trustee|5">Trustee — Score: 5</option>
                  <option value="Homemaker|4">Homemaker — Score: 4</option>
                  <option value="Professional (Journalist, Lawyer, Doctor, Engineer, Chartered Accountant, etc.)|4">Professional (Journalist, Lawyer, Doctor, Engineer, Chartered Accountant, etc.) — Score: 4</option>
                  <option value="Information Technology (IT) sector employee|4">Information Technology (IT) sector employee — Score: 4</option>
                  <option value="Director (Private/Public Limited Company)|4">Director (Private/Public Limited Company) — Score: 4</option>
                  <option value="Athlete/Media Celebrity/Producer/Director|4">Athlete/Media Celebrity/Producer/Director — Score: 4</option>
                  <option value="Freelance Software Developer|4">Freelance Software Developer — Score: 4</option>
                  <option value="Teacher (Public/Private/Autonomous Educational Institution)|2">Teacher (Public/Private/Autonomous Educational Institution) — Score: 2</option>
                  <option value="Government service|3">Government service — Score: 3</option>
                  <option value="Private Sector Employee|2">Private Sector Employee — Score: 2</option>
                  <option value="Landlord/Homeowner|3">Landlord/Homeowner — Score: 3</option>
                  <option value="Self-employed Professional|2">Self-employed Professional — Score: 2</option>
                  <option value="Private Service: Managerial|3">Private Service: Managerial — Score: 3</option>
                  <option value="Student|2">Student — Score: 2</option>
                  <option value="Retiree|1">Retiree — Score: 1</option>
                  <option value="Farmer/Fisherman/Labourer|1">Farmer/Fisherman/Labourer — Score: 1</option>
                  <option value="Others:|01-05">Others: — Score: 01-05</option>
                </select>
              </div>
              <div class="form-group">
                <label>Type of On-boarding Score</label>
                <select name="typeOfOnboardingScore">
                  <option value="">Select Type of On-boarding</option>
                  <option value="Branch/Relationship Manager|2" selected>Branch/Relationship Manager — Score: 2</option>
                  <option value="Direct Sales Agent|3">Direct Sales Agent — Score: 3</option>
                  <option value="Walk in|3">Walk in — Score: 3</option>
                  <option value="Internet/Self check-in/other non-face to face|5">Internet/Self check-in/other non-face to face — Score: 5</option>
                </select>
              </div>

              <!-- Row 3 -->
              <div class="form-group">
                <label>PEP/IP/CEO</label>
                <select name="pepIpCeo">
                  <option value="">Select PEP/IP/CEO</option>
                  <option value="No|0" selected>No — Score: 0</option>
                  <option value="Yes|5">Yes — Score: 5</option>
                </select>
              </div>
              <div class="form-group">
                <label>Close Associate of PEP/IP/CEO</label>
                <select name="closeAssociatePepIpCeo">
                  <option value="">Select Close Associate</option>
                  <option value="No|0" selected>No — Score: 0</option>
                  <option value="Yes|5">Yes — Score: 5</option>
                </select>
              </div>
              <div class="form-group">
                <label>Customer's Avg Yearly Transaction</label>
                <select name="avgYearlyTransaction">
                  <option value="">Select Average Yearly Transaction</option>
                  <option value="Up to Taka 10 Lac|1">Up to Taka 10 Lac — Score: 1</option>
                  <option value="Above Taka 10 Lac to up to 50 Lac|2">Above Taka 10 Lac to up to 50 Lac — Score: 2</option>
                  <option value="Above Taka 50 Lac to up to 5 Crore|3">Above Taka 50 Lac to up to 5 Crore — Score: 3</option>
                  <option value="Above Taka 5 Crore|5">Above Taka 5 Crore — Score: 5</option>
                </select>
              </div>

              <!-- Row 4 -->
              <div class="form-group">
                <label>Credible Source of Funds?</label>
                <select name="credibleSourceOfFunds">
                  <option value="">Select Credible Source</option>
                  <option value="Yes|1">Yes — Score: 1</option>
                  <option value="No|5">No — Score: 5</option>
                </select>
              </div>
              <div class="form-group">
                <label>Source(s) of Funds Verify</label>
                <input type="text" name="sourceOfFundsVerify" value="FACE TO FACE CONVERSATION" placeholder="source(s) of funds verify">
              </div>
              <div class="form-group">
                <label>Beneficial Owner(s)</label>
                <select name="beneficialOwners">
                  <option value="">Select</option>
                  <option value="yes">Yes</option>
                  <option value="no" selected>No</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Beneficial Owner Details (shown when Beneficial Owner(s) = Yes) -->
          <div class="form-section" id="beneficial-owner-details" style="display:none;">
            <div class="section-header">
              <i class="fas fa-user-friends"></i>
              <h2>Beneficial Owner</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields" style="display:grid; grid-template-columns: repeat(4, 1fr); gap:12px;">
              <div class="form-group">
                <label>Name of Beneficial Owner (In English)</label>
                <input type="text" name="boNameEn" placeholder="Enter name in English">
              </div>
              <div class="form-group">
                <label>Name of Beneficial Owner (In Bangla)</label>
                <input type="text" name="boNameBn" placeholder="লাভবান মালিকের নাম বাংলায়">
              </div>
              <div class="form-group">
                <label>AML Tracking Number</label>
                <input type="text" name="boAmlTrackingNumber" placeholder="AML Tracking Number">
              </div>
              <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" name="boDob">
              </div>
              <div class="form-group">
                <label>Father's Name</label>
                <input type="text" name="boFatherName" placeholder="Father's full name">
              </div>
              <div class="form-group">
                <label>Mother's Name</label>
                <input type="text" name="boMotherName" placeholder="Mother's full name">
              </div>
              <div class="form-group">
                <label>Spouse Name</label>
                <input type="text" name="boSpouseName" placeholder="Spouse's full name">
              </div>
              <div class="form-group">
                <label>Gender</label>
                <select name="boGender">
                  <option value="">Select Gender</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div class="form-group">
                <label>National ID No</label>
                <input type="text" name="boNid" placeholder="Enter National ID no">
              </div>
              <div class="form-group">
                <label>Passport No</label>
                <input type="text" name="boPassport" placeholder="Enter Passport no">
              </div>
              <div class="form-group">
                <label>Birth Registration No</label>
                <input type="text" name="boBirthReg" placeholder="Enter Birth Registration no">
              </div>
              <div class="form-group">
                <label>Phone Number</label>
                <input type="tel" name="boPhone" placeholder="01XXXXXXXXX">
              </div>
              <div class="form-group">
                <label>Email Address</label>
                <input type="email" name="boEmail" placeholder="example@email.com">
              </div>
              <div class="form-group">
                <label>Occupation (In detail)</label>
                <input type="text" name="boOccupation" placeholder="Occupation in detail">
              </div>
              <div class="form-group">
                <label>Monthly Income</label>
                <input type="text" name="boMonthlyIncome" placeholder="Monthly income">
              </div>
              <div class="form-group">
                <label>Source of fund (In detail)</label>
                <input type="text" name="boSourceOfFund" placeholder="Source of fund in detail">
              </div>
              <div class="form-group">
                <label>TIN No. (If any)</label>
                <input type="text" name="boTin" placeholder="TIN number (if any)">
              </div>
              <div class="form-group">
                <label>Nationality</label>
                <input type="text" name="boNationality" placeholder="Nationality" value="Bangladeshi">
              </div>

              <!-- Present Address header full width -->
              <div class="form-group span-4">
                <label style="font-weight:700;">Present Address</label>
              </div>
              <div class="form-group">
                <label>House, Street, Block, Sector</label>
                <input type="text" name="boPresentHouse" placeholder="House, Street, Block, Sector">
              </div>
              <div class="form-group">
                <label>Area / Village</label>
                <input type="text" name="boPresentArea" placeholder="Area / Village">
              </div>
              <div class="form-group">
                <label>Post Office</label>
                <input type="text" name="boPresentPO" placeholder="Post Office">
              </div>
              <div class="form-group">
                <label>Upazila/Thana</label>
                <input type="text" name="boPresentThana" placeholder="Upazila/Thana">
              </div>
              <div class="form-group">
                <label>District</label>
                <input type="text" name="boPresentDistrict" placeholder="District">
              </div>
              <div class="form-group">
                <label>Post Code</label>
                <input type="text" name="boPresentPostCode" placeholder="Post Code">
              </div>
              <div class="form-group">
                <label>Country</label>
                <input type="text" name="boPresentCountry" value="Bangladesh">
              </div>
              <div class="form-group">
                <label>Nearest Landmark</label>
                <input type="text" name="boPresentLandmark" placeholder="Nearest Landmark">
              </div>

              <!-- Permanent Address header with inline Same-as-Present checkbox (checkbox placed immediately after header) -->
              <div class="form-group span-4" style="display:flex; align-items:center; justify-content:flex-start; gap:8px;">
                <label style="font-weight:700; margin:0;">Permanent Address</label>
                <div class="checkbox-inline" style="margin:0 0 0 4px;">
                  <label style="margin:0;"><input type="checkbox" id="boSameAddress" style="margin-right:4px; vertical-align:middle;">Same as Present Address</label>
                </div>
              </div>
              <div class="form-group">
                <label>House, Street, Block, Sector</label>
                <input type="text" name="boPermanentHouse" placeholder="House, Street, Block, Sector">
              </div>
              <div class="form-group">
                <label>Area / Village</label>
                <input type="text" name="boPermanentArea" placeholder="Area / Village">
              </div>
              <div class="form-group">
                <label>Post Office</label>
                <input type="text" name="boPermanentPO" placeholder="Post Office">
              </div>
              <div class="form-group">
                <label>Upazila/Thana</label>
                <input type="text" name="boPermanentThana" placeholder="Upazila/Thana">
              </div>
              <div class="form-group">
                <label>District</label>
                <input type="text" name="boPermanentDistrict" placeholder="District">
              </div>
              <div class="form-group">
                <label>Post Code</label>
                <input type="text" name="boPermanentPostCode" placeholder="Post Code">
              </div>
              <div class="form-group">
                <label>Country</label>
                <input type="text" name="boPermanentCountry" value="Bangladesh">
              </div>
              <div class="form-group">
                <label>Nearest Landmark</label>
                <input type="text" name="boPermanentLandmark" placeholder="Nearest Landmark">
              </div>
            </div>
          </div>


          

          <!-- Transaction Profile -->
          <div class="form-section" id="transaction-info">
            <div class="section-header">
              <i class="fas fa-exchange-alt"></i>
              <h2>Transaction Profile</h2>
              <i class="fas fa-chevron-down section-toggle"></i>
            </div>
            <div class="form-fields">
              <!-- Deposits Table -->
              <div class="transaction-table-wrapper" style="margin-bottom: 32px;">
                <div class="transaction-header deposit-header">
                  <i class="fas fa-arrow-down"></i>
                  <h3>Deposits</h3>
                  <span class="badge">Monthly</span>
                </div>
                <div class="table-responsive">
                  <table class="transaction-table">
                    <thead>
                      <tr>
                        <th class="particulars-col">Particulars</th>
                        <th class="number-col">Number of Deposit</th>
                        <th class="amount-col">Max Single Amount</th>
                        <th class="total-col">Total Amount</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="particulars-col">
                          <div class="td-content">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>Cash (Online & ATM)</span>
                          </div>
                        </td>
                        <td class="number-col"><input type="text" name="depositCashCount" value="5" class="table-input"></td>
                        <td class="amount-col"><input type="text" name="depositCashAmount" class="table-input" placeholder="৳ 0.00"></td>
                        <td class="total-col"><input type="text" name="depositCashTotal" class="table-input" placeholder="৳ 0.00"></td>
                      </tr>
                      <tr>
                        <td class="particulars-col">
                          <div class="td-content">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Transfer/Instrument</span>
                          </div>
                        </td>
                        <td class="number-col"><input type="text" name="depositTransferCount" value="5" class="table-input"></td>
                        <td class="amount-col"><input type="text" name="depositTransferAmount" class="table-input" placeholder="৳ 0.00"></td>
                        <td class="total-col"><input type="text" name="depositTransferTotal" class="table-input" placeholder="৳ 0.00"></td>
                      </tr>
                      <tr>
                        <td class="particulars-col">
                          <div class="td-content">
                            <i class="fas fa-globe"></i>
                            <span>Remittance</span>
                          </div>
                        </td>
                        <td class="number-col"><input type="text" name="depositRemittanceCount" value="" class="table-input"></td>
                        <td class="amount-col"><input type="text" name="depositRemittanceAmount" class="table-input" placeholder="৳ 0.00"></td>
                        <td class="total-col"><input type="text" name="depositRemittanceTotal" class="table-input" placeholder="৳ 0.00"></td>
                      </tr>
                      <tr class="total-row">
                        <td class="particulars-col">
                          <div class="td-content total-label">
                            <i class="fas fa-calculator"></i>
                            <span>Total Probable Deposit</span>
                          </div>
                        </td>
                        <td class="number-col"></td>
                        <td class="amount-col"><input type="text" name="depositMaxSingleCombined" class="table-input total-input" readonly></td>
                        <td class="total-col"><input type="text" name="depositTotalProbable" class="table-input total-input" readonly></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Withdrawals Table -->
              <div class="transaction-table-wrapper">
                <div class="transaction-header withdrawal-header">
                  <i class="fas fa-arrow-up"></i>
                  <h3>Withdrawals</h3>
                  <span class="badge">Monthly</span>
                </div>
                <div class="table-responsive">
                  <table class="transaction-table">
                    <thead>
                      <tr>
                        <th class="particulars-col">Particulars</th>
                        <th class="number-col">Number of Withdrawal</th>
                        <th class="amount-col">Max Single Amount</th>
                        <th class="total-col">Total Amount</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="particulars-col">
                          <div class="td-content">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>Cash (Online & ATM)</span>
                          </div>
                        </td>
                        <td class="number-col"><input type="text" name="withdrawalCashCount" value="5" class="table-input"></td>
                        <td class="amount-col"><input type="text" name="withdrawalCashAmount" class="table-input" placeholder="৳ 0.00"></td>
                        <td class="total-col"><input type="text" name="withdrawalCashTotal" class="table-input" placeholder="৳ 0.00"></td>
                      </tr>
                      <tr>
                        <td class="particulars-col">
                          <div class="td-content">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Transfer/Instrument</span>
                          </div>
                        </td>
                        <td class="number-col"><input type="text" name="withdrawalTransferCount" value="5" class="table-input"></td>
                        <td class="amount-col"><input type="text" name="withdrawalTransferAmount" class="table-input" placeholder="৳ 0.00"></td>
                        <td class="total-col"><input type="text" name="withdrawalTransferTotal" class="table-input" placeholder="৳ 0.00"></td>
                      </tr>
                      <tr>
                        <td class="particulars-col">
                          <div class="td-content">
                            <i class="fas fa-globe"></i>
                            <span>Remittance</span>
                          </div>
                        </td>
                        <td class="number-col"><input type="text" name="withdrawalRemittanceCount" value="" class="table-input"></td>
                        <td class="amount-col"><input type="text" name="withdrawalRemittanceAmount" class="table-input" placeholder="৳ 0.00"></td>
                        <td class="total-col"><input type="text" name="withdrawalRemittanceTotal" class="table-input" placeholder="৳ 0.00"></td>
                      </tr>
                      <tr class="total-row">
                        <td class="particulars-col">
                          <div class="td-content total-label">
                            <i class="fas fa-calculator"></i>
                            <span>Total Probable Withdrawal</span>
                          </div>
                        </td>
                        <td class="number-col"></td>
                        <td class="amount-col"><input type="text" name="withdrawalMaxSingleCombined" class="table-input total-input" readonly></td>
                        <td class="total-col"><input type="text" name="withdrawalTotalProbable" class="table-input total-input" readonly></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          

        </div>
      </form>
      
    </div>

    <!-- Action Bar for Info Page -->
    <div class="action-bar">
      <div class="print-btn-wrap" style="display:flex; flex-direction:column; align-items:center; margin-right:8px;">
        <button type="button" class="btn btn-success" id="printFormBtn"><i class="fas fa-print"></i> Print Form</button>
      </div>
      <div style="display:flex; align-items:center; gap:8px;">
        <div style="display:flex; flex-direction:column;">
          <select id="printTargetSelect" aria-label="Print target" style="padding:8px 10px; border:1px solid #ccc; border-radius:6px;">
            <option value="accountHolder">Account Holder</option>
            <option value="secondApplicant">2nd Applicant</option>
            <option value="thirdApplicant">3rd Applicant</option>
            <option value="guardian">Guardian</option>
            <option value="beneficialOwner">Beneficial Owner</option>
          </select>
        </div>
        <button type="button" class="btn btn-info" id="printOthersBtn"><i class="fas fa-print"></i> Print KYC, TP, SBS</button>
      </div>
      <button type="button" class="btn btn-danger" id="clearFormBtn"><i class="fas fa-trash"></i> Clear Form</button>
    </div>
  </div>

  <!-- Page 2: Form Preview -->
  <div class="page-container" id="form-page">
    <div class="preview-page">
      <div class="preview-controls">
        <div class="edit-toggle">
          <input type="checkbox" id="editMode">
          <label for="editMode"><i class="fas fa-edit"></i> Edit Overlay Positions</label>
        </div>
        <div class="form-type-selector" style="display:flex; align-items:center; gap:10px;">
          <label for="formTypeSelect" style="margin:0; font-weight:600;"><i class="fas fa-file-alt"></i> Form Type:</label>
          <select id="formTypeSelect" style="padding:6px 12px; border-radius:6px; border:1px solid #ccc;">
            <option value="conventional">Conventional</option>
            <option value="conventional-imperial">Conventional Imperial</option>
            <option value="taqwa">Taqwa</option>
            <option value="taqwa-imperial">Taqwa Imperial</option>
            <option value="others">Others</option>
            <option value="beneficial-owner">Beneficial Owner</option>
            <option value="guardian">Guardian</option>
          </select>
        </div>
        <div class="preview-actions">
          <button class="btn btn-warning" id="savePositionsBtn"><i class="fas fa-save"></i> Save Positions</button>
        </div>
      </div>

      <div class="preview-container">
        <!-- Form Pages with Overlays -->
        <div class="form-page active" data-page="1">
          <img src="Images/personal account opening form/personal-account-opening-formgeneral_page-0001.jpg" alt="Form Page 1">
          <!-- Page 1 Overlays will be added dynamically -->
        </div>
        <div class="form-page" data-page="2">
          <img src="Images/personal account opening form/personal-account-opening-formgeneral_page-0002.jpg" alt="Form Page 2">
        </div>
        <div class="form-page" data-page="3">
          <img src="Images/personal account opening form/personal-account-opening-formgeneral_page-0003.jpg" alt="Form Page 3">
        </div>
        <div class="form-page" data-page="4">
          <img src="Images/personal account opening form/personal-account-opening-formgeneral_page-0004.jpg" alt="Form Page 4">
        </div>
        <div class="form-page" data-page="5">
          <img src="Images/personal account opening form/personal-account-opening-formgeneral_page-0005.jpg" alt="Form Page 5">
        </div>
        <div class="form-page" data-page="6">
          <img src="Images/personal account opening form/personal-account-opening-formgeneral_page-0006.jpg" alt="Form Page 6">
        </div>
        <!-- Imperial Form Pages (hidden by default) -->
        <div class="form-page imperial-page" data-page="18" style="display:none;">
          <img src="Images/personal account opening form imperial/personal-account-opening-formimperial_page-0001.jpg" alt="Imperial Page 1">
        </div>
        <div class="form-page imperial-page" data-page="19" style="display:none;">
          <img src="Images/personal account opening form imperial/personal-account-opening-formimperial_page-0002.jpg" alt="Imperial Page 2">
        </div>
        <div class="form-page imperial-page" data-page="20" style="display:none;">
          <img src="Images/personal account opening form imperial/personal-account-opening-formimperial_page-0003.jpg" alt="Imperial Page 3">
        </div>
        <div class="form-page imperial-page" data-page="21" style="display:none;">
          <img src="Images/personal account opening form imperial/personal-account-opening-formimperial_page-0004.jpg" alt="Imperial Page 4">
        </div>
        <div class="form-page imperial-page" data-page="22" style="display:none;">
          <img src="Images/personal account opening form imperial/personal-account-opening-formimperial_page-0005.jpg" alt="Imperial Page 5">
        </div>
        <div class="form-page imperial-page" data-page="23" style="display:none;">
          <img src="Images/personal account opening form imperial/personal-account-opening-formimperial_page-0006.jpg" alt="Imperial Page 6">
        </div>
        <!-- Taqwa Form Pages (hidden by default) -->
        <div class="form-page taqwa-page" data-page="24" style="display:none;">
          <img src="Images/ucb taqwa personal account opening form/ucb-taqwa-personal-account-opening-form_page-0001.jpg" alt="Taqwa Page 1">
        </div>
        <div class="form-page taqwa-page" data-page="25" style="display:none;">
          <img src="Images/ucb taqwa personal account opening form/ucb-taqwa-personal-account-opening-form_page-0002.jpg" alt="Taqwa Page 2">
        </div>
        <div class="form-page taqwa-page" data-page="26" style="display:none;">
          <img src="Images/ucb taqwa personal account opening form/ucb-taqwa-personal-account-opening-form_page-0003.jpg" alt="Taqwa Page 3">
        </div>
        <div class="form-page taqwa-page" data-page="27" style="display:none;">
          <img src="Images/ucb taqwa personal account opening form/ucb-taqwa-personal-account-opening-form_page-0004.jpg" alt="Taqwa Page 4">
        </div>
        <div class="form-page taqwa-page" data-page="28" style="display:none;">
          <img src="Images/ucb taqwa personal account opening form/ucb-taqwa-personal-account-opening-form_page-0005.jpg" alt="Taqwa Page 5">
        </div>
        <div class="form-page taqwa-page" data-page="29" style="display:none;">
          <img src="Images/ucb taqwa personal account opening form/ucb-taqwa-personal-account-opening-form_page-0006.jpg" alt="Taqwa Page 6">
        </div>
        <!-- Taqwa Imperial Form Pages (hidden by default) -->
        <div class="form-page taqwa-imperial-page" data-page="30" style="display:none;">
          <img src="Images/ucb taqwa imperial personal account opening form/ucb-taqwa-imperial-personal-account-opening-form_page-0001.jpg" alt="Taqwa Imperial Page 1">
        </div>
        <div class="form-page taqwa-imperial-page" data-page="31" style="display:none;">
          <img src="Images/ucb taqwa imperial personal account opening form/ucb-taqwa-imperial-personal-account-opening-form_page-0002.jpg" alt="Taqwa Imperial Page 2">
        </div>
        <div class="form-page taqwa-imperial-page" data-page="32" style="display:none;">
          <img src="Images/ucb taqwa imperial personal account opening form/ucb-taqwa-imperial-personal-account-opening-form_page-0003.jpg" alt="Taqwa Imperial Page 3">
        </div>
        <div class="form-page taqwa-imperial-page" data-page="33" style="display:none;">
          <img src="Images/ucb taqwa imperial personal account opening form/ucb-taqwa-imperial-personal-account-opening-form_page-0004.jpg" alt="Taqwa Imperial Page 4">
        </div>
        <div class="form-page taqwa-imperial-page" data-page="34" style="display:none;">
          <img src="Images/ucb taqwa imperial personal account opening form/ucb-taqwa-imperial-personal-account-opening-form_page-0005.jpg" alt="Taqwa Imperial Page 5">
        </div>
        <div class="form-page taqwa-imperial-page" data-page="35" style="display:none;">
          <img src="Images/ucb taqwa imperial personal account opening form/ucb-taqwa-imperial-personal-account-opening-form_page-0006.jpg" alt="Taqwa Imperial Page 6">
        </div>
        <!-- Beneficial Owner Form Pages (hidden by default) -->
        <div class="form-page beneficial-owner-page" data-page="40" style="display:none;">
          <img src="Images/Beneficial Owner/Beneficial Owner Information-1_page-0001.jpg" alt="Beneficial Owner Information Page 1">
        </div>
        <!-- Guardian Form Pages (hidden by default) -->
        <div class="form-page guardian-page" data-page="48" style="display:none;">
          <img src="Images/personal account opening form/personal-account-opening-formgeneral_page-0001.jpg" alt="Guardian Form Page 1">
        </div>
        <!-- Others Form Pages (hidden by default) -->
        <div class="form-page others-page" data-page="7" style="display:none;">
          <img src="Images/Other/1. KYC Profile Form_page-0001.jpg" alt="KYC Page 1">
        </div>
        <div class="form-page others-page" data-page="8" style="display:none;">
          <img src="Images/Other/2. KYC Profile Form_page-0002.jpg" alt="KYC Page 2">
        </div>
        <div class="form-page others-page" data-page="9" style="display:none;">
          <img src="Images/Other/3. KYC Profile Form_page-0003.jpg" alt="KYC Page 3">
        </div>
        <div class="form-page others-page" data-page="10" style="display:none;">
          <img src="Images/Other/4. KYC Profile Form_page-0004.jpg" alt="KYC Page 4">
        </div>
        <div class="form-page others-page" data-page="11" style="display:none;">
          <img src="Images/Other/5. KYC Profile Form_page-0005.jpg" alt="KYC Page 5">
        </div>
        <div class="form-page others-page" data-page="12" style="display:none;">
          <img src="Images/Other/6. Blank.jpg" alt="Blank Page">
        </div>
        <div class="form-page others-page" data-page="13" style="display:none;">
          <img src="Images/Other/7. TP Form_page-0001.jpg" alt="TP Form Page 1">
        </div>
        <div class="form-page others-page" data-page="14" style="display:none;">
          <img src="Images/Other/8. TP Form_page-0002.jpg" alt="TP Form Page 2">
        </div>
        <div class="form-page others-page" data-page="15" style="display:none;">
          <img src="Images/Other/9. SBS Form_page-0001.jpg" alt="SBS Form Page 1">
        </div>
        <div class="form-page others-page" data-page="16" style="display:none;">
          <img src="Images/Other/10. Blank.jpg" alt="Blank Page 2">
        </div>
        <div class="form-page others-page" data-page="17" style="display:none;">
          <img src="Images/Other/11. AOF Checklist_page-0001.jpg" alt="AOF Checklist">
        </div>
      </div>
    </div>

    <!-- Action Bar for Form Page -->
    <div class="action-bar">
    </div>
  </div>

  <!-- Presets Panel -->
  <div class="panel-backdrop" id="panelBackdrop"></div>
  <div class="presets-panel" id="presetsPanel">
    <div class="presets-header">
      <h3><i class="fas fa-folder-open"></i> Saved Presets</h3>
      <button class="presets-close" id="closePresetsBtn"><i class="fas fa-times"></i></button>
    </div>
    <div class="presets-list" id="presetsList">
      <!-- Presets will be dynamically loaded here -->
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>
  <!-- Hidden file input for importing JSON data -->
  <input type="file" id="importFileInput" accept=".json,application/json" style="display:none">

  <script>
(function() {
  // Constants
  const FORM_KEY = 'ucb_form_data_v1';
  const PRESETS_KEY = 'ucb_form_presets_v1';
  const POSITIONS_KEY = 'ucb_overlay_positions_v1';
  // Persist branch name separately so it survives form clears
  const BRANCH_KEY = 'ucb_branch_name_v1';

  // DOM Elements
  const form = document.getElementById('account-form');
  const navBtns = document.querySelectorAll('.nav-btn');
  const pageContainers = document.querySelectorAll('.page-container');
  const toast = document.getElementById('toast');
  const formPages = document.querySelectorAll('.form-page');
  const editModeCheckbox = document.getElementById('editMode');
  const presetsPanel = document.getElementById('presetsPanel');
  const panelBackdrop = document.getElementById('panelBackdrop');
  const presetsList = document.getElementById('presetsList');
  const sameAddressCheckbox = document.getElementById('sameAddress');
  const nomineeSameCheckbox = document.getElementById('nomineeSameAddress');
  const guardianSameCheckbox = document.getElementById('gSameAddress');
  const formTypeSelect = document.getElementById('formTypeSelect');
  const beneficialOwnersSelect = form ? form.elements['beneficialOwners'] : null;
  const boSection = document.getElementById('beneficial-owner-details');
  const boSameAddressCheckbox = document.getElementById('boSameAddress');
  const printTargetSelect = document.getElementById('printTargetSelect');
  const popupPrintTargetSelect = document.getElementById('popupPrintTargetSelect');
  // Keep a space-free account number for specific page overlays (page 17)
  const accountNumberEl = form ? form.elements['accountNumber'] : null;
  const accountNumberNoSpaceEl = form ? form.elements['accountNumberNoSpace'] : null;
  function updateAccountNumberNoSpace() {
    try {
      if (!accountNumberNoSpaceEl || !accountNumberEl) return;
      const raw = (accountNumberEl.value || '').toString();
      accountNumberNoSpaceEl.value = raw.replace(/\s+/g, '');
      if (typeof updateOverlays === 'function') updateOverlays();
    } catch (e) {}
  }
  if (accountNumberEl) {
    accountNumberEl.addEventListener('input', updateAccountNumberNoSpace);
    accountNumberEl.addEventListener('change', updateAccountNumberNoSpace);
  }
  // initialize on load
  updateAccountNumberNoSpace();
  const slideBranchInput = document.getElementById('slideBranchInput');

  // Guardian section visibility based on age (< 18)
  const guardianSectionNew = document.getElementById('guardian-info-new');
  function calculateAge(dobStr) {
    try {
      const dt = new Date(dobStr);
      if (isNaN(dt)) return NaN;
      const today = new Date();
      let age = today.getFullYear() - dt.getFullYear();
      const m = today.getMonth() - dt.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < dt.getDate())) age--;
      return age;
    } catch (e) { return NaN; }
  }
  function updateGuardianVisibility() {
    const dobEl = form && form.elements ? form.elements['dob'] : null;
    const dobVal = dobEl ? dobEl.value : '';
    const age = dobVal ? calculateAge(dobVal) : NaN;
    const isMinor = Number.isFinite(age) ? age < 18 : false;
    if (guardianSectionNew) guardianSectionNew.style.display = isMinor ? '' : 'none';
    try {
      document.querySelectorAll('.guardian-page').forEach(pg => { pg.style.display = isMinor ? '' : 'none'; });
    } catch (e) {}
    if (typeof updateOverlays === 'function') updateOverlays();
  }
  if (form && form.elements && form.elements['dob']) {
    form.elements['dob'].addEventListener('input', updateGuardianVisibility);
    form.elements['dob'].addEventListener('change', updateGuardianVisibility);
  }
  // Initialize guardian section visibility
  updateGuardianVisibility();

  // Wire up print target dropdown to update overlays
  if (printTargetSelect) {
    // Function to update dropdown option visibility based on name field values
    function updatePrintTargetOptions() {
      const form = document.getElementById('account-form');
      if (!form) return;

      const secondApplicantName = form.elements['secondApplicantName']?.value || '';
      const thirdApplicantName = form.elements['thirdApplicantName']?.value || '';
      const gNameEn = form.elements['gNameEn']?.value || '';
      const boNameEn = form.elements['boNameEn']?.value || '';

      // Get all options in the dropdown
      const options = printTargetSelect.querySelectorAll('option');
      let hasOtherOptions = false;
      options.forEach(option => {
        const value = option.value;
        // Show/hide options based on corresponding name field values
        if (value === 'secondApplicant') {
          option.style.display = secondApplicantName.trim() ? 'block' : 'none';
          if (secondApplicantName.trim()) hasOtherOptions = true;
        } else if (value === 'thirdApplicant') {
          option.style.display = thirdApplicantName.trim() ? 'block' : 'none';
          if (thirdApplicantName.trim()) hasOtherOptions = true;
        } else if (value === 'guardian') {
          option.style.display = gNameEn.trim() ? 'block' : 'none';
          if (gNameEn.trim()) hasOtherOptions = true;
        } else if (value === 'beneficialOwner') {
          option.style.display = boNameEn.trim() ? 'block' : 'none';
          if (boNameEn.trim()) hasOtherOptions = true;
        }
      });

      // If only Account Holder is available, clear the label/name data to hide overlays
      if (!hasOtherOptions) {
        form.dataset.printTargetLabel = '';
        form.dataset.printTargetNameField = '';
      }

      // If currently selected option is now hidden, reset to Account Holder
      const currentValue = printTargetSelect.value;
      if (printTargetSelect.querySelector(`option[value="${currentValue}"]`).style.display === 'none') {
        printTargetSelect.value = 'accountHolder';
        printTargetSelect.dispatchEvent(new Event('change'));
      }

      // Trigger overlay update to reflect label/name visibility
      if (typeof updateOverlays === 'function') {
        updateOverlays();
      }
    }

    // Wire up name input fields to update dropdown visibility
    const nameFields = ['secondApplicantName', 'thirdApplicantName', 'gNameEn', 'boNameEn'];
    nameFields.forEach(fieldName => {
      const field = form.elements[fieldName];
      if (field) {
        field.addEventListener('input', updatePrintTargetOptions);
        field.addEventListener('change', updatePrintTargetOptions);
      }
    });

    // Initial update on page load
    updatePrintTargetOptions();

    // Wire up dropdown change listener
    printTargetSelect.addEventListener('change', function() {
      const targetLabelMap = {
        'accountHolder': 'Account Holder',
        'secondApplicant': '2nd Applicant',
        'thirdApplicant': '3rd Applicant',
        'guardian': 'Guardian',
        'beneficialOwner': 'Beneficial Owner'
      };
      const targetNameFieldMap = {
        'accountHolder': 'fullNameEn',
        'secondApplicant': 'secondApplicantName',
        'thirdApplicant': 'thirdApplicantName',
        'guardian': 'gNameEn',
        'beneficialOwner': 'boNameEn'
      };
      const selectedLabel = targetLabelMap[this.value] || '';
      const selectedNameField = targetNameFieldMap[this.value] || '';
      const form = document.getElementById('account-form');
      if (form) {
        form.dataset.printTargetLabel = selectedLabel;
        form.dataset.printTargetNameField = selectedNameField;
      }
      if (typeof updateOverlays === 'function') {
        updateOverlays();
      }
    });
  }

  // Wire up popup print target dropdown with same functionality
  if (popupPrintTargetSelect) {
    function updatePopupPrintTargetOptions() {
      const form = document.getElementById('account-form');
      if (!form) return;

      const secondApplicantName = form.elements['secondApplicantName']?.value || '';
      const thirdApplicantName = form.elements['thirdApplicantName']?.value || '';
      const gNameEn = form.elements['gNameEn']?.value || '';
      const boNameEn = form.elements['boNameEn']?.value || '';

      const options = popupPrintTargetSelect.querySelectorAll('option');
      let hasOtherOptions = false;
      options.forEach(option => {
        const value = option.value;
        if (value === 'secondApplicant') {
          option.style.display = secondApplicantName.trim() ? 'block' : 'none';
          if (secondApplicantName.trim()) hasOtherOptions = true;
        } else if (value === 'thirdApplicant') {
          option.style.display = thirdApplicantName.trim() ? 'block' : 'none';
          if (thirdApplicantName.trim()) hasOtherOptions = true;
        } else if (value === 'guardian') {
          option.style.display = gNameEn.trim() ? 'block' : 'none';
          if (gNameEn.trim()) hasOtherOptions = true;
        } else if (value === 'beneficialOwner') {
          option.style.display = boNameEn.trim() ? 'block' : 'none';
          if (boNameEn.trim()) hasOtherOptions = true;
        }
      });

      // If only Account Holder is available, clear the label/name data to hide overlays
      if (!hasOtherOptions) {
        form.dataset.printTargetLabel = '';
        form.dataset.printTargetNameField = '';
      }

      const currentValue = popupPrintTargetSelect.value;
      if (popupPrintTargetSelect.querySelector(`option[value="${currentValue}"]`).style.display === 'none') {
        popupPrintTargetSelect.value = 'accountHolder';
        popupPrintTargetSelect.dispatchEvent(new Event('change'));
      }

      // Trigger overlay update to reflect label/name visibility
      if (typeof updateOverlays === 'function') {
        updateOverlays();
      }
    }

    // Wire name input fields to update popup dropdown
    const nameFields = ['secondApplicantName', 'thirdApplicantName', 'gNameEn', 'boNameEn'];
    nameFields.forEach(fieldName => {
      const field = form.elements[fieldName];
      if (field) {
        field.addEventListener('input', updatePopupPrintTargetOptions);
        field.addEventListener('change', updatePopupPrintTargetOptions);
      }
    });

    // Initial update on page load
    updatePopupPrintTargetOptions();

    // Wire up popup dropdown change listener
    popupPrintTargetSelect.addEventListener('change', function() {
      const targetLabelMap = {
        'accountHolder': 'Account Holder',
        'secondApplicant': '2nd Applicant',
        'thirdApplicant': '3rd Applicant',
        'guardian': 'Guardian',
        'beneficialOwner': 'Beneficial Owner'
      };
      const targetNameFieldMap = {
        'accountHolder': 'fullNameEn',
        'secondApplicant': 'secondApplicantName',
        'thirdApplicant': 'thirdApplicantName',
        'guardian': 'gNameEn',
        'beneficialOwner': 'boNameEn'
      };
      const selectedLabel = targetLabelMap[this.value] || '';
      const selectedNameField = targetNameFieldMap[this.value] || '';
      const form = document.getElementById('account-form');
      if (form) {
        form.dataset.printTargetLabel = selectedLabel;
        form.dataset.printTargetNameField = selectedNameField;
      }
      if (typeof updateOverlays === 'function') {
        updateOverlays();
      }
    });
  }

  // Helper: Get account type name from product code in account number
  // Account number format: first 3 digits ignored, next 4 digits = product code
  function getAccountTypeFromNumber(accountNum) {
    if (!accountNum || accountNum.length < 7) return '';
    const productCode = accountNum.substring(3, 7); // positions 4-7 (0-indexed: 3-6)
    const savedTypes = JSON.parse(localStorage.getItem('ucb_account_types_v1') || '[]');
    const match = savedTypes.find(t => t.code === productCode);
    return match ? match.name : 'Savings';
  }

  // Beneficial Owner: copy present address block when checked
  function handleBoSameAddress() {
    if (!form) return;
    if (!boSameAddressCheckbox || !boSameAddressCheckbox.checked) return;

    const src = {
      house: form.elements['boPresentHouse'] ? form.elements['boPresentHouse'].value : '',
      area: form.elements['boPresentArea'] ? form.elements['boPresentArea'].value : '',
      po: form.elements['boPresentPO'] ? form.elements['boPresentPO'].value : '',
      thana: form.elements['boPresentThana'] ? form.elements['boPresentThana'].value : '',
      district: form.elements['boPresentDistrict'] ? form.elements['boPresentDistrict'].value : '',
      postCode: form.elements['boPresentPostCode'] ? form.elements['boPresentPostCode'].value : '',
      country: form.elements['boPresentCountry'] ? form.elements['boPresentCountry'].value : '',
      landmark: form.elements['boPresentLandmark'] ? form.elements['boPresentLandmark'].value : ''
    };

    if (form.elements['boPermanentHouse']) form.elements['boPermanentHouse'].value = src.house;
    if (form.elements['boPermanentArea']) form.elements['boPermanentArea'].value = src.area;
    if (form.elements['boPermanentPO']) form.elements['boPermanentPO'].value = src.po;
    if (form.elements['boPermanentThana']) form.elements['boPermanentThana'].value = src.thana;
    if (form.elements['boPermanentDistrict']) form.elements['boPermanentDistrict'].value = src.district;
    if (form.elements['boPermanentPostCode']) form.elements['boPermanentPostCode'].value = src.postCode;
    if (form.elements['boPermanentCountry']) form.elements['boPermanentCountry'].value = src.country;
    if (form.elements['boPermanentLandmark']) form.elements['boPermanentLandmark'].value = src.landmark;
    
    updateOverlays();
  }

  // Show/hide Beneficial Owner section based on dropdown
  function handleBeneficialOwnerToggle() {
    if (!boSection || !beneficialOwnersSelect) return;
    const val = String(beneficialOwnersSelect.value || '').toLowerCase();
    if (val === 'yes') {
      boSection.style.display = '';
    } else {
      boSection.style.display = 'none';
    }
  }

  // Overlay Definitions for each page
  const overlayConfig = {
    1: [
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'combinedApplicants', top: '18.5%', left: '22%', label: 'Full Name joint' },
      { field: 'fullNameBn', top: '11%', left: '35%', label: 'Name (Bangla)' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name 1' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'cif', top: '10%', left: '48%', label: 'CIF' },
      { field: 'nid', top: '20%', left: '60%', label: 'NID Number' },
      { field: 'passportNo', top: '20%', left: '66%', label: 'Passport No' },
      { field: 'combinedApplicantsBn', top: '11%', left: '35%', label: 'Name (Bangla) joint' },
      { field: 'fatherName', top: '14%', left: '35%', label: 'Father Name' },
      { field: 'motherName', top: '17%', left: '35%', label: 'Mother Name' },
      { field: 'spouseName', top: '20%', left: '35%', label: 'Spouse Name' },
      { field: 'dob', top: '23%', left: '35%', label: 'Date of Birth' },
      { field: 'nationality', top: '26%', left: '35%', label: 'Nationality' },
      { field: 'presentHouse', top: '48%', left: '20%', label: 'Present Address' },
      { field: 'presentRoad', top: '52%', left: '20%', label: 'Road' },
      { field: 'presentPostOffice', top: '52%', left: '20%', label: 'Post Office' },
      { field: 'presentPostCode', top: '52%', left: '55%', label: 'Post Code' },
      { field: 'presentPO', top: '52%', left: '70%', label: 'PO' },
      { field: 'presentThana', top: '52%', left: '20%', label: 'Thana' },
      { field: 'presentDistrict', top: '52%', left: '55%', label: 'District' },
      { field: 'presentCountry', top: '52%', left: '20%', label: 'Country' },
      { field: 'permanentHouse', top: '60%', left: '20%', label: 'Permanent Address' },
      { field: 'permanentRoad', top: '64%', left: '20%', label: 'Road' },
      { field: 'permanentPostOffice', top: '64%', left: '20%', label: 'Post Office' },
      { field: 'permanentPostCode', top: '64%', left: '55%', label: 'Post Code' },
      { field: 'permanentPO', top: '64%', left: '70%', label: 'PO' },
      { field: 'permanentThana', top: '64%', left: '20%', label: 'Thana' },
      { field: 'permanentDistrict', top: '64%', left: '55%', label: 'District' },
        { field: 'permanentCountry', top: '64%', left: '20%', label: 'Country' },
      { field: 'mobile', top: '72%', left: '35%', label: 'Mobile' },
      { field: 'email', top: '75%', left: '35%', label: 'Email' },
      { field: 'occupation', top: '82%', left: '35%', label: 'Occupation' },
      { field: 'monthlyIncome', top: '88%', left: '35%', label: 'Probable Monthly Income' },
      { field: 'sourceOfFund', top: '56%', left: '35%', label: 'Source of Fund' },
      { field: 'etin', top: '88%', left: '35%', label: 'ETIN' },
      { field: 'initialDepositWords', top: '92%', left: '50%', label: 'Initial Deposit (In Words)' },
      { field: 'digit1', top: '90%', left: '50%', label: '1' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'tick1', top: '90%', left: '20%', label: '' },
      { field: 'tick2', top: '90%', left: '26%', label: '' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'male', top: '90%', left: '38%', label: '' },
      { field: 'female', top: '90%', left: '44%', label: '' },
      { field: 'initialDeposit', top: '88%', left: '35%', label: 'Initial Deposit' },
      { field: 'birthCertNo', top: '88%', left: '35%', label: 'Birth Certificate' },
      { field: 'chequeBook', top: '86%', left: '70%', label: 'Cheque Book' },
      { field: 'debitCard', top: '86%', left: '76%', label: 'Debit Card' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'officer1Seal', top: '85%', left: '78%', label: 'Officer 1 Seal', sealType: 'officer1' },
    ],
    2: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'fullNameEn', top: '20%', left: '30%', label: 'Account Holder Name' },
      { field: 'introducerDob', top: '30%', left: '35%', label: 'Introducer DOB' },
      { field: 'introducerName', top: '27%', left: '35%', label: 'Introducer Name' },
      { field: 'introducerAccount', top: '33%', left: '35%', label: 'Introducer Account No.' },
      { field: 'amlTrackingNumber', top: '35%', left: '35%', label: 'AML Tracking No.' },
      { field: 'rmCode', top: '38%', left: '35%', label: 'RM Code' },
      { field: 'nomineeName', top: '15%', left: '35%', label: 'Nominee Name' },
      { field: 'nomineeRelation', top: '18%', left: '35%', label: 'Relationship' },
      { field: 'nomineeDob', top: '21%', left: '35%', label: 'Nominee DOB' },
      { field: 'nomineeShare', top: '24%', left: '65%', label: 'Share %' },
      { field: 'nomineeNid', top: '27%', left: '35%', label: 'Nominee NID' },
      { field: 'nomineeAddress', top: '30%', left: '35%', label: 'Nominee Address' },
      { field: 'nomineeMobile', top: '36%', left: '35%', label: 'Nominee Mobile' },
      { field: 'guardianName', top: '40%', left: '35%', label: 'Guardian Name' },
      { field: 'guardianRelation', top: '43%', left: '35%', label: 'Guardian Relation' },
      { field: 'guardianNid', top: '46%', left: '35%', label: 'Guardian NID' },
      { field: 'guardianPermanentAddress', top: '49%', left: '35%', label: 'Guardian Permanent Address' },
      { field: 'guardianMobile', top: '52%', left: '35%', label: 'Guardian Mobile' },
      { field: 'tick3', top: '90%', left: '20%', label: '' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'digit2', top: '90%', left: '50%', label: '2' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' }, 
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' }, 
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer2Seal', top: '80%', left: '78%', label: 'Officer 2 Seal', sealType: 'officer2' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
    ],
    3: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit3', top: '90%', left: '50%', label: '3' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      
    ],
    4: [
      { field: 'digit4', top: '90%', left: '50%', label: '4' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    5: [
      { field: 'digit5', top: '90%', left: '50%', label: '5' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    6: [
      { field: 'fullNameEn', top: '15%', left: '30%', label: 'Account Holder Name' },
      { field: 'digit6', top: '90%', left: '50%', label: '6' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'thirdApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' }, 
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' }, 
    ]
    ,
    7: [
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name 3' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'cif', top: '10%', left: '48%', label: 'CIF' },
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'accountTypeName', top: '15%', left: '50%', label: 'Type of Account' },
      { field: 'accountNature', top: '20%', left: '55%', label: '' },
      { field: 'sourceOfFundsVerify', top: '22%', left: '50%', label: "Source(s) of Funds (Verify)" },
      { field: 'nidOrBirth', top: '26%', left: '50%', label: 'NID / Birth Cert.' },
      // NID ticks (two positions linked to presence of NID)
      { field: 'nid_tick_1', top: '26%', left: '42%', label: 'NID Tick 1' },
      { field: 'nid_tick_2', top: '26%', left: '44%', label: 'NID Tick 2' },
      // Birth Certificate ticks (two positions linked to presence of Birth Certificate)
      { field: 'birth_tick_1', top: '28%', left: '42%', label: 'Birth Tick 1' },
      { field: 'birth_tick_2', top: '28%', left: '44%', label: 'Birth Tick 2' },
      // Passport ticks (two positions linked to presence of Passport No.)
      { field: 'passport_tick_1', top: '30%', left: '42%', label: 'Passport Tick 1' },
      { field: 'passport_tick_2', top: '30%', left: '44%', label: 'Passport Tick 2' },
      // Two simple N/A text boxes (static 'N/A') placed on Others page 1
      { field: 'na_text_1', top: '34%', left: '60%', label: 'N/A' },
      { field: 'na_text_2', top: '34%', left: '64%', label: 'N/A' },
      // Two separate tick positions for Beneficial Owner(s): Yes / No
      { field: 'beneficialOwners_yes', top: '30%', left: '48%', label: 'Beneficial Owner - Yes' },
      { field: 'beneficialOwners_no', top: '30%', left: '52%', label: 'Beneficial Owner - No' },
      { field: 'occupation', top: '82%', left: '35%', label: 'Occupation' },
      { field: 'monthlyIncome', top: '88%', left: '35%', label: 'Probable Monthly Income' },
      { field: 'sourceOfFund', top: '56%', left: '35%', label: 'Source of Fund' },
      { field: 'nid', top: '20%', left: '60%', label: 'NID Number' },
      { field: 'birthCertNo', top: '88%', left: '35%', label: 'Birth Certificate' },
      { field: 'passportNo', top: '88%', left: '35%', label: 'Passport Number' },
      // Dynamic print target label (appears based on dropdown selection)
      { field: 'printTargetLabel', top: '8%', left: '10%', label: '', alwaysShow: false },
      // Dynamic print target name (appears based on dropdown selection)
      { field: 'printTargetName', top: '10%', left: '10%', label: '', alwaysShow: false },
    ]
    ,
    8: [
      // Others Page 2: two fixed ticks and one static N/A box
      { field: 'tick8_1', top: '20%', left: '70%', label: '' },
      { field: 'tick8_2', top: '20%', left: '74%', label: '' },
      { field: 'na_text_3', top: '24%', left: '70%', label: 'N/A' },
      // 51 ticks linked to Client's Business dropdown options
      { field: 'clientBusiness_1', top: '60%', left: '85%', label: '' },
      { field: 'clientBusiness_2', top: '62%', left: '85%', label: '' },
      { field: 'clientBusiness_3', top: '64%', left: '85%', label: '' },
      { field: 'clientBusiness_4', top: '66%', left: '85%', label: '' },
      { field: 'clientBusiness_5', top: '68%', left: '85%', label: '' },
      { field: 'clientBusiness_6', top: '70%', left: '85%', label: '' },
      { field: 'clientBusiness_7', top: '72%', left: '85%', label: '' },
      { field: 'clientBusiness_8', top: '74%', left: '85%', label: '' },
      { field: 'clientBusiness_9', top: '76%', left: '85%', label: '' },
      { field: 'clientBusiness_10', top: '78%', left: '85%', label: '' },
      { field: 'clientBusiness_11', top: '80%', left: '85%', label: '' },
      { field: 'clientBusiness_12', top: '82%', left: '85%', label: '' },
      { field: 'clientBusiness_13', top: '84%', left: '85%', label: '' },
      { field: 'clientBusiness_14', top: '86%', left: '85%', label: '' },
      { field: 'clientBusiness_15', top: '88%', left: '85%', label: '' },
      { field: 'clientBusiness_16', top: '90%', left: '85%', label: '' },
      { field: 'clientBusiness_17', top: '92%', left: '85%', label: '' },
      { field: 'clientBusiness_18', top: '94%', left: '85%', label: '' },
      { field: 'clientBusiness_19', top: '96%', left: '85%', label: '' },
      { field: 'clientBusiness_20', top: '98%', left: '85%', label: '' },
      { field: 'clientBusiness_21', top: '90%', left: '85%', label: '' },
      { field: 'clientBusiness_22', top: '90%', left: '85%', label: '' },
      { field: 'clientBusiness_23', top: '90%', left: '85%', label: '' },
      { field: 'clientBusiness_24', top: '90%', left: '85%', label: '' },
      { field: 'clientBusiness_25', top: '90%', left: '85%', label: '' },
      { field: 'clientBusiness_26', top: '60%', left: '85%', label: '' },
      { field: 'clientBusiness_27', top: '62%', left: '85%', label: '' },
      { field: 'clientBusiness_28', top: '64%', left: '85%', label: '' },
      { field: 'clientBusiness_29', top: '66%', left: '85%', label: '' },
      { field: 'clientBusiness_30', top: '68%', left: '85%', label: '' },
    ]
    ,
    9: [
      // Others Page 3: Client's Business ticks 31-51
      { field: 'clientBusiness_31', top: '10%', left: '85%', label: '' },
      { field: 'clientBusiness_32', top: '12%', left: '85%', label: '' },
      { field: 'clientBusiness_33', top: '14%', left: '85%', label: '' },
      { field: 'clientBusiness_34', top: '16%', left: '85%', label: '' },
      { field: 'clientBusiness_35', top: '18%', left: '85%', label: '' },
      { field: 'clientBusiness_36', top: '20%', left: '85%', label: '' },
      { field: 'clientBusiness_37', top: '22%', left: '85%', label: '' },
      { field: 'clientBusiness_38', top: '24%', left: '85%', label: '' },
      { field: 'clientBusiness_39', top: '26%', left: '85%', label: '' },
      { field: 'clientBusiness_40', top: '28%', left: '85%', label: '' },
      { field: 'clientBusiness_41', top: '30%', left: '85%', label: '' },
      { field: 'clientBusiness_42', top: '32%', left: '85%', label: '' },
      { field: 'clientBusiness_43', top: '34%', left: '85%', label: '' },
      { field: 'clientBusiness_44', top: '36%', left: '85%', label: '' },
      { field: 'clientBusiness_45', top: '38%', left: '85%', label: '' },
      { field: 'clientBusiness_46', top: '40%', left: '85%', label: '' },
      { field: 'clientBusiness_47', top: '42%', left: '85%', label: '' },
      { field: 'clientBusiness_48', top: '44%', left: '85%', label: '' },
      { field: 'clientBusiness_49', top: '46%', left: '85%', label: '' },
      { field: 'clientBusiness_50', top: '48%', left: '85%', label: '' },
      { field: 'clientBusiness_51', top: '50%', left: '85%', label: '' },
      // Client's Profession ticks 1-19
      { field: 'clientProfession_1', top: '52%', left: '85%', label: '' },
      { field: 'clientProfession_2', top: '54%', left: '85%', label: '' },
      { field: 'clientProfession_3', top: '56%', left: '85%', label: '' },
      { field: 'clientProfession_4', top: '58%', left: '85%', label: '' },
      { field: 'clientProfession_5', top: '60%', left: '85%', label: '' },
      { field: 'clientProfession_6', top: '62%', left: '85%', label: '' },
      { field: 'clientProfession_7', top: '64%', left: '85%', label: '' },
      { field: 'clientProfession_8', top: '66%', left: '85%', label: '' },
      { field: 'clientProfession_9', top: '68%', left: '85%', label: '' },
      { field: 'clientProfession_10', top: '70%', left: '85%', label: '' },
      { field: 'clientProfession_11', top: '10%', left: '90%', label: '' },
      { field: 'clientProfession_12', top: '12%', left: '90%', label: '' },
      { field: 'clientProfession_13', top: '14%', left: '90%', label: '' },
      { field: 'clientProfession_14', top: '16%', left: '90%', label: '' },
      { field: 'clientProfession_15', top: '18%', left: '90%', label: '' },
      { field: 'clientProfession_16', top: '20%', left: '90%', label: '' },
      { field: 'clientProfession_17', top: '22%', left: '90%', label: '' },
      { field: 'clientProfession_17', top: '22%', left: '90%', label: '' },
      { field: 'clientProfession_18', top: '24%', left: '90%', label: '' },
      { field: 'clientProfession_19', top: '26%', left: '90%', label: '' },
      // Type of On-boarding Score ticks 1-4
      { field: 'typeOfOnboarding_1', top: '30%', left: '90%', label: '' },
      { field: 'typeOfOnboarding_2', top: '32%', left: '90%', label: '' },
      { field: 'typeOfOnboarding_3', top: '34%', left: '90%', label: '' },
      { field: 'typeOfOnboarding_4', top: '36%', left: '90%', label: '' },
      // PEP/IP/CEO ticks 1-2
      { field: 'pepIpCeo_1', top: '38%', left: '90%', label: '' },
      { field: 'pepIpCeo_2', top: '40%', left: '90%', label: '' },
      // Close Associate of PEP/IP/CEO ticks 1-2
      { field: 'closeAssociate_1', top: '42%', left: '90%', label: '' },
      { field: 'closeAssociate_2', top: '44%', left: '90%', label: '' },
    ],

    // Beneficial Owner page overlays (page 40)
    40: [
      // Beneficial Owner form page overlays - positions based on actual form layout
      { field: 'cif', top: '5.5%', left: '18%', label: 'CIF No' },
      { field: 'accountNumber', top: '8%', left: '18%', label: 'Account No' },
      { field: 'boAmlTrackingNumber', top: '11%', left: '18%', label: 'AML Tracking No' },
      { field: 'fullNameBn', top: '15.5%', left: '18%', label: 'Account Name (Bangla)' },
      { field: 'fullNameEn', top: '18%', left: '18%', label: 'Account Name (English)' },

      { field: 'boNameBn', top: '22%', left: '18%', label: 'BO Name (Bangla)' },
      { field: 'boNameEn', top: '24.5%', left: '18%', label: 'BO Name (English)' },
      { field: 'boDob', top: '27%', left: '18%', label: 'BO Date of Birth' },
      { field: 'boFatherName', top: '29.5%', left: '18%', label: "Father's Name" },
      { field: 'boMotherName', top: '32%', left: '18%', label: "Mother's Name" },
      { field: 'boSpouseName', top: '34.5%', left: '18%', label: 'Spouse Name' },
      { field: 'boNationality', top: '37%', left: '18%', label: 'Nationality' },
      { field: 'boGender', top: '39.5%', left: '18%', label: 'Gender' },
      { field: 'boOccupation', top: '42%', left: '18%', label: 'Occupation (detail)' },
      { field: 'boMonthlyIncome', top: '44.5%', left: '18%', label: 'Monthly Income' },
      { field: 'boSourceOfFund', top: '47%', left: '18%', label: 'Source of Fund (detail)' },
      { field: 'boTin', top: '49.5%', left: '18%', label: 'TIN No (if any)' },

      // Present Address (section 13.A)
      { field: 'boPresentHouse', top: '54%', left: '18%', label: 'Present House/Street' },
      { field: 'boPresentArea', top: '54%', left: '62%', label: 'Present Area/Village' },
      { field: 'boPresentPO', top: '57%', left: '11%', label: 'Present PO' },
      { field: 'boPresentThana', top: '57%', left: '32%', label: 'Present Thana' },
      { field: 'boPresentDistrict', top: '57%', left: '54%', label: 'Present District' },
      { field: 'boPresentPostCode', top: '57%', left: '78%', label: 'Present Post Code' },
      { field: 'boPresentCountry', top: '60%', left: '11%', label: 'Present Country' },
      { field: 'boPresentLandmark', top: '60%', left: '40%', label: 'Present Landmark' },

      // Permanent Address (section B)
      { field: 'boPermanentHouse', top: '65%', left: '18%', label: 'Permanent House/Street' },
      { field: 'boPermanentArea', top: '65%', left: '62%', label: 'Permanent Area/Village' },
      { field: 'boPermanentPO', top: '68%', left: '11%', label: 'Permanent PO' },
      { field: 'boPermanentThana', top: '68%', left: '32%', label: 'Permanent Thana' },
      { field: 'boPermanentDistrict', top: '68%', left: '54%', label: 'Permanent District' },
      { field: 'boPermanentPostCode', top: '68%', left: '78%', label: 'Permanent Post Code' },
      { field: 'boPermanentCountry', top: '71%', left: '11%', label: 'Permanent Country' },
      { field: 'boPermanentLandmark', top: '71%', left: '40%', label: 'Permanent Landmark' },

      // Identity documents (section 14)
      { field: 'boNid', top: '76%', left: '18%', label: 'National ID No' },
      { field: 'boPassport', top: '81%', left: '18%', label: 'Passport/Birth Reg No' },
      { field: 'boPhone', top: '85%', left: '18%', label: 'Phone Number' },
      { field: 'boEmail', top: '85%', left: '55%', label: 'Email Address' },
      { field: 'boBirthReg', top: '90%', left: '18%', label: 'Birth Reg No' },
      { field: 'todayDate', top: '7%', left: '80%', label: 'Date' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
    ],
    10: [
      // Others Page 4: Customer's Average Yearly Transaction ticks 1-4
      { field: 'avgYearlyTransaction_1', top: '10%', left: '85%', label: '' },
      { field: 'avgYearlyTransaction_2', top: '12%', left: '85%', label: '' },
      { field: 'avgYearlyTransaction_3', top: '14%', left: '85%', label: '' },
      { field: 'avgYearlyTransaction_4', top: '16%', left: '85%', label: '' },
      // Has Client Provided Credible Source of Funds ticks 1-2
      { field: 'credibleSourceOfFunds_1', top: '18%', left: '85%', label: '' },
      { field: 'credibleSourceOfFunds_2', top: '20%', left: '85%', label: '' },
      // Client's Business and Profession Scores
      { field: 'clientBusinessScore', top: '25%', left: '85%', label: '' },
      { field: 'clientProfessionScore', top: '27%', left: '85%', label: '' },
      // Total Score (all 7 dropdowns + 2)
      { field: 'totalScoreWithBonus', top: '29%', left: '85%', label: '' },
      { field: 'tick1', top: '90%', left: '14%', label: '' },
      { field: 'tick3', top: '90%', left: '20%', label: '' },
      { field: 'tick2', top: '90%', left: '26%', label: '' },
    ],
    11: [
      // Others Page 5: Risk Assessment
      { field: 'riskAssessment', top: '10%', left: '85%', label: '' },
      // Risk ticks: Low and High
      { field: 'riskLowTick', top: '12%', left: '85%', label: '' },
      { field: 'riskHighTick', top: '14%', left: '85%', label: '' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer2Seal', top: '80%', left: '78%', label: 'Officer 2 Seal', sealType: 'officer2' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
    ],
    13: [
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'cif', top: '10%', left: '48%', label: 'CIF' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'accountTypeName', top: '15%', left: '50%', label: 'Type of Account' },
      { field: 'occupation', top: '82%', left: '35%', label: 'Occupation' },
      { field: 'monthlyIncome', top: '88%', left: '35%', label: 'Probable Monthly Income' },
      { field: 'sourceOfFund', top: '56%', left: '35%', label: 'Source of Fund' },
      // Transaction Profile: Deposits (left side columns)
      { field: 'depositCashCount', top: '26%', left: '8%', label: 'Dep Cash #' },
      { field: 'depositCashAmount', top: '26%', left: '22%', label: 'Dep Cash Amt' },
      { field: 'depositCashTotal', top: '26%', left: '36%', label: 'Dep Cash Tot' },
      { field: 'depositTransferCount', top: '31%', left: '8%', label: 'Dep Trf #' },
      { field: 'depositTransferAmount', top: '31%', left: '22%', label: 'Dep Trf Amt' },
      { field: 'depositTransferTotal', top: '31%', left: '36%', label: 'Dep Trf Tot' },
      // Transaction Profile: Remittance (left side)
      { field: 'depositRemittanceCount', top: '28%', left: '8%', label: 'Dep Rmt #' },
      { field: 'depositRemittanceAmount', top: '28%', left: '22%', label: 'Dep Rmt Amt' },
      { field: 'depositRemittanceTotal', top: '28%', left: '36%', label: 'Dep Rmt Tot' },
      { field: 'depositTotalProbable', top: '36%', left: '36%', label: 'Dep Total' },
      { field: 'depositMaxSingleCombined', top: '41%', left: '36%', label: 'Dep Max Single/Combined' }, 
      // Transaction Profile: Withdrawals (right side columns)
      { field: 'withdrawalCashCount', top: '26%', left: '58%', label: 'Wdr Cash #' },
      { field: 'withdrawalCashAmount', top: '26%', left: '72%', label: 'Wdr Cash Amt' },
      { field: 'withdrawalCashTotal', top: '26%', left: '86%', label: 'Wdr Cash Tot' },
      { field: 'withdrawalTransferCount', top: '31%', left: '58%', label: 'Wdr Trf #' },
      { field: 'withdrawalTransferAmount', top: '31%', left: '72%', label: 'Wdr Trf Amt' },
      { field: 'withdrawalTransferTotal', top: '31%', left: '86%', label: 'Wdr Trf Tot' },
      // Transaction Profile: Remittance (right side)
      { field: 'withdrawalRemittanceCount', top: '28%', left: '58%', label: 'Wdr Rmt #' },
      { field: 'withdrawalRemittanceAmount', top: '28%', left: '72%', label: 'Wdr Rmt Amt' },
      { field: 'withdrawalRemittanceTotal', top: '28%', left: '86%', label: 'Wdr Rmt Tot' },
      { field: 'withdrawalTotalProbable', top: '36%', left: '86%', label: 'Wdr Total' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
      { field: 'withdrawalMaxSingleCombined', top: '80%', left: '78%', label: 'Withdrawal Max Single/Combined'},
    ],
    15: [
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'accountTypeName', top: '15%', left: '50%', label: 'Type of Account' },
      { field: 'accountTypeCode', top: '18%', left: '50%', label: 'Account Type Code' },
      { field: 'occupationProfession', top: '25%', left: '22%', label: 'Occupation/Profession' },
      { field: 'sectorCode', top: '56%', left: '35%', label: 'Sector Code' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer2Seal', top: '80%', left: '78%', label: 'Officer 2 Seal', sealType: 'officer2' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
    ],
    17:[
      { field: 'accountNumberNoSpace', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'tick3', top: '90%', left: '20%', label: '' },
      { field: 'tick3', top: '90%', left: '26%', label: '' },
      { field: 'tick3', top: '90%', left: '28%', label: '' },
      { field: 'tick3', top: '90%', left: '30%', label: '' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'tick3', top: '90%', left: '34%', label: '' },
      { field: 'tick3', top: '90%', left: '35%', label: '' },
      { field: 'tick3', top: '90%', left: '36%', label: '' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
    ],
    // Imperial Pages 18-23 (copy of Conventional pages 1-6)
    18: [
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'combinedApplicants', top: '18.5%', left: '22%', label: 'Full Name joint' },
      { field: 'fullNameBn', top: '11%', left: '35%', label: 'Name (Bangla)' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name 1' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'cif', top: '10%', left: '48%', label: 'CIF' },
      { field: 'nid', top: '20%', left: '60%', label: 'NID Number' },
      { field: 'passportNo', top: '20%', left: '66%', label: 'Passport No' },
      { field: 'combinedApplicantsBn', top: '11%', left: '35%', label: 'Name (Bangla) joint' },
      { field: 'fatherName', top: '14%', left: '35%', label: 'Father Name' },
      { field: 'motherName', top: '17%', left: '35%', label: 'Mother Name' },
      { field: 'spouseName', top: '20%', left: '35%', label: 'Spouse Name' },
      { field: 'dob', top: '23%', left: '35%', label: 'Date of Birth' },
      { field: 'nationality', top: '26%', left: '35%', label: 'Nationality' },
      { field: 'presentHouse', top: '48%', left: '20%', label: 'Present Address' },
      { field: 'presentRoad', top: '52%', left: '20%', label: 'Road' },
      { field: 'presentPostOffice', top: '52%', left: '20%', label: 'Post Office' },
      { field: 'presentPostCode', top: '52%', left: '55%', label: 'Post Code' },
      { field: 'presentPO', top: '52%', left: '70%', label: 'PO' },
      { field: 'presentThana', top: '52%', left: '20%', label: 'Thana' },
      { field: 'presentDistrict', top: '52%', left: '55%', label: 'District' },
      { field: 'presentCountry', top: '52%', left: '20%', label: 'Country' },
      { field: 'permanentHouse', top: '60%', left: '20%', label: 'Permanent Address' },
      { field: 'permanentRoad', top: '64%', left: '20%', label: 'Road' },
      { field: 'permanentPostOffice', top: '64%', left: '20%', label: 'Post Office' },
      { field: 'permanentPostCode', top: '64%', left: '55%', label: 'Post Code' },
      { field: 'permanentPO', top: '64%', left: '70%', label: 'PO' },
      { field: 'permanentThana', top: '64%', left: '20%', label: 'Thana' },
      { field: 'permanentDistrict', top: '64%', left: '55%', label: 'District' },
      { field: 'permanentCountry', top: '64%', left: '20%', label: 'Country' },
      { field: 'mobile', top: '72%', left: '35%', label: 'Mobile' },
      { field: 'email', top: '75%', left: '35%', label: 'Email' },
      { field: 'occupation', top: '82%', left: '35%', label: 'Occupation' },
      { field: 'monthlyIncome', top: '88%', left: '35%', label: 'Probable Monthly Income' },
      { field: 'sourceOfFund', top: '56%', left: '35%', label: 'Source of Fund' },
      { field: 'etin', top: '88%', left: '35%', label: 'ETIN' },
      { field: 'initialDepositWords', top: '92%', left: '50%', label: 'Initial Deposit (In Words)' },
      { field: 'digit1', top: '90%', left: '50%', label: '1' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'tick1', top: '90%', left: '20%', label: '' },
      { field: 'tick2', top: '90%', left: '26%', label: '' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'male', top: '90%', left: '38%', label: '' },
      { field: 'female', top: '90%', left: '44%', label: '' },
      { field: 'initialDeposit', top: '88%', left: '35%', label: 'Initial Deposit' },
      { field: 'birthCertNo', top: '88%', left: '35%', label: 'Birth Certificate' },
      { field: 'chequeBook', top: '86%', left: '70%', label: 'Cheque Book' },
      { field: 'debitCard', top: '86%', left: '76%', label: 'Debit Card' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
    ],
    19: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'fullNameEn', top: '20%', left: '30%', label: 'Account Holder Name' },
      { field: 'introducerDob', top: '30%', left: '35%', label: 'Introducer DOB' },
      { field: 'introducerName', top: '27%', left: '35%', label: 'Introducer Name' },
      { field: 'introducerAccount', top: '33%', left: '35%', label: 'Introducer Account No.' },
      { field: 'amlTrackingNumber', top: '35%', left: '35%', label: 'AML Tracking No.' },
      { field: 'rmCode', top: '38%', left: '35%', label: 'RM Code' },
      { field: 'nomineeName', top: '15%', left: '35%', label: 'Nominee Name' },
      { field: 'nomineeRelation', top: '18%', left: '35%', label: 'Relationship' },
      { field: 'nomineeDob', top: '21%', left: '35%', label: 'Nominee DOB' },
      { field: 'nomineeShare', top: '24%', left: '65%', label: 'Share %' },
      { field: 'nomineeNid', top: '27%', left: '35%', label: 'Nominee NID' },
      { field: 'nomineeAddress', top: '30%', left: '35%', label: 'Nominee Address' },
      { field: 'nomineeMobile', top: '36%', left: '35%', label: 'Nominee Mobile' },
      { field: 'guardianName', top: '40%', left: '35%', label: 'Guardian Name' },
      { field: 'guardianRelation', top: '43%', left: '35%', label: 'Guardian Relation' },
      { field: 'guardianNid', top: '46%', left: '35%', label: 'Guardian NID' },
      { field: 'guardianPermanentAddress', top: '49%', left: '35%', label: 'Guardian Permanent Address' },
      { field: 'guardianMobile', top: '52%', left: '35%', label: 'Guardian Mobile' },
      { field: 'tick3', top: '90%', left: '20%', label: '' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'digit2', top: '90%', left: '50%', label: '2' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' },
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer2Seal', top: '80%', left: '78%', label: 'Officer 2 Seal', sealType: 'officer2' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
    ],
    20: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit3', top: '90%', left: '50%', label: '3' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    21: [
      { field: 'digit4', top: '90%', left: '50%', label: '4' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    22: [
      { field: 'digit5', top: '90%', left: '50%', label: '5' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    23: [
      { field: 'fullNameEn', top: '15%', left: '30%', label: 'Account Holder Name' },
      { field: 'digit6', top: '90%', left: '50%', label: '6' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'thirdApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' }, 
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' }, 
    ],
    // Guardian preview page overlays (page 48)
    48: [
      { field: 'gNameBn', top: '15%', left: '30%', label: 'Guardian Name (Bangla)' },
      { field: 'gNameEn', top: '15%', left: '55%', label: 'Guardian Name (English)' },
      { field: 'gFatherName', top: '18%', left: '11%', label: "Father's Name" },
      { field: 'gMotherName', top: '18%', left: '42%', label: "Mother's Name" },
      { field: 'gSpouseName', top: '21%', left: '11%', label: 'Spouse Name' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name 1' },
      { field: 'gRelation', top: '18%', left: '30%', label: 'Relation' },
      { field: 'gNid', top: '21%', left: '30%', label: 'NID' },
      { field: 'gDob', top: '24%', left: '30%', label: 'Date of Birth' },
      { field: 'gPresentHouse', top: '40%', left: '20%', label: 'Present House/Street' },
      { field: 'gPresentArea', top: '40%', left: '55%', label: 'Present Area/Village' },
      { field: 'gPresentPO', top: '43%', left: '11%', label: 'Present PO' },
      { field: 'gPresentThana', top: '43%', left: '32%', label: 'Present Thana' },
      { field: 'gPresentDistrict', top: '43%', left: '54%', label: 'Present District' },
      { field: 'gPresentPostCode', top: '43%', left: '78%', label: 'Present Post Code' },
      { field: 'gPresentCountry', top: '46%', left: '11%', label: 'Present Country' },
      { field: 'gPermanentHouse', top: '52%', left: '20%', label: 'Permanent House/Street' },
      { field: 'gPermanentArea', top: '52%', left: '55%', label: 'Permanent Area/Village' },
      { field: 'gPermanentPO', top: '55%', left: '11%', label: 'Permanent PO' },
      { field: 'gPermanentThana', top: '55%', left: '32%', label: 'Permanent Thana' },
      { field: 'gPermanentDistrict', top: '55%', left: '54%', label: 'Permanent District' },
      { field: 'gPermanentPostCode', top: '55%', left: '78%', label: 'Permanent Post Code' },
      { field: 'gPermanentCountry', top: '58%', left: '11%', label: 'Permanent Country' },
      { field: 'gPhone', top: '66%', left: '18%', label: 'Phone' },
      { field: 'gEmail', top: '66%', left: '55%', label: 'Email' },
      { field: 'gMale', top: '27%', left: '55%', label: '' },
      { field: 'gFemale', top: '27%', left: '70%', label: '' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'combinedApplicants', top: '18.5%', left: '22%', label: 'Full Name joint' },
      { field: 'combinedApplicantsBn', top: '11%', left: '35%', label: 'Name (Bangla) joint' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'cif', top: '10%', left: '48%', label: 'CIF' },
      { field: 'gOccupation', top: '10%', left: '48%', label: 'Occupation' },
      { field: 'gProfession', top: '10%', left: '48%', label: 'Profession' },
      { field: 'gSourceOfFund', top: '56%', left: '35%', label: 'Source of Fund' },
      { field: 'gMonthlyIncome', top: '88%', left: '35%', label: 'Probable Monthly Income' },
      { field: 'gPassport', top: '20%', left: '66%', label: 'Passport No' },
      { field: 'gBirthReg', top: '20%', left: '66%', label: 'Birth Registration' },
      { field: 'gTin', top: '20%', left: '66%', label: 'TIN' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'digit1', top: '90%', left: '50%', label: '1' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'nationality', top: '26%', left: '35%', label: 'Nationality' },
      // Static guardian label box (always visible)
      { field: 'guardianStaticLabel', top: '4%', left: '10%', label: 'guardian', alwaysShow: true },
      { field: 'amlTrackingNumber', top: '6%', left: '60%', label: 'AML Tracking Number', alwaysShow: true},
      { field: 'gAmlTrackingNumber', top: '6%', left: '60%', label: 'AML Tracking Number 1'},
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
    ],
    // Taqwa Pages 24-29 (copy of Conventional pages 1-6)
    24: [
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'combinedApplicants', top: '18.5%', left: '22%', label: 'Full Name joint' },
      { field: 'fullNameBn', top: '11%', left: '35%', label: 'Name (Bangla)' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name 1' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'cif', top: '10%', left: '48%', label: 'CIF' },
      { field: 'isrBank', top: '14%', left: '70%', label: 'ISR Bank' },
      { field: 'isrCustomer', top: '16%', left: '70%', label: 'ISR Customer' },
      { field: 'nid', top: '20%', left: '60%', label: 'NID Number' },
      { field: 'passportNo', top: '20%', left: '66%', label: 'Passport No' },
      { field: 'combinedApplicantsBn', top: '11%', left: '35%', label: 'Name (Bangla) joint' },
      { field: 'fatherName', top: '14%', left: '35%', label: 'Father Name' },
      { field: 'motherName', top: '17%', left: '35%', label: 'Mother Name' },
      { field: 'spouseName', top: '20%', left: '35%', label: 'Spouse Name' },
      { field: 'dob', top: '23%', left: '35%', label: 'Date of Birth' },
      { field: 'nationality', top: '26%', left: '35%', label: 'Nationality' },
      { field: 'presentHouse', top: '48%', left: '20%', label: 'Present Address' },
      { field: 'presentRoad', top: '52%', left: '20%', label: 'Road' },
      { field: 'presentPostOffice', top: '52%', left: '20%', label: 'Post Office' },
      { field: 'presentPostCode', top: '52%', left: '55%', label: 'Post Code' },
      { field: 'presentPO', top: '52%', left: '70%', label: 'PO' },
      { field: 'presentThana', top: '52%', left: '20%', label: 'Thana' },
      { field: 'presentDistrict', top: '52%', left: '55%', label: 'District' },
      { field: 'presentCountry', top: '52%', left: '20%', label: 'Country' },
      { field: 'permanentHouse', top: '60%', left: '20%', label: 'Permanent Address' },
      { field: 'permanentRoad', top: '64%', left: '20%', label: 'Road' },
      { field: 'permanentPostOffice', top: '64%', left: '20%', label: 'Post Office' },
      { field: 'permanentPostCode', top: '64%', left: '55%', label: 'Post Code' },
      { field: 'permanentPO', top: '64%', left: '70%', label: 'PO' },
      { field: 'permanentThana', top: '64%', left: '20%', label: 'Thana' },
      { field: 'permanentDistrict', top: '64%', left: '55%', label: 'District' },
      { field: 'permanentCountry', top: '64%', left: '20%', label: 'Country' },
      { field: 'mobile', top: '72%', left: '35%', label: 'Mobile' },
      { field: 'email', top: '75%', left: '35%', label: 'Email' },
      { field: 'occupation', top: '82%', left: '35%', label: 'Occupation' },
      { field: 'monthlyIncome', top: '88%', left: '35%', label: 'Probable Monthly Income' },
      { field: 'sourceOfFund', top: '56%', left: '35%', label: 'Source of Fund' },
      { field: 'etin', top: '88%', left: '35%', label: 'ETIN' },
      { field: 'initialDepositWords', top: '92%', left: '50%', label: 'Initial Deposit (In Words)' },
      { field: 'digit1', top: '90%', left: '50%', label: '1' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'tick1', top: '90%', left: '20%', label: '' },
      { field: 'tick2', top: '90%', left: '26%', label: '' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'male', top: '90%', left: '38%', label: '' },
      { field: 'female', top: '90%', left: '44%', label: '' },
      { field: 'initialDeposit', top: '88%', left: '35%', label: 'Initial Deposit' },
      { field: 'birthCertNo', top: '88%', left: '35%', label: 'Birth Certificate' },
      { field: 'chequeBook', top: '86%', left: '70%', label: 'Cheque Book' },
      { field: 'debitCard', top: '86%', left: '76%', label: 'Debit Card' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
    ],
    25: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'fullNameEn', top: '20%', left: '30%', label: 'Account Holder Name' },
      { field: 'introducerDob', top: '30%', left: '35%', label: 'Introducer DOB' },
      { field: 'introducerName', top: '27%', left: '35%', label: 'Introducer Name' },
      { field: 'introducerAccount', top: '33%', left: '35%', label: 'Introducer Account No.' },
      { field: 'amlTrackingNumber', top: '35%', left: '35%', label: 'AML Tracking No.' },
      { field: 'rmCode', top: '38%', left: '35%', label: 'RM Code' },
      { field: 'nomineeName', top: '15%', left: '35%', label: 'Nominee Name' },
      { field: 'nomineeRelation', top: '18%', left: '35%', label: 'Relationship' },
      { field: 'nomineeDob', top: '21%', left: '35%', label: 'Nominee DOB' },
      { field: 'nomineeShare', top: '24%', left: '65%', label: 'Share %' },
      { field: 'nomineeNid', top: '27%', left: '35%', label: 'Nominee NID' },
      { field: 'nomineeAddress', top: '30%', left: '35%', label: 'Nominee Address' },
      { field: 'nomineeMobile', top: '36%', left: '35%', label: 'Nominee Mobile' },
      { field: 'guardianName', top: '40%', left: '35%', label: 'Guardian Name' },
      { field: 'guardianRelation', top: '43%', left: '35%', label: 'Guardian Relation' },
      { field: 'guardianNid', top: '46%', left: '35%', label: 'Guardian NID' },
      { field: 'guardianPermanentAddress', top: '49%', left: '35%', label: 'Guardian Permanent Address' },
      { field: 'guardianMobile', top: '52%', left: '35%', label: 'Guardian Mobile' },
      { field: 'tick3', top: '90%', left: '20%', label: '' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'digit2', top: '90%', left: '50%', label: '2' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' },
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer2Seal', top: '80%', left: '78%', label: 'Officer 2 Seal', sealType: 'officer2' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
    ],
    26: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit3', top: '90%', left: '50%', label: '3' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    27: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit4', top: '90%', left: '50%', label: '4' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    28: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit5', top: '90%', left: '50%', label: '5' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    29: [
      { field: 'fullNameEn', top: '15%', left: '30%', label: 'Account Holder Name' },
      { field: 'digit6', top: '90%', left: '50%', label: '6' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'thirdApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' }, 
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' },
    ],
    // Taqwa Imperial Pages 30-35 (copy of Conventional pages 1-6)
    30: [
      { field: 'fullNameEn', top: '18.5%', left: '22%', label: 'Full Name (English)' },
      { field: 'combinedApplicants', top: '18.5%', left: '22%', label: 'Full Name joint' },
      { field: 'fullNameBn', top: '11%', left: '35%', label: 'Name (Bangla)' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name' },
      { field: 'branchName', top: '6%', left: '70%', label: 'Branch Name 1' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'cif', top: '10%', left: '48%', label: 'CIF' },
      { field: 'isrBank', top: '14%', left: '70%', label: 'ISR Bank' },
      { field: 'isrCustomer', top: '16%', left: '70%', label: 'ISR Customer' },
      { field: 'nid', top: '20%', left: '60%', label: 'NID Number' },
      { field: 'passportNo', top: '20%', left: '66%', label: 'Passport No' },
      { field: 'combinedApplicantsBn', top: '11%', left: '35%', label: 'Name (Bangla) joint' },
      { field: 'fatherName', top: '14%', left: '35%', label: 'Father Name' },
      { field: 'motherName', top: '17%', left: '35%', label: 'Mother Name' },
      { field: 'spouseName', top: '20%', left: '35%', label: 'Spouse Name' },
      { field: 'dob', top: '23%', left: '35%', label: 'Date of Birth' },
      { field: 'nationality', top: '26%', left: '35%', label: 'Nationality' },
      { field: 'presentHouse', top: '48%', left: '20%', label: 'Present Address' },
      { field: 'presentRoad', top: '52%', left: '20%', label: 'Road' },
      { field: 'presentPostOffice', top: '52%', left: '20%', label: 'Post Office' },
      { field: 'presentPostCode', top: '52%', left: '55%', label: 'Post Code' },
      { field: 'presentPO', top: '52%', left: '70%', label: 'PO' },
      { field: 'presentThana', top: '52%', left: '20%', label: 'Thana' },
      { field: 'presentDistrict', top: '52%', left: '55%', label: 'District' },
      { field: 'presentCountry', top: '52%', left: '20%', label: 'Country' },
      { field: 'permanentHouse', top: '60%', left: '20%', label: 'Permanent Address' },
      { field: 'permanentRoad', top: '64%', left: '20%', label: 'Road' },
      { field: 'permanentPostOffice', top: '64%', left: '20%', label: 'Post Office' },
      { field: 'permanentPostCode', top: '64%', left: '55%', label: 'Post Code' },
      { field: 'permanentPO', top: '64%', left: '70%', label: 'PO' },
      { field: 'permanentThana', top: '64%', left: '20%', label: 'Thana' },
      { field: 'permanentDistrict', top: '64%', left: '55%', label: 'District' },
      { field: 'permanentCountry', top: '64%', left: '20%', label: 'Country' },
      { field: 'mobile', top: '72%', left: '35%', label: 'Mobile' },
      { field: 'email', top: '75%', left: '35%', label: 'Email' },
      { field: 'occupation', top: '82%', left: '35%', label: 'Occupation' },
      { field: 'monthlyIncome', top: '88%', left: '35%', label: 'Probable Monthly Income' },
      { field: 'sourceOfFund', top: '56%', left: '35%', label: 'Source of Fund' },
      { field: 'etin', top: '88%', left: '35%', label: 'ETIN' },
      { field: 'initialDepositWords', top: '92%', left: '50%', label: 'Initial Deposit (In Words)' },
      { field: 'digit1', top: '90%', left: '50%', label: '1' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'tick1', top: '90%', left: '20%', label: '' },
      { field: 'tick2', top: '90%', left: '26%', label: '' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'male', top: '90%', left: '38%', label: '' },
      { field: 'female', top: '90%', left: '44%', label: '' },
      { field: 'initialDeposit', top: '88%', left: '35%', label: 'Initial Deposit' },
      { field: 'birthCertNo', top: '88%', left: '35%', label: 'Birth Certificate' },
      { field: 'chequeBook', top: '86%', left: '70%', label: 'Cheque Book' },
      { field: 'debitCard', top: '86%', left: '76%', label: 'Debit Card' },
      { field: 'tick3', top: '90%', left: '32%', label: '' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
    ],
    31: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number 1' },
      { field: 'fullNameEn', top: '20%', left: '30%', label: 'Account Holder Name' },
      { field: 'introducerDob', top: '30%', left: '35%', label: 'Introducer DOB' },
      { field: 'introducerName', top: '27%', left: '35%', label: 'Introducer Name' },
      { field: 'introducerAccount', top: '33%', left: '35%', label: 'Introducer Account No.' },
      { field: 'amlTrackingNumber', top: '35%', left: '35%', label: 'AML Tracking No.' },
      { field: 'rmCode', top: '38%', left: '35%', label: 'RM Code' },
      { field: 'nomineeName', top: '15%', left: '35%', label: 'Nominee Name' },
      { field: 'nomineeRelation', top: '18%', left: '35%', label: 'Relationship' },
      { field: 'nomineeDob', top: '21%', left: '35%', label: 'Nominee DOB' },
      { field: 'nomineeShare', top: '24%', left: '65%', label: 'Share %' },
      { field: 'nomineeNid', top: '27%', left: '35%', label: 'Nominee NID' },
      { field: 'nomineeAddress', top: '30%', left: '35%', label: 'Nominee Address' },
      { field: 'nomineeMobile', top: '36%', left: '35%', label: 'Nominee Mobile' },
      { field: 'guardianName', top: '40%', left: '35%', label: 'Guardian Name' },
      { field: 'guardianRelation', top: '43%', left: '35%', label: 'Guardian Relation' },
      { field: 'guardianNid', top: '46%', left: '35%', label: 'Guardian NID' },
      { field: 'guardianPermanentAddress', top: '49%', left: '35%', label: 'Guardian Permanent Address' },
      { field: 'guardianMobile', top: '52%', left: '35%', label: 'Guardian Mobile' },
      { field: 'tick3', top: '90%', left: '20%', label: '' },
      { field: 'ownership_single', top: '90%', left: '20%', label: '' },
      { field: 'ownership_joint', top: '90%', left: '26%', label: '' },
      { field: 'digit2', top: '90%', left: '50%', label: '2' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' },
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' },
      { field: 'officer1Seal', top: '80%', left: '68%', label: 'Officer 1 Seal', sealType: 'officer1' },
      { field: 'officer2Seal', top: '80%', left: '78%', label: 'Officer 2 Seal', sealType: 'officer2' },
      { field: 'officer3Seal', top: '80%', left: '88%', label: 'Officer 3 Seal', sealType: 'officer3' },
    ],
    32: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit3', top: '90%', left: '50%', label: '3' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    33: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit4', top: '90%', left: '50%', label: '4' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    34: [
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'digit5', top: '90%', left: '50%', label: '5' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
    ],
    35: [
      { field: 'fullNameEn', top: '15%', left: '30%', label: 'Account Holder Name' },
      { field: 'digit6', top: '90%', left: '50%', label: '6' },
      { field: 'digit6', top: '90%', left: '56%', label: '6' },
      { field: 'accountNumber', top: '12%', left: '28%', label: 'Account Number' },
      { field: 'todayDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'thirdApplicantDate', top: '6%', left: '85%', label: 'Date' },
      { field: 'secondApplicantName', top: '52%', left: '35%', label: 'Second Applicant Name' }, 
      { field: 'thirdApplicantName', top: '55%', left: '35%', label: 'Third Applicant Name' },
    ]
  };

  // Initialize overlays
  function initializeOverlays() {
    const savedPositions = loadPositions();
    
    Object.keys(overlayConfig).forEach(pageNum => {
      const page = document.querySelector(`.form-page[data-page="${pageNum}"]`);
      if (!page) return;
      
      overlayConfig[pageNum].forEach((config, index) => {
        const overlay = document.createElement('div');
        // If the corresponding form element is a checkbox, or this overlay is a fixed tick, use the check overlay style
        const boundEl = form.elements[config.field];
        // Do NOT treat digit overlays (digit1..digit6) as tick overlays — keep their normal size
        const isFixedTick = typeof config.field === 'string' && (
          config.field.startsWith('tick') ||
          config.field.startsWith('ownership_') ||
          config.field.startsWith('beneficialOwners_') ||
          config.field.startsWith('nid_tick') ||
          config.field.startsWith('birth_tick') ||
          config.field.startsWith('passport_tick') ||
          config.field.startsWith('clientBusiness_') ||
          config.field.startsWith('clientProfession_') ||
          config.field.startsWith('typeOfOnboarding_') ||
          config.field.startsWith('pepIpCeo_') ||
          config.field.startsWith('closeAssociate_') ||
          config.field.startsWith('avgYearlyTransaction_') ||
          config.field.startsWith('credibleSourceOfFunds_') ||
          config.field.startsWith('riskLowTick') ||
          config.field.startsWith('riskHighTick') ||
          config.field === 'male' || config.field === 'female' ||
          config.field === 'gMale' || config.field === 'gFemale'
        );
        overlay.className = (isFixedTick || (boundEl && boundEl.type === 'checkbox') || config.field === 'chequeBook' || config.field === 'debitCard') ? 'overlay overlay-check' : 'overlay';
        overlay.dataset.field = config.field;
        overlay.dataset.page = pageNum;
        overlay.dataset.index = index;
        
        // Use saved position or default
        const key = `${pageNum}_${config.field}_${index}`;
        if (savedPositions[key]) {
          overlay.style.top = savedPositions[key].top;
          overlay.style.left = savedPositions[key].left;
        } else {
          overlay.style.top = config.top;
          overlay.style.left = config.left;
        }

        // For combined applicants overlay keep single-line formatting (we'll insert ' AND ' between names)
        if (config.field === 'combinedApplicants') {
          overlay.style.whiteSpace = 'normal';
          overlay.style.whiteSpace = 'nowrap';
        }
        
        overlay.textContent = config.label;
        overlay.classList.add('overlay-empty');

        // Apply optional layout overrides from config
        if (config.width) overlay.style.width = config.width;
        if (config.height) overlay.style.height = config.height;
        if (config.className) overlay.classList.add(config.className);
        // alwaysShow overlays should be visible regardless of value
        if (config.alwaysShow) overlay.classList.remove('overlay-empty');

        page.appendChild(overlay);
      });
    });
  }

  // Update overlays with form data
  // Format account numbers for display (visual only)
  function formatAccountNumber(value) {
    if (!value) return '';
    // Remove existing spaces then insert five non-breaking spaces after every character
    const cleaned = String(value).replace(/\s+/g, '');
    // Insert NBSPs after each character, then remove trailing NBSPs
    let spaced = cleaned.replace(/(.{1})/g, '$1\u00A0\u00A0\u00A0\u00A0');
    spaced = spaced.replace(/\u00A0+$/g, '');
    return spaced;
  }

  // Format a date so each digit is separated by three non-breaking spaces: d   d   m   m   y   y   y   y
  function formatDateDigits(dateValue) {
    if (!dateValue) return '';
    const dt = new Date(dateValue);
    if (isNaN(dt)) return '';
    const dd = String(dt.getDate()).padStart(2, '0');
    const mm = String(dt.getMonth() + 1).padStart(2, '0');
    const yyyy = String(dt.getFullYear()).padStart(4, '0');
    const gap = '\u00A0\u00A0\u00A0\u00A0';
    // join digits with gap, then join components with gap as well
    const parts = [dd, mm, yyyy].map(part => part.split('').join(gap));
    return parts.join(gap);
  }

  // Convert number to words using Indian numbering (supports up to crores)
  function numberToWords(amount) {
    if (amount == null || amount === '') return '';
    // Remove commas and non-numeric except dot
    const cleaned = String(amount).replace(/,/g, '').trim();
    if (cleaned === '') return '';
    const parts = cleaned.split('.');
    const intPart = parseInt(parts[0], 10);
    const decPart = parts[1] ? parts[1].slice(0,2) : '';
    if (isNaN(intPart)) return '';

    const ones = ['', 'One','Two','Three','Four','Five','Six','Seven','Eight','Nine','Ten','Eleven','Twelve','Thirteen','Fourteen','Fifteen','Sixteen','Seventeen','Eighteen','Nineteen'];
    const tens = ['', '','Twenty','Thirty','Forty','Fifty','Sixty','Seventy','Eighty','Ninety'];

    function twoDigit(n) {
      if (n < 20) return ones[n];
      const ten = Math.floor(n/10);
      const one = n % 10;
      return tens[ten] + (one ? ' ' + ones[one] : '');
    }

    function threeDigit(n) {
      const hundred = Math.floor(n/100);
      const rest = n % 100;
      return (hundred ? ones[hundred] + ' Hundred' + (rest ? ' ' : '') : '') + (rest ? twoDigit(rest) : '');
    }

    let n = intPart;
    let words = '';

    const crore = Math.floor(n / 10000000);
    if (crore) { words += threeDigit(crore) + ' Crore'; n = n % 10000000; }

    const lakh = Math.floor(n / 100000);
    if (lakh) { words += (words ? ' ' : '') + threeDigit(lakh) + ' Lakh'; n = n % 100000; }

    const thousand = Math.floor(n / 1000);
    if (thousand) { words += (words ? ' ' : '') + threeDigit(thousand) + ' Thousand'; n = n % 1000; }

    if (n) { words += (words ? ' ' : '') + threeDigit(n); }

    if (!words) words = 'Zero';

    // Paisa (decimal) part
    let paisaWords = '';
    if (decPart) {
      const paisaNum = parseInt(decPart.padEnd(2,'0').slice(0,2), 10);
      if (!isNaN(paisaNum) && paisaNum > 0) paisaWords = twoDigit(paisaNum);
    }

    let result = words + ' Taka';
    if (paisaWords) result += ' and ' + paisaWords + ' Paisa';
    result += ' Only';
    return result;
  }

  // Translate an array of English name parts to Bangla and join with ' এবং '
  async function translateNamesToBn(parts) {
    try {
      const cleaned = parts.map(p => (p || '').trim()).filter(Boolean);
      if (cleaned.length === 0) return '';
      const translatedParts = await Promise.all(cleaned.map(p => translateText(p)));
      // If translation fails for a part, fall back to the original part
      const final = translatedParts.map((t, i) => (t && t.trim()) ? t.trim() : cleaned[i]);
      return final.join(' এবং ');
    } catch (e) {
      console.error('translateNamesToBn error', e);
      return parts.map(p => p || '').filter(Boolean).join(' এবং ');
    }
  }

  function updateOverlays() {
    const formData = new FormData(form);
    const data = {};
    
    for (let [key, value] of formData.entries()) {
      data[key] = value;
    }
    
    // Explicitly add BO post code fields if they exist in form
    if (form.elements['boPresentPostCode']) data['boPresentPostCode'] = form.elements['boPresentPostCode'].value;
    if (form.elements['boPermanentPostCode']) data['boPermanentPostCode'] = form.elements['boPermanentPostCode'].value;
    
    // Handle checkboxes
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
      if (cb.name && !cb.name.startsWith('same')) {
        data[cb.name] = cb.checked ? 'Yes' : '';
      }
    });

    // Format main DOB so each digit is separated: d   d   m   m   y   y   y   y
    if (data.dob) {
      data.dob = formatDateDigits(data.dob);
    }

    // Combine address fields for display
    if (data.presentHouse || data.presentRoad) {
      data.presentAddress = [data.presentHouse, data.presentRoad, data.presentPO].filter(Boolean).join(', ');
    }
    if (data.permanentHouse || data.permanentRoad) {
      data.permanentAddress = [data.permanentHouse, data.permanentRoad, data.permanentPO].filter(Boolean).join(', ');
    }

    // Force country to Bangladesh on page overlays (fixed value)
    try{ data.presentCountry = 'Bangladesh'; }catch(e){}

    // Derive account type name from account number and set a code for overlays
    try {
      const acctNum = (data.accountNumber || '').toString();
      const derivedName = getAccountTypeFromNumber(acctNum) || (data.accountTypeName || '');
      data.accountTypeName = derivedName;
      // If account type contains 'current' (case-insensitive) use code 100, otherwise 130
      if (String(derivedName).toLowerCase().includes('current')) {
        data.accountTypeCode = '100';
      } else {
        data.accountTypeCode = '130';
      }
    } catch (e) {
      data.accountTypeCode = '130';
    }

    // Add today's date (for preview only) in format DD<NBSP*3>MM<NBSP*3>YYYY
    try {
      const dt = new Date();
      const dd = String(dt.getDate()).padStart(2, '0');
      const mm = String(dt.getMonth() + 1).padStart(2, '0');
      const yyyy = dt.getFullYear();
      const gap = '\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0';
      data.todayDate = dd + gap + mm + gap + yyyy;
    } catch (e) {
      data.todayDate = '';
    }

    // Convert initial deposit amount into words for display
    try {
      data.initialDepositWords = numberToWords(data.initialDeposit || '');
    } catch (e) {
      data.initialDepositWords = '';
    }

    // Add print target label and name from dropdown (stored in form.dataset)
    if (form && form.dataset) {
      if (form.dataset.printTargetLabel) {
        data.printTargetLabel = form.dataset.printTargetLabel;
      }
      if (form.dataset.printTargetNameField) {
        // Map the dynamic field name to its actual value
        const fieldName = form.dataset.printTargetNameField;
        data.printTargetName = data[fieldName] || '';
      }
    }

    // Update all overlays
    document.querySelectorAll('.overlay, .overlay-check').forEach(overlay => {
      const field = overlay.dataset.field;
      const boundEl = form.elements[field];
      // Prefer value from collected form data, fall back to the actual input element's value
      const value = (data[field] !== undefined && data[field] !== null) ? data[field] : ((boundEl && boundEl.value) || '');
      let displayValue = '';

      // Ticks: some tick overlays are conditional based on account type
      if (overlay.dataset.field && overlay.dataset.field.startsWith('tick')) {
        // Determine account type name (derived from account number or field)
        const acctNum = data.accountNumber || '';
        const acctTypeName = (getAccountTypeFromNumber(acctNum) || (data.accountTypeName || '') || '').toString().toLowerCase();

        if (overlay.dataset.field === 'tick1') {
          // tick1: show when account type is 'current' (contains 'current')
          displayValue = acctTypeName.includes('current') ? '✔' : '';
        } else if (overlay.dataset.field === 'tick2') {
          // tick2: show when account type is any type other than 'current'
          // only show if we have any account type resolved
          displayValue = (acctTypeName && !acctTypeName.includes('current')) ? '✔' : '';
        } else {
          // default: other tick fields (e.g., tick3) remain always checked
          displayValue = '✔';
        }
      }

      // If this overlay represents account ownership ticks, render based on dropdown value
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('ownership_')) {
        const ownership = form.elements['accountOwnership'] ? form.elements['accountOwnership'].value : '';
        if (overlay.dataset.field === 'ownership_single') {
          displayValue = ownership === 'single' ? '✔' : '';
        } else if (overlay.dataset.field === 'ownership_joint') {
          displayValue = ownership === 'joint' ? '✔' : '';
        } else {
          displayValue = '';
        }
      }

      // Gender tick overlays (male/female) — bound to the select `accountGender`
      else if (field === 'male' || field === 'female') {
        const genderVal = form.elements['accountGender'] ? form.elements['accountGender'].value : '';
        displayValue = (genderVal === field) ? '✔' : '';
      }

      // Guardian Gender tick overlays (gMale/gFemale) — bound to the select `gGender`
      else if (field === 'gMale' || field === 'gFemale') {
        const gGenderVal = form.elements['gGender'] ? form.elements['gGender'].value : '';
        if (field === 'gMale') {
          displayValue = (gGenderVal === 'male') ? '✔' : '';
        } else if (field === 'gFemale') {
          displayValue = (gGenderVal === 'female') ? '✔' : '';
        } else {
          displayValue = '';
        }
      }

      // Beneficial Owner(s) ticks: two separate overlay positions (beneficialOwners_yes / beneficialOwners_no)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('beneficialOwners_')) {
        const boVal = form.elements['beneficialOwners'] ? String(form.elements['beneficialOwners'].value || '').toLowerCase() : '';
        if (overlay.dataset.field === 'beneficialOwners_yes') {
          displayValue = (boVal === 'yes' || boVal === 'y' || boVal === 'true') ? '✔' : '';
        } else if (overlay.dataset.field === 'beneficialOwners_no') {
          displayValue = (boVal === 'no' || boVal === 'n' || boVal === 'false') ? '✔' : '';
        } else {
          displayValue = '';
        }
      }

      // NID / Birth / Passport tick overlays: each has two positions. Show tick when the corresponding value exists.
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('nid_tick')) {
        const nidVal = form.elements['nid'] ? String(form.elements['nid'].value || '').trim() : '';
        displayValue = nidVal ? '✔' : '';
      }
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('birth_tick')) {
        const bVal = form.elements['birthCertNo'] ? String(form.elements['birthCertNo'].value || '').trim() : '';
        displayValue = bVal ? '✔' : '';
      }
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('passport_tick')) {
        const pVal = form.elements['passportNo'] ? String(form.elements['passportNo'].value || '').trim() : '';
        displayValue = pVal ? '✔' : '';
      }
      // Client's Business ticks: 51 positions linked to dropdown options (clientBusiness_1 to clientBusiness_51)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('clientBusiness_')) {
        const tickNum = parseInt(overlay.dataset.field.split('_')[1], 10);
        const selectEl = form.elements['clientBusiness'];
        if (selectEl && selectEl.selectedIndex > 0 && selectEl.selectedIndex === tickNum) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // Client's Profession ticks: 19 positions linked to dropdown options (clientProfession_1 to clientProfession_19)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('clientProfession_')) {
        const tickNum = parseInt(overlay.dataset.field.split('_')[1], 10);
        const selectEl = form.elements['clientProfession'];
        if (selectEl && selectEl.selectedIndex > 0 && selectEl.selectedIndex === tickNum) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // Type of On-boarding Score ticks: 4 positions linked to dropdown options (typeOfOnboarding_1 to typeOfOnboarding_4)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('typeOfOnboarding_')) {
        const tickNum = parseInt(overlay.dataset.field.split('_')[1], 10);
        const selectEl = form.elements['typeOfOnboardingScore'];
        if (selectEl && selectEl.selectedIndex > 0 && selectEl.selectedIndex === tickNum) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // PEP/IP/CEO ticks: 2 positions linked to dropdown options (pepIpCeo_1 to pepIpCeo_2)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('pepIpCeo_')) {
        const tickNum = parseInt(overlay.dataset.field.split('_')[1], 10);
        const selectEl = form.elements['pepIpCeo'];
        if (selectEl && selectEl.selectedIndex > 0 && selectEl.selectedIndex === tickNum) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // Close Associate of PEP/IP/CEO ticks: 2 positions linked to dropdown options (closeAssociate_1 to closeAssociate_2)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('closeAssociate_')) {
        const tickNum = parseInt(overlay.dataset.field.split('_')[1], 10);
        const selectEl = form.elements['closeAssociatePepIpCeo'];
        if (selectEl && selectEl.selectedIndex > 0 && selectEl.selectedIndex === tickNum) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // Customer's Average Yearly Transaction ticks: 4 positions linked to dropdown options (avgYearlyTransaction_1 to avgYearlyTransaction_4)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('avgYearlyTransaction_')) {
        const tickNum = parseInt(overlay.dataset.field.split('_')[1], 10);
        const selectEl = form.elements['avgYearlyTransaction'];
        if (selectEl && selectEl.selectedIndex > 0 && selectEl.selectedIndex === tickNum) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // Has Client Provided Credible Source of Funds ticks: 2 positions linked to dropdown options (credibleSourceOfFunds_1 to credibleSourceOfFunds_2)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('credibleSourceOfFunds_')) {
        const tickNum = parseInt(overlay.dataset.field.split('_')[1], 10);
        const selectEl = form.elements['credibleSourceOfFunds'];
        if (selectEl && selectEl.selectedIndex > 0 && selectEl.selectedIndex === tickNum) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // Static N/A text boxes for the Others page
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('na_text')) {
        displayValue = 'N/A';
      }
      // Client's Business Score display
      else if (field === 'clientBusinessScore') {
        const selectEl = form.elements['clientBusiness'];
        if (selectEl && selectEl.selectedIndex > 0) {
          const selectedText = selectEl.options[selectEl.selectedIndex].text;
          const scoreMatch = selectedText.match(/Score:\s*(\d+(?:-\d+)?)/);
          displayValue = scoreMatch ? scoreMatch[1] : '';
        } else {
          displayValue = '';
        }
      }
      // Client's Profession Score display
      else if (field === 'clientProfessionScore') {
        const selectEl = form.elements['clientProfession'];
        if (selectEl && selectEl.selectedIndex > 0) {
          const selectedText = selectEl.options[selectEl.selectedIndex].text;
          const scoreMatch = selectedText.match(/Score:\s*(\d+(?:-\d+)?)/);
          displayValue = scoreMatch ? scoreMatch[1] : '';
        } else {
          displayValue = '';
        }
      }
      // Total Score from all 7 dropdowns + 2
      else if (field === 'totalScoreWithBonus') {
        let totalScore = 2; // Starting with the +2 bonus
        
        // Get score from Client's Business
        const businessEl = form.elements['clientBusiness'];
        if (businessEl && businessEl.selectedIndex > 0) {
          const businessText = businessEl.options[businessEl.selectedIndex].text;
          const businessMatch = businessText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (businessMatch) {
            const scoreStr = businessMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10); // Use first number if range
          }
        }
        
        // Get score from Client's Profession
        const professionEl = form.elements['clientProfession'];
        if (professionEl && professionEl.selectedIndex > 0) {
          const professionText = professionEl.options[professionEl.selectedIndex].text;
          const professionMatch = professionText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (professionMatch) {
            const scoreStr = professionMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Type of On-boarding Score
        const onboardingEl = form.elements['typeOfOnboardingScore'];
        if (onboardingEl && onboardingEl.selectedIndex > 0) {
          const onboardingText = onboardingEl.options[onboardingEl.selectedIndex].text;
          const onboardingMatch = onboardingText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (onboardingMatch) {
            const scoreStr = onboardingMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from PEP/IP/CEO
        const pepEl = form.elements['pepIpCeo'];
        if (pepEl && pepEl.selectedIndex > 0) {
          const pepText = pepEl.options[pepEl.selectedIndex].text;
          const pepMatch = pepText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (pepMatch) {
            const scoreStr = pepMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Close Associate of PEP/IP/CEO
        const associateEl = form.elements['closeAssociatePepIpCeo'];
        if (associateEl && associateEl.selectedIndex > 0) {
          const associateText = associateEl.options[associateEl.selectedIndex].text;
          const associateMatch = associateText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (associateMatch) {
            const scoreStr = associateMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Customer's Average Yearly Transaction
        const txnEl = form.elements['avgYearlyTransaction'];
        if (txnEl && txnEl.selectedIndex > 0) {
          const txnText = txnEl.options[txnEl.selectedIndex].text;
          const txnMatch = txnText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (txnMatch) {
            const scoreStr = txnMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Has Client Provided Credible Source of Funds
        const sourceEl = form.elements['credibleSourceOfFunds'];
        if (sourceEl && sourceEl.selectedIndex > 0) {
          const sourceText = sourceEl.options[sourceEl.selectedIndex].text;
          const sourceMatch = sourceText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (sourceMatch) {
            const scoreStr = sourceMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // If account type is Current, add an extra +3 to the total score
        try {
          const acctNumForBonus = data.accountNumber || '';
          const acctTypeForBonus = (getAccountTypeFromNumber(acctNumForBonus) || (data.accountTypeName || '')).toString().toLowerCase();
          if (acctTypeForBonus.includes('current')) totalScore += 3;
        } catch (e) {}

        displayValue = String(totalScore);
      }
      // Risk Assessment: High if total score >= 15 or account type is "Imperial Savings", otherwise Low
      else if (field === 'riskAssessment') {
        let totalScore = 2; // Starting with the +2 bonus
        
        // Get score from Client's Business
        const businessEl = form.elements['clientBusiness'];
        if (businessEl && businessEl.selectedIndex > 0) {
          const businessText = businessEl.options[businessEl.selectedIndex].text;
          const businessMatch = businessText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (businessMatch) {
            const scoreStr = businessMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Client's Profession
        const professionEl = form.elements['clientProfession'];
        if (professionEl && professionEl.selectedIndex > 0) {
          const professionText = professionEl.options[professionEl.selectedIndex].text;
          const professionMatch = professionText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (professionMatch) {
            const scoreStr = professionMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Type of On-boarding Score
        const onboardingEl = form.elements['typeOfOnboardingScore'];
        if (onboardingEl && onboardingEl.selectedIndex > 0) {
          const onboardingText = onboardingEl.options[onboardingEl.selectedIndex].text;
          const onboardingMatch = onboardingText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (onboardingMatch) {
            const scoreStr = onboardingMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from PEP/IP/CEO
        const pepEl = form.elements['pepIpCeo'];
        if (pepEl && pepEl.selectedIndex > 0) {
          const pepText = pepEl.options[pepEl.selectedIndex].text;
          const pepMatch = pepText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (pepMatch) {
            const scoreStr = pepMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Close Associate of PEP/IP/CEO
        const associateEl = form.elements['closeAssociatePepIpCeo'];
        if (associateEl && associateEl.selectedIndex > 0) {
          const associateText = associateEl.options[associateEl.selectedIndex].text;
          const associateMatch = associateText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (associateMatch) {
            const scoreStr = associateMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Customer's Average Yearly Transaction
        const txnEl = form.elements['avgYearlyTransaction'];
        if (txnEl && txnEl.selectedIndex > 0) {
          const txnText = txnEl.options[txnEl.selectedIndex].text;
          const txnMatch = txnText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (txnMatch) {
            const scoreStr = txnMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Has Client Provided Credible Source of Funds
        const sourceEl = form.elements['credibleSourceOfFunds'];
        if (sourceEl && sourceEl.selectedIndex > 0) {
          const sourceText = sourceEl.options[sourceEl.selectedIndex].text;
          const sourceMatch = sourceText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (sourceMatch) {
            const scoreStr = sourceMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // If account type is Current, add an extra +3 to the total score
        try {
          const acctNumForRisk = data.accountNumber || '';
          const acctTypeForRisk = (getAccountTypeFromNumber(acctNumForRisk) || (data.accountTypeName || '')).toString().toLowerCase();
          if (acctTypeForRisk.includes('current')) totalScore += 3;
        } catch (e) {}

        // Get account type from account number using getAccountTypeFromNumber function
        const accountNum = data.accountNumber || '';
        const accountType = getAccountTypeFromNumber(accountNum);

        // Determine risk: High if total score >= 15 OR account type is "Imperial Savings" or "Mudarabah Imperial Savings", otherwise Low
        if (totalScore >= 15 || accountType === 'Imperial Savings' || accountType === 'Mudarabah Imperial Savings') {
          displayValue = 'RISK IS HIGH';
        } else {
          displayValue = 'RISK IS LOW';
        }
      }
      // Risk Low Tick: Show tick if risk is LOW
      else if (field === 'riskLowTick') {
        let totalScore = 2; // Starting with the +2 bonus
        
        // Get score from Client's Business
        const businessEl = form.elements['clientBusiness'];
        if (businessEl && businessEl.selectedIndex > 0) {
          const businessText = businessEl.options[businessEl.selectedIndex].text;
          const businessMatch = businessText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (businessMatch) {
            const scoreStr = businessMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Client's Profession
        const professionEl = form.elements['clientProfession'];
        if (professionEl && professionEl.selectedIndex > 0) {
          const professionText = professionEl.options[professionEl.selectedIndex].text;
          const professionMatch = professionText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (professionMatch) {
            const scoreStr = professionMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Type of On-boarding Score
        const onboardingEl = form.elements['typeOfOnboardingScore'];
        if (onboardingEl && onboardingEl.selectedIndex > 0) {
          const onboardingText = onboardingEl.options[onboardingEl.selectedIndex].text;
          const onboardingMatch = onboardingText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (onboardingMatch) {
            const scoreStr = onboardingMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from PEP/IP/CEO
        const pepEl = form.elements['pepIpCeo'];
        if (pepEl && pepEl.selectedIndex > 0) {
          const pepText = pepEl.options[pepEl.selectedIndex].text;
          const pepMatch = pepText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (pepMatch) {
            const scoreStr = pepMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Close Associate of PEP/IP/CEO
        const associateEl = form.elements['closeAssociatePepIpCeo'];
        if (associateEl && associateEl.selectedIndex > 0) {
          const associateText = associateEl.options[associateEl.selectedIndex].text;
          const associateMatch = associateText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (associateMatch) {
            const scoreStr = associateMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Customer's Average Yearly Transaction
        const txnEl = form.elements['avgYearlyTransaction'];
        if (txnEl && txnEl.selectedIndex > 0) {
          const txnText = txnEl.options[txnEl.selectedIndex].text;
          const txnMatch = txnText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (txnMatch) {
            const scoreStr = txnMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Has Client Provided Credible Source of Funds
        const sourceEl = form.elements['credibleSourceOfFunds'];
        if (sourceEl && sourceEl.selectedIndex > 0) {
          const sourceText = sourceEl.options[sourceEl.selectedIndex].text;
          const sourceMatch = sourceText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (sourceMatch) {
            const scoreStr = sourceMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // If account type is Current, add an extra +3 to the total score
        try {
          const acctNumForRiskLow = data.accountNumber || '';
          const acctTypeForRiskLow = (getAccountTypeFromNumber(acctNumForRiskLow) || (data.accountTypeName || '')).toString().toLowerCase();
          if (acctTypeForRiskLow.includes('current')) totalScore += 3;
        } catch (e) {}

        // Get account type from account number using getAccountTypeFromNumber function
        const accountNum2 = data.accountNumber || '';
        const accountType2 = getAccountTypeFromNumber(accountNum2);

        // Show tick if risk is LOW (score < 15 AND account type is not Imperial Savings variants)
        if (!(totalScore >= 15 || accountType2 === 'Imperial Savings' || accountType2 === 'Mudarabah Imperial Savings')) {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }
      // Risk High Tick: Show tick if risk is HIGH
      else if (field === 'riskHighTick') {
        let totalScore = 2; // Starting with the +2 bonus
        
        // Get score from Client's Business
        const businessEl = form.elements['clientBusiness'];
        if (businessEl && businessEl.selectedIndex > 0) {
          const businessText = businessEl.options[businessEl.selectedIndex].text;
          const businessMatch = businessText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (businessMatch) {
            const scoreStr = businessMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Client's Profession
        const professionEl = form.elements['clientProfession'];
        if (professionEl && professionEl.selectedIndex > 0) {
          const professionText = professionEl.options[professionEl.selectedIndex].text;
          const professionMatch = professionText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (professionMatch) {
            const scoreStr = professionMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Type of On-boarding Score
        const onboardingEl = form.elements['typeOfOnboardingScore'];
        if (onboardingEl && onboardingEl.selectedIndex > 0) {
          const onboardingText = onboardingEl.options[onboardingEl.selectedIndex].text;
          const onboardingMatch = onboardingText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (onboardingMatch) {
            const scoreStr = onboardingMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from PEP/IP/CEO
        const pepEl = form.elements['pepIpCeo'];
        if (pepEl && pepEl.selectedIndex > 0) {
          const pepText = pepEl.options[pepEl.selectedIndex].text;
          const pepMatch = pepText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (pepMatch) {
            const scoreStr = pepMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Close Associate of PEP/IP/CEO
        const associateEl = form.elements['closeAssociatePepIpCeo'];
        if (associateEl && associateEl.selectedIndex > 0) {
          const associateText = associateEl.options[associateEl.selectedIndex].text;
          const associateMatch = associateText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (associateMatch) {
            const scoreStr = associateMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Customer's Average Yearly Transaction
        const txnEl = form.elements['avgYearlyTransaction'];
        if (txnEl && txnEl.selectedIndex > 0) {
          const txnText = txnEl.options[txnEl.selectedIndex].text;
          const txnMatch = txnText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (txnMatch) {
            const scoreStr = txnMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // Get score from Has Client Provided Credible Source of Funds
        const sourceEl = form.elements['credibleSourceOfFunds'];
        if (sourceEl && sourceEl.selectedIndex > 0) {
          const sourceText = sourceEl.options[sourceEl.selectedIndex].text;
          const sourceMatch = sourceText.match(/Score:\s*(\d+(?:-\d+)?)/);
          if (sourceMatch) {
            const scoreStr = sourceMatch[1];
            totalScore += parseInt(scoreStr.split('-')[0], 10);
          }
        }
        
        // If account type is Current, add an extra +3 to the total score
        try {
          const acctNumForRiskHigh = data.accountNumber || '';
          const acctTypeForRiskHigh = (getAccountTypeFromNumber(acctNumForRiskHigh) || (data.accountTypeName || '')).toString().toLowerCase();
          if (acctTypeForRiskHigh.includes('current')) totalScore += 3;
        } catch (e) {}

        // Get account type from account number using getAccountTypeFromNumber function
        const accountNum3 = data.accountNumber || '';
        const accountType3 = getAccountTypeFromNumber(accountNum3);

        // Show tick if risk is HIGH (score >= 15 OR account type is Imperial Savings variants)
        if (totalScore >= 15 || accountType3 === 'Imperial Savings' || accountType3 === 'Mudarabah Imperial Savings') {
          displayValue = '✔';
        } else {
          displayValue = '';
        }
      }

      // Combined applicants overlay: show fullNameEn + secondApplicantName + thirdApplicantName
      else if (field === 'combinedApplicants') {
        const first = data.fullNameEn || '';
        const second = (form.elements['secondApplicantName'] && form.elements['secondApplicantName'].value) || '';
        const third = (form.elements['thirdApplicantName'] && form.elements['thirdApplicantName'].value) || '';

        // Show combined box for joint applicants (join with AND) or show first name when single
        const ownershipVal = form.elements['accountOwnership'] ? form.elements['accountOwnership'].value : '';
        if (ownershipVal === 'joint' && (second || third)) {
          const parts = [];
          if (first) parts.push(String(first).trim());
          if (second) parts.push(String(second).trim());
          if (third) parts.push(String(third).trim());
          displayValue = parts.join(' AND ').replace(/\s+/g, ' ').trim().toUpperCase();
          overlay.style.whiteSpace = 'nowrap';
        } else if (ownershipVal === 'single' && first) {
          displayValue = String(first).trim().replace(/\s+/g, ' ').toUpperCase();
          overlay.style.whiteSpace = 'nowrap';
        } else {
          displayValue = '';
        }
      }

      // Bangla combined applicants: translate names and join with ' এবং '
      else if (field === 'combinedApplicantsBn') {
        const first = data.fullNameEn || '';
        const second = (form.elements['secondApplicantName'] && form.elements['secondApplicantName'].value) || '';
        const third = (form.elements['thirdApplicantName'] && form.elements['thirdApplicantName'].value) || '';
        const ownershipVal = form.elements['accountOwnership'] ? form.elements['accountOwnership'].value : '';

        // Show Bangla combined box when joint (translate all present parts) or when single (translate first only)
        if (ownershipVal === 'joint' && (second || third)) {
          const parts = [];
          if (first) parts.push(first);
          if (second) parts.push(second);
          if (third) parts.push(third);
          overlay.textContent = '';
          overlay.classList.remove('overlay-empty');
          translateNamesToBn(parts).then(bn => {
            if (bn && String(bn).trim() !== '') {
              overlay.textContent = bn;
              overlay.classList.remove('overlay-empty');
            } else {
              overlay.textContent = '';
              overlay.classList.add('overlay-empty');
            }
          }).catch(err => {
            console.error('Failed to translate combined applicants to Bangla', err);
            overlay.textContent = '';
            overlay.classList.add('overlay-empty');
          });
          displayValue = '';
        } else if (ownershipVal === 'single' && first) {
          // Translate only the first name to Bangla
          overlay.textContent = '';
          overlay.classList.remove('overlay-empty');
          translateNamesToBn([first]).then(bn => {
            if (bn && String(bn).trim() !== '') {
              overlay.textContent = bn;
              overlay.classList.remove('overlay-empty');
            } else {
              overlay.textContent = '';
              overlay.classList.add('overlay-empty');
            }
          }).catch(err => {
            console.error('Failed to translate single applicant to Bangla', err);
            overlay.textContent = '';
            overlay.classList.add('overlay-empty');
          });
          displayValue = '';
        } else {
          displayValue = '';
        }
      }

      // If this overlay is a fixed digit (digit1/digit6), always render its label (digit)
      else if (overlay.dataset.field && overlay.dataset.field.startsWith('digit')) {
        const cfg = overlayConfig[overlay.dataset.page] && overlayConfig[overlay.dataset.page][overlay.dataset.index];
        displayValue = (cfg && cfg.label) ? cfg.label : '';
      }

      // Special display for today's date:
      // - page 13: use dd/mm/yyyy
      // - pages 6 and 7: use dd-mm-yyyy (existing behavior)
      else if (field === 'todayDate' && overlay.dataset.page === '13') {
        try {
          const dt = new Date();
          if (!isNaN(dt)) {
            const dd = String(dt.getDate()).padStart(2, '0');
            const mm = String(dt.getMonth() + 1).padStart(2, '0');
            const yyyy = dt.getFullYear();
            displayValue = dd + '-' + mm + '-' + yyyy;
          }
        } catch (e) {
          displayValue = value;
        }
      }
      // Page 23: use dd-mm-yyyy for today's date (special case)
      else if (field === 'todayDate' && overlay.dataset.page === '23') {
        try {
          const dt = new Date();
          if (!isNaN(dt)) {
            const dd = String(dt.getDate()).padStart(2, '0');
            const mm = String(dt.getMonth() + 1).padStart(2, '0');
            const yyyy = dt.getFullYear();
            displayValue = dd + '-' + mm + '-' + yyyy;
          }
        } catch (e) {
          displayValue = value;
        }
      }
      // Page 29: use dd-mm-yyyy for today's date (special case)
      else if (field === 'todayDate' && overlay.dataset.page === '29') {
        try {
          const dt = new Date();
          if (!isNaN(dt)) {
            const dd = String(dt.getDate()).padStart(2, '0');
            const mm = String(dt.getMonth() + 1).padStart(2, '0');
            const yyyy = dt.getFullYear();
            displayValue = dd + '-' + mm + '-' + yyyy;
          }
        } catch (e) {
          displayValue = value;
        }
      }
      // Page 35: use dd-mm-yyyy for today's date (special case)
      else if (field === 'todayDate' && overlay.dataset.page === '35') {
        try {
          const dt = new Date();
          if (!isNaN(dt)) {
            const dd = String(dt.getDate()).padStart(2, '0');
            const mm = String(dt.getMonth() + 1).padStart(2, '0');
            const yyyy = dt.getFullYear();
            displayValue = dd + '-' + mm + '-' + yyyy;
          }
        } catch (e) {
          displayValue = value;
        }
      }
      // Second Applicant Date: use dd-mm-yyyy format (today's date) - only show if secondApplicantName exists
      else if (field === 'secondApplicantDate') {
        const secondApplicantNameEl = form.elements['secondApplicantName'];
        const secondApplicantName = (secondApplicantNameEl && secondApplicantNameEl.value) ? String(secondApplicantNameEl.value).trim() : '';
        
        if (secondApplicantName) {
          try {
            const dt = new Date();
            if (!isNaN(dt)) {
              const dd = String(dt.getDate()).padStart(2, '0');
              const mm = String(dt.getMonth() + 1).padStart(2, '0');
              const yyyy = dt.getFullYear();
              displayValue = dd + '-' + mm + '-' + yyyy;
            }
          } catch (e) {
            displayValue = '';
          }
        } else {
          displayValue = '';
        }
      }
      // Third Applicant Date: use dd-mm-yyyy format (today's date) - only show if thirdApplicantName exists
      else if (field === 'thirdApplicantDate') {
        const thirdApplicantNameEl = form.elements['thirdApplicantName'];
        const thirdApplicantName = (thirdApplicantNameEl && thirdApplicantNameEl.value) ? String(thirdApplicantNameEl.value).trim() : '';
        
        if (thirdApplicantName) {
          try {
            const dt = new Date();
            if (!isNaN(dt)) {
              const dd = String(dt.getDate()).padStart(2, '0');
              const mm = String(dt.getMonth() + 1).padStart(2, '0');
              const yyyy = dt.getFullYear();
              displayValue = dd + '-' + mm + '-' + yyyy;
            }
          } catch (e) {
            displayValue = '';
          }
        } else {
          displayValue = '';
        }
      }
      else if (field === 'todayDate' && (overlay.dataset.page === '6' || overlay.dataset.page === '7')) {
        try {
          const dt = new Date();
          if (!isNaN(dt)) {
            const dd = String(dt.getDate()).padStart(2, '0');
            const mm = String(dt.getMonth() + 1).padStart(2, '0');
            const yyyy = dt.getFullYear();
            displayValue = dd + '-' + mm + '-' + yyyy;
          }
        } catch (e) {
          displayValue = value;
        }
      }

      // Special: accountTypeName - extract product code from account number and lookup type
      else if (field === 'accountTypeName') {
        const accountNum = data.accountNumber || '';
        displayValue = getAccountTypeFromNumber(accountNum);
      }

      // Special: accountNature - show 'Business' for Current accounts, otherwise 'Savings'
      else if (field === 'accountNature') {
        const accountNum = data.accountNumber || '';
        const acctType = (getAccountTypeFromNumber(accountNum) || (data.accountTypeName || '')).toString().toLowerCase();
        displayValue = acctType.includes('current') ? 'Business' : 'Savings';
      }

      // Special: nidOrBirth - prefer NID if present, otherwise use Birth Certificate Number
      else if (field === 'nidOrBirth') {
        const nidVal = data.nid && String(data.nid).trim();
        const passportVal = data.passportNo && String(data.passportNo).trim();
        const birthVal = data.birthCertNo && String(data.birthCertNo).trim();
        if (nidVal) displayValue = 'Through National ID';
        else if (passportVal) displayValue = 'Through Passport';
        else if (birthVal) displayValue = 'Through Birth Certificate';
        else displayValue = '';
      }

      // If this overlay represents a checkbox bound to the form, render a tick when checked
      // Special: for chequeBook and debitCard selects, render a tick for 'Yes'
      else if (field === 'chequeBook' || field === 'debitCard') {
        const val = (value || (boundEl && boundEl.value) || '').toString().trim().toLowerCase();
        displayValue = (val === 'yes' || val === 'y') ? '✔' : '';
      }
      else if (boundEl && boundEl.type === 'checkbox') {
        displayValue = boundEl.checked ? '✔' : '';
      } else {
        displayValue = value;

        // If nationality is empty, show 'Bangladeshi' by default on all pages with a nationality overlay
        if (field === 'nationality' && (!displayValue || String(displayValue).trim() === '')) {
          displayValue = 'Bangladeshi';
        }

        // Visual formatting for E-TIN and guardian TIN: insert four non-breaking spaces between every character
        // For pages 1,18,24,30,48 add an extra hair-space (~+0.10 NBSP) for improved visual spacing
        if ((field === 'etin' || field === 'boTin' || field === 'gTin') && value) {
          const cleanedTin = String(value).replace(/\s+/g, '');
          const page = overlay.dataset.page;
          const extraPages = ['1','18','24','30','48'];
          if (extraPages.includes(String(page))) {
            const sep = '\u00A0\u00A0\u00A0\u00A0\u200A';
            displayValue = cleanedTin.split('').join(sep);
          } else {
            displayValue = cleanedTin.split('').join('\u00A0\u00A0\u00A0\u00A0');
          }
        }

        // Special compact DOB format for Nominee: DD<NBSP>MM<NBSP>YYYY (component grouped)
        // On page 25 or 31: use digit-level spacing (4 NBSPs between each digit)
        if (field === 'nomineeDob' && value) {
          try {
            // Parse yyyy-mm-dd format directly (HTML5 date input)
            const parts = String(value).split('-');
            if (parts.length === 3) {
              const yyyy = parts[0];
              const mm = parts[1];
              const dd = parts[2];
              if (overlay.dataset.page === '25' || overlay.dataset.page === '31') {
                // Pages 25, 31: 4 NBSPs between each digit: d    d    m    m    y    y    y    y
                const digitGap = '\u00A0\u00A0\u00A0\u00A0\u00A0';
                displayValue = dd.split('').join(digitGap) + digitGap + mm.split('').join(digitGap) + digitGap + yyyy.split('').join(digitGap);
              } else {
                // Other pages: component-level grouping
                const gap = '\u00A0\u00A0\u00A0\u00A0\u00A0';
                displayValue = dd + gap + mm + gap + yyyy;
              }
            }
          } catch (e) {
            // fall back to raw value
          }
        }

        // Special compact DOB format for Introducer: DD<4NBSP>MM<4NBSP>YYYY (digits grouped)
        // On page 25 or 31: use digit-level spacing (4 NBSPs between each digit)
        if (field === 'introducerDob' && value) {
          try {
            // Parse yyyy-mm-dd format directly (HTML5 date input)
            const parts = String(value).split('-');
            if (parts.length === 3) {
              const yyyy = parts[0];
              const mm = parts[1];
              const dd = parts[2];
              if (overlay.dataset.page === '25' || overlay.dataset.page === '31') {
                // Pages 25, 31: 4 NBSPs between each digit: d    d    m    m    y    y    y    y
                const digitGap = '\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0';
                displayValue = dd.split('').join(digitGap) + digitGap + mm.split('').join(digitGap) + digitGap + yyyy.split('').join(digitGap);
              } else {
                // Other pages: component-level grouping
                const gap = '\u00A0\u00A0\u00A0\u00A0\u00A0';
                displayValue = dd + gap + mm + gap + yyyy;
              }
            }
          } catch (e) {
            // fall back to raw value
          }
        }

        // Guardian DOB: format as individual digits with NBSP gaps: d   d   m   m   y   y   y   y
        // Add one extra NBSP on guardian preview page (48)
        if (field === 'gDob' && value) {
          try {
            const parts = String(value).split('-');
            if (parts.length === 3) {
              const yyyy = parts[0];
              const mm = parts[1];
              const dd = parts[2];
              // default gap (4 NBSPs)
              let digitGap = '\u00A0\u00A0\u00A0\u00A0';
              // on guardian preview page add one extra NBSP
              if (overlay && overlay.dataset && overlay.dataset.page === '48') {
                digitGap = '\u00A0\u00A0\u00A0\u00A0\u00A0';
              }
              displayValue = dd.split('').join(digitGap) + digitGap + mm.split('').join(digitGap) + digitGap + yyyy.split('').join(digitGap);
            }
          } catch (e) {
            // fall back to raw value
          }
        }

        // Special: main DOB on page 24 or 30 should have extra spacing between digits
        // Use a wider gap (5 NBSP plus hair spaces) between each digit group and between digits
        if (field === 'dob' && value && (overlay.dataset.page === '24' || overlay.dataset.page === '30')) {
          try {
            const dt = new Date(value);
            if (!isNaN(dt)) {
              const dd = String(dt.getDate()).padStart(2, '0');
              const mm = String(dt.getMonth() + 1).padStart(2, '0');
              const yyyy = dt.getFullYear();
              // wider gap: 5 NBSPs + two hair spaces to provide incremental ".10" width steps visually
              const gap = '\u00A0\u00A0\u00A0\u00A0\u00A0\u200A\u200A\u200A\u200A';
              const parts = [dd, mm, yyyy].map(part => part.split('').join(gap));
              displayValue = parts.join(gap);
            }
          } catch (e) {
            // fall back to raw value
          }
        }

        // Beneficial Owner DOB on page 40: format as dd-mm-yyyy
        if (field === 'boDob' && value && overlay.dataset.page === '40') {
          try {
            const dt = new Date(value);
            if (!isNaN(dt)) {
              const dd = String(dt.getDate()).padStart(2, '0');
              const mm = String(dt.getMonth() + 1).padStart(2, '0');
              const yyyy = dt.getFullYear();
              displayValue = dd + '-' + mm + '-' + yyyy;
            }
          } catch (e) {
            // fall back to raw value
          }
        }

        // Visual formatting for phone numbers on pages 24 and 30: insert larger non-breaking spaces between every digit
        if ((field === 'mobile' || field === 'nomineeMobile' || field === 'guardianMobile') && (overlay.dataset.page === '24' || overlay.dataset.page === '30') && value) {
          const cleanedPhone = String(value).replace(/\s+/g, '');
          // Use two NBSPs between digits to create a wider gap and prevent line breaks
          displayValue = cleanedPhone.split('').join('\u00A0\u00A0\u00A0');
        }

        // Visual formatting for account numbers on the form
        if (field === 'accountNumber' && value) {
          // For Others page 1 (page 7), page 13, and page 15 we must show account number without added spaces
          if (overlay.dataset.page === '7' || overlay.dataset.page === '13' || overlay.dataset.page === '15') {
            displayValue = String(value).replace(/\s+/g, '');
          }
          // Pages 1-6 and 18-23: show account number with .10 NBSP spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '1' || overlay.dataset.page === '2' || overlay.dataset.page === '3' || 
                   overlay.dataset.page === '4' || overlay.dataset.page === '5' || overlay.dataset.page === '6' ||
                   overlay.dataset.page === '18' || overlay.dataset.page === '19' || overlay.dataset.page === '20' || 
                   overlay.dataset.page === '21' || overlay.dataset.page === '22' || overlay.dataset.page === '23') {
            const cleaned = String(value).replace(/\s+/g, '');
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 24: show account number with wider gaps between each character
          else if (overlay.dataset.page === '24') {
            const cleaned = String(value).replace(/\s+/g, '');
            // Page 24 contains two accountNumber overlays at different indices.
            // Use different spacing per overlay index:
            // - index 6: ~4.10 NBSPs (4 NBSPs + thin hair space)
            // - index 7: 6 NBSPs
            const idx = Number(overlay.dataset.index || -1);
            if (idx === 6) {
              displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
            } else if (idx === 7) {
              displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0');
            } else {
              // fallback to moderate spacing
              displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0');
            }
          }
          // Page 25: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '25') {
            const cleaned = String(value).replace(/\s+/g, '');
            // Page 25 contains two accountNumber overlays; use ~4.10 NBSPs (4 NBSPs + hair space) for both
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 26: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '26') {
            const cleaned = String(value).replace(/\s+/g, '');
            // Page 26 has one accountNumber overlay; use ~4.10 NBSPs (4 NBSPs + hair space)
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 27: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '27') {
            const cleaned = String(value).replace(/\s+/g, '');
            // Page 27 has one accountNumber overlay; use ~4.10 NBSPs (4 NBSPs + hair space)
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 28: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '28') {
            const cleaned = String(value).replace(/\s+/g, '');
            // Page 28 has one accountNumber overlay; use ~4.10 NBSPs (4 NBSPs + hair space)
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 29: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '29') {
            const cleaned = String(value).replace(/\s+/g, '');
            // Page 29 has one accountNumber overlay; use ~4.10 NBSPs (4 NBSPs + hair space)
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 30: show two account numbers with wider gaps (similar to page 24)
          else if (overlay.dataset.page === '30') {
            const cleaned = String(value).replace(/\s+/g, '');
            const idx = Number(overlay.dataset.index || -1);
            if (idx === 6) {
              displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
            } else if (idx === 7) {
              displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0');
            } else {
              displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0');
            }
          }
          // Page 31: show two account numbers (similar to page 25)
          else if (overlay.dataset.page === '31') {
            const cleaned = String(value).replace(/\s+/g, '');
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 32: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '32') {
            const cleaned = String(value).replace(/\s+/g, '');
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 33: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '33') {
            const cleaned = String(value).replace(/\s+/g, '');
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 34: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '34') {
            const cleaned = String(value).replace(/\s+/g, '');
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          // Page 35: show account number with extra wide spacing (~4.10 NBSPs per character)
          else if (overlay.dataset.page === '35') {
            const cleaned = String(value).replace(/\s+/g, '');
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          }
          else if (overlay.dataset.page === '40') {
            const cleaned = String(value).replace(/\s+/g, '');
            // Insert a very narrow space (~0.10 NBSP) between every character for page 40
            displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A\u200A');
          } else {
            displayValue = formatAccountNumber(value);
          }
        }

        // Visual formatting for CIF: insert non-breaking spaces between every character
        if (field === 'cif' && value) {
          const cleanedCif = String(value).replace(/\s+/g, '');
          // For Others page 1 (page 7) and page 13 show CIF without injected NBSPs
          if (overlay.dataset.page === '7' || overlay.dataset.page === '13') {
            displayValue = cleanedCif;
          } else {
            displayValue = cleanedCif.split('').join('\u00A0\u00A0\u00A0\u00A0');
          }
        }

        // Visual formatting for sectorCode: insert non-breaking spaces on page 15
        if (field === 'sectorCode' && value && overlay.dataset.page === '15') {
          const cleaned = String(value).replace(/\s+/g, '');
          displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0');
        }

        // Visual formatting for accountTypeCode: insert non-breaking spaces on page 15
        if (field === 'accountTypeCode' && value && overlay.dataset.page === '15') {
          const cleaned = String(value).replace(/\s+/g, '');
          displayValue = cleaned.split('').join('\u00A0\u00A0\u00A0\u00A0');
        }

        // Guardian-specific: increase spacing slightly (~+0.10 NBSP equivalent)
        // Apply to account number, DOB, CIF and E-TIN, but only on guardian preview page (48)
        if (overlay.dataset.page === '48' && value && (field === 'accountNumber' || field === 'cif' || field === 'etin' || field === 'dob')) {
          const guardianGap = '\u00A0\u00A0\u00A0\u00A0\u200A\u200A';
          // Account number / cif / etin: remove spaces then insert guardianGap between characters
          if (field === 'accountNumber' || field === 'cif' || field === 'etin') {
            displayValue = String(value).replace(/\s+/g, '').split('').join(guardianGap);
          } else if (field === 'dob') {
            // DOB: try to handle yyyy-mm-dd or Date object; render as dd MM yyyy with guardianGap between digits
            try {
              let dd = '', mm = '', yyyy = '';
              if (String(value).includes('-')) {
                const parts = String(value).split('-');
                if (parts.length === 3) {
                  yyyy = parts[0]; mm = parts[1]; dd = parts[2];
                }
              }
              if (!dd) {
                const dt = new Date(value);
                if (!isNaN(dt)) {
                  dd = String(dt.getDate()).padStart(2, '0');
                  mm = String(dt.getMonth() + 1).padStart(2, '0');
                  yyyy = String(dt.getFullYear());
                }
              }
              if (dd) {
                displayValue = dd.split('').join(guardianGap) + guardianGap + mm.split('').join(guardianGap) + guardianGap + yyyy.split('').join(guardianGap);
              }
            } catch (e) {
              // fall back to raw value
            }
          }
        }

        // Visual formatting for Post Codes: insert non-breaking spaces between every digit
        // On page 40: use same spacing as account number (~4.10 NBSPs)
        if ((field === 'presentPostCode' || field === 'permanentPostCode' || field === 'boPresentPostCode' || field === 'boPermanentPostCode' || field === 'gPresentPostCode' || field === 'gPermanentPostCode') && value) {
          const cleanedPc = String(value).replace(/\s+/g, '');
          if (overlay.dataset.page === '40') {
            // Page 40: insert 4 NBSPs + hair space between each digit (same as account number)
            displayValue = cleanedPc.split('').join('\u00A0\u00A0\u00A0\u00A0\u200A');
          } else {
            // Other pages: 3 NBSPs between each digit
            displayValue = cleanedPc.split('').join('\u00A0\u00A0\u00A0');
          }
        }
      }

      if (displayValue && String(displayValue).trim() !== '') {
        overlay.textContent = displayValue;
        overlay.classList.remove('overlay-empty');
      } else {
        // Special handling for seal overlays
        if (field === 'officer1Seal' || field === 'officer2Seal' || field === 'officer3Seal') {
          // Render seal stamp using saved size
          const savedSeals = JSON.parse(localStorage.getItem('ucb_officer_seals_v1') || '{}');
          const sealKey = field.replace('Seal', ''); // officer1, officer2, or officer3
          const sealText = savedSeals[sealKey] || '';
          
          // Only show seal if there's actual text saved
          if (sealText && sealText.trim() !== '') {
            const sealSize = parseInt(savedSeals.size || 140, 10) || 140;
            // Use rectangular stamp: width = size * 1.6
            const overlayWidth = Math.round(sealSize * 1.6);
            const fontSizeRem = 0.65 * (sealSize / 140);
            overlay.style.width = overlayWidth + 'px';
            overlay.style.height = sealSize + 'px';
            overlay.style.border = 'none';
            overlay.style.borderRadius = '0';
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';
            overlay.style.textAlign = 'center';
            overlay.style.fontSize = fontSizeRem + 'rem';
            overlay.style.fontWeight = '800';
            overlay.style.color = '#000';
            overlay.style.padding = Math.max(8, Math.round(sealSize * 0.06)) + 'px';
            overlay.style.wordBreak = 'break-word';
            overlay.style.background = 'rgba(0, 0, 0, 0.02)';
            overlay.style.lineHeight = '1.2';
            overlay.style.overflow = 'visible';
            overlay.style.boxShadow = 'none';
            overlay.style.whiteSpace = 'pre-wrap';
            overlay.textContent = sealText;
            overlay.classList.remove('overlay-empty');
          } else {
            overlay.textContent = '';
            overlay.classList.add('overlay-empty');
          }
        } else {
          const config = overlayConfig[overlay.dataset.page]?.[overlay.dataset.index];
          // If overlay is configured to always show, render its label and keep it visible
          if (config && config.alwaysShow) {
            overlay.textContent = config.label || field;
            overlay.classList.remove('overlay-empty');
          } else {
            overlay.textContent = config?.label || field;
            overlay.classList.add('overlay-empty');
          }
        }
      }
    });

    // Save form data
    saveFormData(data);
  }

  // Save form data to localStorage
  function saveFormData(data) {
    try {
      localStorage.setItem(FORM_KEY, JSON.stringify(data));
    } catch (e) {
      console.error('Failed to save form data', e);
    }
  }

  // Load form data from localStorage
  function loadFormData() {
    try {
      const data = JSON.parse(localStorage.getItem(FORM_KEY) || '{}');
      Object.keys(data).forEach(key => {
        const el = form.elements[key];
        if (!el) return;
        
        if (el.type === 'checkbox') {
          el.checked = data[key] === 'Yes' || data[key] === true;
        } else {
          el.value = data[key] || '';
        }
      });
    } catch (e) {
      console.error('Failed to load form data', e);
    }
  }

  // Save overlay positions
  function savePositions() {
    const positions = {};
    document.querySelectorAll('.overlay').forEach(overlay => {
      const key = `${overlay.dataset.page}_${overlay.dataset.field}_${overlay.dataset.index}`;
      positions[key] = {
        top: overlay.style.top,
        left: overlay.style.left
      };
    });
    
    try {
      localStorage.setItem(POSITIONS_KEY, JSON.stringify(positions));
      showToast('Positions saved!');
    } catch (e) {
      console.error('Failed to save positions', e);
    }
  }

  // Load overlay positions
  function loadPositions() {
    try {
      return JSON.parse(localStorage.getItem(POSITIONS_KEY) || '{}');
    } catch (e) {
      return {};
    }
  }

  // Presets management
  function savePreset() {
    const name = prompt('Enter a name for this preset:');
    if (!name) return;
    
    const formData = new FormData(form);
    const data = {};
    for (let [key, value] of formData.entries()) {
      data[key] = value;
    }
    
    // Include checkboxes
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
      if (cb.name) data[cb.name] = cb.checked;
    });
    
    const presets = loadPresets();
    presets.push({
      id: Date.now(),
      name: name,
      date: new Date().toLocaleDateString(),
      data: data
    });
    
    try {
      localStorage.setItem(PRESETS_KEY, JSON.stringify(presets));
      showToast('Preset saved: ' + name);
      renderPresets();
    } catch (e) {
      console.error('Failed to save preset', e);
    }
  }

  // Export current form data and positions to a JSON file
  function exportData() {
    try {
      const formData = new FormData(form);
      const data = {};
      for (let [key, value] of formData.entries()) data[key] = value;
      // include checkboxes explicitly
      document.querySelectorAll('input[type="checkbox"]').forEach(cb => { if (cb.name) data[cb.name] = cb.checked; });

      const positions = loadPositions();

      const payload = {
        exportedAt: new Date().toISOString(),
        form: data,
        positions: positions
      };

      const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
      const ts = new Date().toISOString().replace(/[:.]/g, '-');
      const filename = `ucb_form_export_${ts}.json`;

      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      showToast('Data exported: ' + filename);
    } catch (e) {
      console.error('Export failed', e);
      showToast('Export failed');
    }
  }

  // Import form data and positions from a JSON file (File object)
  function importDataFromFile(file) {
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const obj = JSON.parse(e.target.result);
        const imported = obj && obj.form ? obj.form : obj;

        // Apply form values
        Object.keys(imported).forEach(key => {
          const el = form.elements[key];
          if (!el) return;
          if (el.type === 'checkbox') {
            el.checked = !!imported[key];
          } else {
            el.value = imported[key] == null ? '' : imported[key];
          }
        });

        // If positions present, store them
        if (obj && obj.positions) {
          try { localStorage.setItem(POSITIONS_KEY, JSON.stringify(obj.positions)); } catch (e) {}
        }

        // Persist form data and update overlays
        const formDataObj = {};
        Array.from(new FormData(form).entries()).forEach(([k,v]) => formDataObj[k]=v);
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => { if (cb.name) formDataObj[cb.name] = cb.checked; });
        saveFormData(formDataObj);

        // Apply loaded positions to overlays
        const saved = loadPositions();
        if (saved && Object.keys(saved).length) {
          document.querySelectorAll('.overlay').forEach(overlay => {
            const key = `${overlay.dataset.page}_${overlay.dataset.field}_${overlay.dataset.index}`;
            if (saved[key]) {
              overlay.style.top = saved[key].top;
              overlay.style.left = saved[key].left;
            }
          });
        }

        updateOverlays();
        showToast('Data imported successfully');
      } catch (err) {
        console.error('Import error', err);
        showToast('Import failed: invalid file');
      }
    };
    reader.readAsText(file);
  }

  function loadPresets() {
    try {
      return JSON.parse(localStorage.getItem(PRESETS_KEY) || '[]');
    } catch (e) {
      return [];
    }
  }

  function loadPreset(id) {
    const presets = loadPresets();
    const preset = presets.find(p => p.id === id);
    if (!preset) return;
    
    Object.keys(preset.data).forEach(key => {
      const el = form.elements[key];
      if (!el) return;
      
      if (el.type === 'checkbox') {
        el.checked = preset.data[key];
      } else {
        el.value = preset.data[key] || '';
      }
    });
    
    updateOverlays();
    showToast('Preset loaded: ' + preset.name);
    closePresetsPanel();
  }

  function deletePreset(id) {
    if (!confirm('Delete this preset?')) return;
    
    let presets = loadPresets();
    presets = presets.filter(p => p.id !== id);
    
    try {
      localStorage.setItem(PRESETS_KEY, JSON.stringify(presets));
      showToast('Preset deleted');
      renderPresets();
    } catch (e) {
      console.error('Failed to delete preset', e);
    }
  }

  function renderPresets() {
    const presets = loadPresets();
    
    if (presets.length === 0) {
      presetsList.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;"><i class="fas fa-folder-open" style="font-size: 3rem; margin-bottom: 16px; display: block;"></i>No saved presets yet</div>';
      return;
    }
    
    presetsList.innerHTML = presets.map(preset => `
      <div class="preset-item">
        <h4><i class="fas fa-user"></i> ${preset.name}</h4>
        <p><i class="fas fa-calendar"></i> Saved: ${preset.date}</p>
        <div class="preset-actions">
          <button class="preset-btn load" onclick="window.loadPreset(${preset.id})"><i class="fas fa-upload"></i> Load</button>
          <button class="preset-btn delete" onclick="window.deletePreset(${preset.id})"><i class="fas fa-trash"></i> Delete</button>
        </div>
      </div>
    `).join('');
  }

  // Expose functions globally
  window.loadPreset = loadPreset;
  window.deletePreset = deletePreset;

  function openPresetsPanel() {
    renderPresets();
    presetsPanel.classList.add('open');
    panelBackdrop.classList.add('show');
  }

  function closePresetsPanel() {
    presetsPanel.classList.remove('open');
    panelBackdrop.classList.remove('show');
  }

  // Toast notification
  function showToast(message) {
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
  }

  // Page switching
  function switchPage(pageId) {
    navBtns.forEach(btn => btn.classList.remove('active'));
    pageContainers.forEach(container => container.classList.remove('active'));

    const currentBtn = document.querySelector(`.nav-btn[data-page="${pageId}"]`);
    if (currentBtn) currentBtn.classList.add('active');
    document.getElementById(`${pageId}-page`).classList.add('active');

    // Show only the button that switches to the other page
    navBtns.forEach(btn => {
      if (btn.dataset.page === pageId) {
        btn.style.display = 'none';
      } else {
        btn.style.display = '';
      }
    });

    if (pageId === 'form') {
      updateOverlays();
    }
  }

  // Form page switching - all pages are shown by default
  function switchFormPage(pageNum) {
    formPages.forEach(page => page.classList.add('active'));
  }

  // Handle form type (Conventional / Conventional Imperial / Taqwa / Others) switching
  function handleFormTypeChange() {
    const formType = formTypeSelect ? formTypeSelect.value : 'conventional';
    const conventionalPages = document.querySelectorAll('.form-page:not(.others-page):not(.imperial-page):not(.taqwa-page):not(.taqwa-imperial-page):not(.beneficial-owner-page)');
    const imperialPages = document.querySelectorAll('.form-page.imperial-page');
    const taqwaPages = document.querySelectorAll('.form-page.taqwa-page');
    const taqwaImperialPages = document.querySelectorAll('.form-page.taqwa-imperial-page');
    const othersPages = document.querySelectorAll('.form-page.others-page');
    const boPages = document.querySelectorAll('.form-page.beneficial-owner-page');
    const guardianPages = document.querySelectorAll('.form-page.guardian-page');

    // Hide all first
    conventionalPages.forEach(page => { page.style.display = 'none'; page.classList.remove('active'); });
    imperialPages.forEach(page => { page.style.display = 'none'; page.classList.remove('active'); });
    taqwaPages.forEach(page => { page.style.display = 'none'; page.classList.remove('active'); });
    taqwaImperialPages.forEach(page => { page.style.display = 'none'; page.classList.remove('active'); });
    othersPages.forEach(page => { page.style.display = 'none'; page.classList.remove('active'); });
    boPages.forEach(page => { page.style.display = 'none'; page.classList.remove('active'); });

    // Show based on form type (explicitly set display: block instead of empty string)
    if (formType === 'conventional') {
      conventionalPages.forEach(page => { page.style.display = 'block'; page.classList.add('active'); });
    } else if (formType === 'conventional-imperial') {
      imperialPages.forEach(page => { page.style.display = 'block'; page.classList.add('active'); });
    } else if (formType === 'taqwa') {
      taqwaPages.forEach(page => { page.style.display = 'block'; page.classList.add('active'); });
    } else if (formType === 'taqwa-imperial') {
      taqwaImperialPages.forEach(page => { page.style.display = 'block'; page.classList.add('active'); });
    } else if (formType === 'beneficial-owner') {
      boPages.forEach(page => { page.style.display = 'block'; page.classList.add('active'); });
    } else if (formType === 'guardian') {
      guardianPages.forEach(page => { page.style.display = 'block'; page.classList.add('active'); });
    } else {
      othersPages.forEach(page => { page.style.display = 'block'; page.classList.add('active'); });
    }
  }

  // Edit mode for dragging overlays
  function enableEditMode(enabled) {
    document.querySelectorAll('.overlay').forEach(overlay => {
      if (enabled) {
        overlay.classList.add('editing');
        makeDraggable(overlay);
      } else {
        overlay.classList.remove('editing');
      }
    });
  }

  function makeDraggable(element) {
    let isDragging = false;
    let startX, startY, startLeft, startTop;
    
    element.onmousedown = function(e) {
      if (!editModeCheckbox.checked) return;
      
      isDragging = true;
      startX = e.clientX;
      startY = e.clientY;
      startLeft = parseFloat(element.style.left) || 0;
      startTop = parseFloat(element.style.top) || 0;
      
      document.onmousemove = function(e) {
        if (!isDragging) return;
        
        const parent = element.parentElement;
        const parentRect = parent.getBoundingClientRect();
        
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        
        const newLeft = startLeft + (deltaX / parentRect.width * 100);
        const newTop = startTop + (deltaY / parentRect.height * 100);
        
        element.style.left = newLeft + '%';
        element.style.top = newTop + '%';
      };
      
      document.onmouseup = function() {
        isDragging = false;
        document.onmousemove = null;
        document.onmouseup = null;
      };
    };
  }

  // Clear form
  function clearForm() {
    if (!confirm('Clear all form data?')) return;
    
    form.reset();
    try {
      localStorage.removeItem(FORM_KEY);
    } catch (e) {}
    
    updateOverlays();
    showToast('Form cleared');
  }

  // Print functions
  function printCurrentPage() {
    // Hide info page, show form page, then print selected form type
    const infoPage = document.getElementById('info-page');
    const formPage = document.getElementById('form-page');
    const wasInfoVisible = infoPage.classList.contains('active');
    const wasFormVisible = formPage.classList.contains('active');
    
    // Auto-detect form type based on account type
    const accountNumberEl = form.elements['accountNumber'];
    const accountNumber = accountNumberEl ? accountNumberEl.value : '';
    const accountTypeName = getAccountTypeFromNumber(accountNumber).toLowerCase();
    
    console.log('Print Auto-detect: accountNumber=' + accountNumber + ', accountTypeName=' + accountTypeName);
    
    let selectedPrintType = 'conventional'; // default
    
    if (accountTypeName.includes('mudarabah') && accountTypeName.includes('imperial') && accountTypeName.includes('savings')) {
      // Mudarabah Imperial Savings -> Taqwa Imperial
      selectedPrintType = 'taqwa-imperial';
    } else if (accountTypeName.includes('mudarabah') && accountTypeName.includes('savings')) {
      // Mudarabah Savings -> Taqwa
      selectedPrintType = 'taqwa';
    } else if (accountTypeName.includes('imperial') && accountTypeName.includes('savings')) {
      // Imperial Savings -> Conventional Imperial
      selectedPrintType = 'conventional-imperial';
    } else {
      // All other account types default to Conventional
      selectedPrintType = 'conventional';
    }
    
    // Update dropdown to show auto-selected type
    const printFormTypeSelect = document.getElementById('printFormTypeSelect');
    if (printFormTypeSelect) {
      printFormTypeSelect.value = selectedPrintType;
    }
    
    // Save current form type
    const currentFormType = formTypeSelect ? formTypeSelect.value : 'conventional';
    
    // Switch to selected print form type
    if (formTypeSelect) {
      formTypeSelect.value = selectedPrintType;
      handleFormTypeChange();
    }

    // If Beneficial Owner(s) is Yes, also show Beneficial Owner form pages
    const boSelect = form.elements['beneficialOwners'];
    const boVal = boSelect ? String(boSelect.value || '').toLowerCase() : '';
    const boPages = document.querySelectorAll('.form-page.beneficial-owner-page');
    const boOriginalDisplay = [];
    if (boPages && boPages.length) {
      boPages.forEach((p, idx) => {
        boOriginalDisplay[idx] = p.style.display;
        if (boVal === 'yes') {
          p.style.display = 'block';
          p.classList.add('active');
        }
      });
    }

    // If account holder age is below 18, show Guardian page; otherwise hide it
    const dobEl = form.elements['dob'];
    const dobVal = dobEl ? dobEl.value : '';
    let accountHolderAgeBelowEighteen = false;
    const guardianPages = document.querySelectorAll('.form-page.guardian-page');
    const guardianOriginalDisplay = [];
    if (dobVal) {
      try {
        const dobDate = new Date(dobVal);
        const today = new Date();
        const age = today.getFullYear() - dobDate.getFullYear();
        const monthDiff = today.getMonth() - dobDate.getMonth();
        const dayDiff = today.getDate() - dobDate.getDate();
        const actualAge = monthDiff < 0 || (monthDiff === 0 && dayDiff < 0) ? age - 1 : age;
        if (actualAge < 18) {
          accountHolderAgeBelowEighteen = true;
        }
      } catch (e) {}
    }
    // Save original display state and apply print-time visibility
    if (guardianPages && guardianPages.length) {
      guardianPages.forEach((p, idx) => {
        guardianOriginalDisplay[idx] = p.style.display;
        if (accountHolderAgeBelowEighteen) {
          // Age < 18: show guardian page
          p.style.display = 'block';
          p.classList.add('active');
        } else {
          // Age >= 18: hide guardian page during print
          p.style.display = 'none';
          p.classList.remove('active');
        }
      });
    }
    
    infoPage.classList.remove('active');
    formPage.classList.add('active');
    
    setTimeout(() => {
      window.print();
      
      // Restore form type
      if (formTypeSelect) {
        formTypeSelect.value = currentFormType;
        handleFormTypeChange();
      }

      // Restore Beneficial Owner pages to their original display state
      if (boPages && boPages.length) {
        boPages.forEach((p, idx) => {
          if (typeof boOriginalDisplay[idx] !== 'undefined') {
            p.style.display = boOriginalDisplay[idx];
          }
        });
      }

      // Restore Guardian pages to their original display state
      if (guardianPages && guardianPages.length) {
        guardianPages.forEach((p, idx) => {
          if (typeof guardianOriginalDisplay[idx] !== 'undefined') {
            p.style.display = guardianOriginalDisplay[idx];
          }
        });
      }
      
      // Restore visibility
      if (wasInfoVisible) infoPage.classList.add('active');
      if (!wasFormVisible) formPage.classList.remove('active');
    }, 100);
  }

  function printAllPages() {
    // All pages are visible by default; simply print the document
    window.print();
  }

  // Print Others pages only
  function printOthersPages() {
    const infoPage = document.getElementById('info-page');
    const formPage = document.getElementById('form-page');
    const othersBackdropEl = document.getElementById('othersBackdrop');
    const wasInfoVisible = infoPage.classList.contains('active');
    const wasFormVisible = formPage.classList.contains('active');
    const wasPopupOpen = othersBackdropEl && othersBackdropEl.classList.contains('open');
    
    // Save current form type
    const currentFormType = formTypeSelect ? formTypeSelect.value : 'conventional';
    
    // Close the Others popup so it doesn't interfere with printing
    if (othersBackdropEl && wasPopupOpen) {
      othersBackdropEl.classList.remove('open');
    }
    
    // Switch to Others form type
    if (formTypeSelect) {
      formTypeSelect.value = 'others';
      handleFormTypeChange();
    }
    
    // Show form page for printing
    infoPage.classList.remove('active');
    formPage.classList.add('active');
    
    // Force DOM reflow and wait for render with requestAnimationFrame
    requestAnimationFrame(() => {
      // Force layout reflow to ensure rendering
      document.body.offsetHeight;
      
      // Wait a bit more then compute totals and print
      setTimeout(() => {
        try {
          if (typeof calculateTransactionTotals === 'function') calculateTransactionTotals();
          if (typeof computeOverallTotals === 'function') computeOverallTotals();
          if (typeof updateOverlays === 'function') updateOverlays();
        } catch (e) {}
        window.print();
        
        // Restore after print dialog closes
        setTimeout(() => {
          try {
            if (typeof calculateTransactionTotals === 'function') calculateTransactionTotals();
            if (typeof computeOverallTotals === 'function') computeOverallTotals();
            if (typeof updateOverlays === 'function') updateOverlays();
          } catch (e) {}
          if (formTypeSelect) {
            formTypeSelect.value = currentFormType;
            handleFormTypeChange();
          }
          
          // Restore visibility
          if (wasInfoVisible) infoPage.classList.add('active');
          if (!wasFormVisible) formPage.classList.remove('active');
          
          // Reopen popup if it was open before
          if (wasPopupOpen && othersBackdropEl) {
            othersBackdropEl.classList.add('open');
          }
        }, 1000);
      }, 300);
    });
  }

  // Same address functionality
  function handleSameAddress() {
    if (sameAddressCheckbox.checked) {
      form.elements['permanentHouse'].value = form.elements['presentHouse'].value;
      form.elements['permanentRoad'].value = form.elements['presentRoad'].value;
      form.elements['permanentPO'].value = form.elements['presentPO'].value;
      form.elements['permanentPostCode'].value = form.elements['presentPostCode'].value;
      form.elements['permanentThana'].value = form.elements['presentThana'].value;
      form.elements['permanentDistrict'].value = form.elements['presentDistrict'].value;
      form.elements['permanentCountry'].value = form.elements['presentCountry'].value;
    }
  }

  // Nominee: copy present address to nomineeAddress when checked
  function handleNomineeSameAddress() {
    if (!form) return;
    const nomineeAddrEl = form.elements['nomineeAddress'];
    if (!nomineeAddrEl) return;

    if (nomineeSameCheckbox && nomineeSameCheckbox.checked) {
      const ph = form.elements['presentHouse'] ? form.elements['presentHouse'].value : '';
      const pr = form.elements['presentRoad'] ? form.elements['presentRoad'].value : '';
      const ppo = form.elements['presentPO'] ? form.elements['presentPO'].value : '';
      const ppc = form.elements['presentPostCode'] ? form.elements['presentPostCode'].value : '';
      const pt = form.elements['presentThana'] ? form.elements['presentThana'].value : '';
      const pd = form.elements['presentDistrict'] ? form.elements['presentDistrict'].value : '';

      const segments = [];
      if (ph) segments.push(ph);
      if (pr) segments.push(pr);

      // Post Office - Post Code
      let poSeg = '';
      if (ppo) poSeg += ppo;
      if (ppc) poSeg += (poSeg ? ' - ' : '') + ppc;
      if (poSeg) segments.push(poSeg);

      if (pt) segments.push(pt);
      if (pd) segments.push(pd);

      const addr = segments.join(', ');
      nomineeAddrEl.value = addr;
      nomineeAddrEl.readOnly = true;
    } else {
      // allow editing when unchecked
      nomineeAddrEl.readOnly = false;
    }

    updateOverlays();
    // Ensure the overall summary totals are recomputed after sync
    setTimeout(() => { if (typeof computeOverallTotals === 'function') computeOverallTotals(); }, 50);
  }

  // Guardian: copy present address to guardianPermanentAddress when checked
  function handleGuardianSameAddress() {
    if (!form) return;
    if (guardianSameCheckbox && guardianSameCheckbox.checked) {
      // Copy individual present address fields to permanent address fields
      form.elements['gPermanentHouse'].value = form.elements['gPresentHouse'] ? form.elements['gPresentHouse'].value : '';
      form.elements['gPermanentArea'].value = form.elements['gPresentArea'] ? form.elements['gPresentArea'].value : '';
      form.elements['gPermanentPO'].value = form.elements['gPresentPO'] ? form.elements['gPresentPO'].value : '';
      form.elements['gPermanentPostCode'].value = form.elements['gPresentPostCode'] ? form.elements['gPresentPostCode'].value : '';
      form.elements['gPermanentThana'].value = form.elements['gPresentThana'] ? form.elements['gPresentThana'].value : '';
      form.elements['gPermanentDistrict'].value = form.elements['gPresentDistrict'] ? form.elements['gPresentDistrict'].value : '';
      form.elements['gPermanentCountry'].value = form.elements['gPresentCountry'] ? form.elements['gPresentCountry'].value : '';
    }

    updateOverlays();
    // Ensure the overall summary totals are recomputed after sync
    setTimeout(() => { if (typeof computeOverallTotals === 'function') computeOverallTotals(); }, 50);
  }

  // Show/hide joint applicant fields based on ownership
  function handleOwnershipChange() {
    const ownership = form.elements['accountOwnership'] ? form.elements['accountOwnership'].value : '';
    const jointEls = document.querySelectorAll('.owner-joint-only');
    jointEls.forEach(el => {
      if (ownership === 'joint') {
        el.style.display = '';
      } else {
        el.style.display = 'none';
        // clear values when hidden
        const input = el.querySelector('input');
        if (input && input.name) input.value = '';
      }
    });
  }

  // Event Listeners
  navBtns.forEach(btn => {
    btn.addEventListener('click', () => switchPage(btn.dataset.page));
  });

  // pageSelect removed: all pages are visible by default

  editModeCheckbox.addEventListener('change', () => enableEditMode(editModeCheckbox.checked));

  const savePresetBtnEl = document.getElementById('savePresetBtn');
  if (savePresetBtnEl) savePresetBtnEl.addEventListener('click', savePreset);
  const viewPresetsBtnEl = document.getElementById('viewPresetsBtn');
  if (viewPresetsBtnEl) viewPresetsBtnEl.addEventListener('click', openPresetsPanel);
  const closePresetsBtnEl = document.getElementById('closePresetsBtn');
  if (closePresetsBtnEl) closePresetsBtnEl.addEventListener('click', closePresetsPanel);
  const clearFormBtnEl = document.getElementById('clearFormBtn');
  if (clearFormBtnEl) clearFormBtnEl.addEventListener('click', clearForm);
  const printFormBtnEl = document.getElementById('printFormBtn');
  if (printFormBtnEl) printFormBtnEl.addEventListener('click', printCurrentPage);
  const printOthersBtnEl = document.getElementById('printOthersBtn');
  if (printOthersBtnEl) printOthersBtnEl.addEventListener('click', printOthersPages);
  const popupPrintOthersBtnEl = document.getElementById('popupPrintOthersBtn');
  if (popupPrintOthersBtnEl) popupPrintOthersBtnEl.addEventListener('click', printOthersPages);
  const savePositionsBtnEl = document.getElementById('savePositionsBtn');
  if (savePositionsBtnEl) savePositionsBtnEl.addEventListener('click', savePositions);

  // Slide menu action buttons
  document.getElementById('slideMenuSavePreset').addEventListener('click', (e) => { e.preventDefault(); savePreset(); closeSlideMenu(); });
  document.getElementById('slideMenuPresets').addEventListener('click', (e) => { e.preventDefault(); openPresetsPanel(); closeSlideMenu(); });
  document.getElementById('slideMenuExport').addEventListener('click', (e) => { e.preventDefault(); exportData(); closeSlideMenu(); });

  panelBackdrop.addEventListener('click', closePresetsPanel);
  sameAddressCheckbox.addEventListener('change', handleSameAddress);
  if (nomineeSameCheckbox) nomineeSameCheckbox.addEventListener('change', handleNomineeSameAddress);
  if (guardianSameCheckbox) guardianSameCheckbox.addEventListener('change', handleGuardianSameAddress);
  if (boSameAddressCheckbox) boSameAddressCheckbox.addEventListener('change', handleBoSameAddress);
  if (beneficialOwnersSelect) {
    beneficialOwnersSelect.addEventListener('change', handleBeneficialOwnerToggle);
    handleBeneficialOwnerToggle();
  }

  // Form type (Conventional / Others) change
  if (formTypeSelect) formTypeSelect.addEventListener('change', handleFormTypeChange);

  // Ownership change: show/hide joint applicant fields
  const ownershipSelect = form.elements['accountOwnership'];
  if (ownershipSelect) {
    ownershipSelect.addEventListener('change', () => {
      handleOwnershipChange();
      updateOverlays();
    });
  }

  // Sync branch name between slide menu quick input and main form
  const branchInputMain = form.elements['branchName'];
  if (slideBranchInput && branchInputMain) {
    // initialize slide & main input value from saved data (BRANCH_KEY) or form value
    try {
      const savedBranch = localStorage.getItem(BRANCH_KEY);
      if (branchInputMain.value && String(branchInputMain.value).trim() !== '') {
        slideBranchInput.value = branchInputMain.value;
      } else if (savedBranch) {
        branchInputMain.value = savedBranch;
        slideBranchInput.value = savedBranch;
      } else {
        slideBranchInput.value = '';
      }
    } catch (e) {
      slideBranchInput.value = branchInputMain.value || '';
    }

    // when slide input changes, update main field, overlays and persist branch
    slideBranchInput.addEventListener('input', (e) => {
      const v = e.target.value || '';
      branchInputMain.value = v;
      try { localStorage.setItem(BRANCH_KEY, v); } catch (err) {}
      updateOverlays();
    });

    // when main field changes, keep slide input in sync and persist
    branchInputMain.addEventListener('input', (e) => {
      const v = e.target.value || '';
      slideBranchInput.value = v;
      try { localStorage.setItem(BRANCH_KEY, v); } catch (err) {}
    });
  }

  // Import/Export file input and buttons
  const importFileInputEl = document.getElementById('importFileInput');
  const exportDataBtnEl = document.getElementById('exportDataBtn');
  if (exportDataBtnEl) exportDataBtnEl.addEventListener('click', exportData);
  const importDataBtnEl = document.getElementById('importDataBtn');
  if (importDataBtnEl) importDataBtnEl.addEventListener('click', () => importFileInputEl.click());
  document.getElementById('slideMenuImport').addEventListener('click', (e) => { e.preventDefault(); importFileInputEl.click(); closeSlideMenu(); });
  importFileInputEl.addEventListener('change', (ev) => {
    const file = ev.target.files && ev.target.files[0];
    if (file) importDataFromFile(file);
    importFileInputEl.value = '';
  });

  // Form input listeners
  // --- Auto-translate Full Name (English) -> Full Name (Bangla) ---
  function debounce(fn, wait){ let t; return function(...args){ clearTimeout(t); t = setTimeout(()=> fn.apply(this, args), wait); }; }

  async function translateText(text) {
    if (!text || text.trim() === '') return '';
    try {
      const apiUrl = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=bn&dt=t&q=${encodeURIComponent(text)}`;
      const response = await fetch(apiUrl);
      const data = await response.json();
      
      // Parse response: first element contains translations
      if (data && data[0] && Array.isArray(data[0])) {
        const translated = data[0].map(item => item[0]).join('');
        console.log('Translated:', text, '=>', translated);
        return translated;
      }
      console.warn('Unexpected translation response format:', data);
      return '';
    } catch (e) {
      console.error('Translation fetch error:', e);
      return '';
    }
  }

  const translateDebounced = debounce(async (text) => {
    if (!text || text.trim() === '') {
      if (form.elements['fullNameBn']) {
        form.elements['fullNameBn'].value = '';
        updateOverlays();
      }
      return;
    }
    const translated = await translateText(text);
    if (translated && form.elements['fullNameBn']) {
      form.elements['fullNameBn'].value = translated;
      updateOverlays();
      console.log('Updated fullNameBn field with:', translated);
    }
  }, 700);

  // Hook into the English name input for auto-translation
  const fullNameEnField = form.elements['fullNameEn'];
  if (fullNameEnField) {
    fullNameEnField.addEventListener('input', (e) => {
      const englishText = e.target.value;
      console.log('English name entered:', englishText);
      translateDebounced(englishText);
    });
  }

  // Beneficial Owner: auto-translate BO English name to Bangla (mirror Full Name behavior)
  const boTranslateDebounced = debounce(async (text) => {
    if (!text || text.trim() === '') {
      if (form.elements['boNameBn']) {
        form.elements['boNameBn'].value = '';
        updateOverlays();
      }
      return;
    }
    const translated = await translateText(text);
    if (translated && form.elements['boNameBn']) {
      form.elements['boNameBn'].value = translated;
      updateOverlays();
      console.log('Updated boNameBn field with:', translated);
    }
  }, 700);

  const boNameEnField = form.elements['boNameEn'];
  if (boNameEnField) {
    boNameEnField.addEventListener('input', (e) => {
      const englishText = e.target.value;
      boTranslateDebounced(englishText);
    });
  }

  // Guardian: auto-translate Guardian English name to Bangla (mirror Full Name behavior)
  const gTranslateDebounced = debounce(async (text) => {
    if (!text || text.trim() === '') {
      if (form.elements['gNameBn']) {
        form.elements['gNameBn'].value = '';
        updateOverlays();
      }
      return;
    }
    const translated = await translateText(text);
    if (translated && form.elements['gNameBn']) {
      form.elements['gNameBn'].value = translated;
      updateOverlays();
      console.log('Updated gNameBn field with:', translated);
    }
  }, 700);

  const gNameEnField = form.elements['gNameEn'];
  if (gNameEnField) {
    gNameEnField.addEventListener('input', (e) => {
      const englishText = e.target.value;
      gTranslateDebounced(englishText);
    });
  }

  Array.from(form.elements).forEach(el => {
    if (el.tagName === 'BUTTON') return;
    el.addEventListener('input', updateOverlays);
    el.addEventListener('change', updateOverlays);
  });

  // If Client's Business dropdown changes, reset Client's Profession dropdown
  const clientBusinessSelect = form.elements['clientBusiness'];
  if (clientBusinessSelect) {
    clientBusinessSelect.addEventListener('change', () => {
      const clientProfessionSelect = form.elements['clientProfession'];
      if (clientProfessionSelect) {
        clientProfessionSelect.selectedIndex = 0;
        updateOverlays();
      }
    });
  }

  // If Client's Profession dropdown changes, reset Client's Business dropdown
  const clientProfessionSelect = form.elements['clientProfession'];
  if (clientProfessionSelect) {
    clientProfessionSelect.addEventListener('change', () => {
      const clientBusinessSelect = form.elements['clientBusiness'];
      if (clientBusinessSelect) {
        clientBusinessSelect.selectedIndex = 0;
        updateOverlays();
      }
    });
  }

  // Calculate individual transaction totals: total = amount × 2 (per requirement)
  function calculateTransactionTotals() {
    const parse = (v) => {
      if (v === undefined || v === null) return 0;
      const s = String(v).trim();
      if (s === '') return 0;
      const n = parseFloat(s.replace(/[^0-9.-]+/g, ''));
      return isNaN(n) ? 0 : n;
    };

    const transactionTypes = [
      { amount: 'depositCashAmount', total: 'depositCashTotal' },
      { amount: 'depositTransferAmount', total: 'depositTransferTotal' },
      { amount: 'depositRemittanceAmount', total: 'depositRemittanceTotal' },
      { amount: 'withdrawalCashAmount', total: 'withdrawalCashTotal' },
      { amount: 'withdrawalTransferAmount', total: 'withdrawalTransferTotal' },
      { amount: 'withdrawalRemittanceAmount', total: 'withdrawalRemittanceTotal' },
    ];

    transactionTypes.forEach(({ amount, total }) => {
      const amountEl = form.elements[amount];
      const totalEl = form.elements[total];

      if (amountEl && totalEl) {
        const raw = (amountEl.value || '').toString().trim();
        // If the amount field is blank, leave total blank (do not show 0)
        if (raw === '') {
          totalEl.value = '';
        } else {
          const amountVal = parse(raw);
          const calcTotal = amountVal * 2;
          const formatted = Number.isInteger(calcTotal) ? String(calcTotal) : calcTotal.toFixed(2);
          totalEl.value = formatted;
        }
      }
    });

    // After calculating individual totals, compute overall deposit/withdrawal totals
    computeOverallTotals();
  }

  // Sync Transection Profile text into the TP table amount fields
  const transectionProfileField = form.elements['transectionProfile'];
  function syncTransectionProfile() {
    if (!transectionProfileField) return;
    const raw = (transectionProfileField.value || '').toString().trim();
    // Copy raw text into the Monthly Probable Maximum Single Amount fields
    const amountNames = ['depositCashAmount', 'depositTransferAmount', 'withdrawalCashAmount', 'withdrawalTransferAmount'];
    amountNames.forEach(n => {
      const el = form.elements[n];
      if (el) el.value = raw;
    });

    // Parse numeric value from raw and multiply by 2 for Total Probable Amount fields
    // Accept formats like "1000", "1,000", "1,000.50", "1000.50"
    const numeric = parseFloat(raw.replace(/[^0-9.-]+/g, ''));
    const totalNames = ['depositCashTotal', 'depositTransferTotal', 'withdrawalCashTotal', 'withdrawalTransferTotal'];
    if (!isNaN(numeric)) {
      const doubled = numeric * 2;
      // Keep integer if input was integer, otherwise show two decimals
      const formatted = Number.isInteger(doubled) ? String(doubled) : doubled.toFixed(2);
      totalNames.forEach(n => {
        const el = form.elements[n];
        if (el) el.value = formatted;
      });
    } else {
      // If not numeric, clear totals
      totalNames.forEach(n => {
        const el = form.elements[n];
        if (el) el.value = '';
      });
    }

    updateOverlays();
    // Trigger computation of summary totals after a short delay
    setTimeout(() => {
      console.log('Calling computeOverallTotals from syncTransectionProfile');
      if (typeof computeOverallTotals === 'function') {
        computeOverallTotals();
      }
    }, 100);
  }
  if (transectionProfileField) {
    transectionProfileField.addEventListener('input', syncTransectionProfile);
    transectionProfileField.addEventListener('change', syncTransectionProfile);
    // propagate on load
    syncTransectionProfile();
  }

  // Compute and populate the Total Probable Deposit/Withdrawal summary fields
  function computeOverallTotals() {
    const parse = (v) => {
      if (v === undefined || v === null) return 0;
      const s = String(v).trim();
      if (s === '') return 0;
      const n = parseFloat(s.replace(/[^0-9.-]+/g, ''));
      return isNaN(n) ? 0 : n;
    };

    const dCashEl = form.elements['depositCashTotal'];
    const dTransEl = form.elements['depositTransferTotal'];
    const dRemEl  = form.elements['depositRemittanceTotal'];
    const wCashEl = form.elements['withdrawalCashTotal'];
    const wTransEl = form.elements['withdrawalTransferTotal'];
    const wRemEl  = form.elements['withdrawalRemittanceTotal'];
    // For combined Max Single Amount, read amount fields
    const dCashAmtEl = form.elements['depositCashAmount'];
    const dTransAmtEl = form.elements['depositTransferAmount'];
    const dRemAmtEl  = form.elements['depositRemittanceAmount'];
    const wCashAmtEl = form.elements['withdrawalCashAmount'];
    const wTransAmtEl = form.elements['withdrawalTransferAmount'];
    const wRemAmtEl  = form.elements['withdrawalRemittanceAmount'];

    const depositCashTotal = parse(dCashEl ? dCashEl.value : '');
    const depositTransferTotal = parse(dTransEl ? dTransEl.value : '');
    const depositRemittanceTotal = parse(dRemEl ? dRemEl.value : '');
    const withdrawalCashTotal = parse(wCashEl ? wCashEl.value : '');
    const withdrawalTransferTotal = parse(wTransEl ? wTransEl.value : '');
    const withdrawalRemittanceTotal = parse(wRemEl ? wRemEl.value : '');

    const depositSum = depositCashTotal + depositTransferTotal + depositRemittanceTotal;
    const withdrawalSum = withdrawalCashTotal + withdrawalTransferTotal + withdrawalRemittanceTotal;
    const depositAmtCombined = parse(dCashAmtEl ? dCashAmtEl.value : '') + parse(dTransAmtEl ? dTransAmtEl.value : '') + parse(dRemAmtEl ? dRemAmtEl.value : '');
    const withdrawalAmtCombined = parse(wCashAmtEl ? wCashAmtEl.value : '') + parse(wTransAmtEl ? wTransAmtEl.value : '') + parse(wRemAmtEl ? wRemAmtEl.value : '');

    console.log('computeOverallTotals called: depCash=' + depositCashTotal + ', depTrans=' + depositTransferTotal + ', depSum=' + depositSum);
    console.log('computeOverallTotals called: withCash=' + withdrawalCashTotal + ', withTrans=' + withdrawalTransferTotal + ', withSum=' + withdrawalSum);

    const depositField = form.elements['depositTotalProbable'];
    const withdrawalField = form.elements['withdrawalTotalProbable'];
    const depositAmtCombinedField = form.elements['depositMaxSingleCombined'];
    const withdrawalAmtCombinedField = form.elements['withdrawalMaxSingleCombined'];
    
    if (depositField) {
      const val = Number.isInteger(depositSum) ? String(depositSum) : depositSum.toFixed(2);
      depositField.value = val;
      console.log('Set depositTotalProbable to:', val);
    }
    if (depositAmtCombinedField) {
      const val = Number.isInteger(depositAmtCombined) ? String(depositAmtCombined) : depositAmtCombined.toFixed(2);
      depositAmtCombinedField.value = val;
      console.log('Set depositMaxSingleCombined to:', val);
    }
    if (withdrawalField) {
      const val = Number.isInteger(withdrawalSum) ? String(withdrawalSum) : withdrawalSum.toFixed(2);
      withdrawalField.value = val;
      console.log('Set withdrawalTotalProbable to:', val);
    }
    if (withdrawalAmtCombinedField) {
      const val = Number.isInteger(withdrawalAmtCombined) ? String(withdrawalAmtCombined) : withdrawalAmtCombined.toFixed(2);
      withdrawalAmtCombinedField.value = val;
      console.log('Set withdrawalMaxSingleCombined to:', val);
    }
  }

  // Recompute overall totals when individual totals change
  ['depositCashTotal','depositTransferTotal','depositRemittanceTotal','withdrawalCashTotal','withdrawalTransferTotal','withdrawalRemittanceTotal'].forEach(name => {
    const el = form.elements[name];
    if (el) {
      el.addEventListener('input', computeOverallTotals);
      el.addEventListener('change', computeOverallTotals);
    }
  });

  // Also listen to amount fields to trigger sum updates
  ['depositCashAmount','depositTransferAmount','depositRemittanceAmount','withdrawalCashAmount','withdrawalTransferAmount','withdrawalRemittanceAmount'].forEach(name => {
    const el = form.elements[name];
    if (el) {
      el.addEventListener('input', computeOverallTotals);
      el.addEventListener('change', computeOverallTotals);
    }
  });

  // Wrap calculateTransactionTotals in a debounce to avoid rapid multiple calls
  let totalComputeTimeout;
  const debouncedComputeTotals = () => {
    clearTimeout(totalComputeTimeout);
    totalComputeTimeout = setTimeout(() => {
      try {
        // Recalculate individual totals (count × amount) which will call computeOverallTotals()
        if (typeof calculateTransactionTotals === 'function') calculateTransactionTotals();
      } catch (e) {}
      // Update popup when transaction fields change
      try { if (typeof updateOthersPopupData === 'function') updateOthersPopupData(); } catch (e) {}
    }, 100);
  };

  // Re-attach listeners using debounced version for efficiency
  ['depositCashTotal','depositTransferTotal','depositRemittanceTotal','withdrawalCashTotal','withdrawalTransferTotal','withdrawalRemittanceTotal'].forEach(name => {
    const el = form.elements[name];
    if (el) {
      el.removeEventListener('input', computeOverallTotals);
      el.removeEventListener('change', computeOverallTotals);
      el.addEventListener('input', debouncedComputeTotals);
      el.addEventListener('change', debouncedComputeTotals);
    }
  });

  ['depositCashAmount','depositTransferAmount','depositRemittanceAmount','withdrawalCashAmount','withdrawalTransferAmount','withdrawalRemittanceAmount'].forEach(name => {
    const el = form.elements[name];
    if (el) {
      el.addEventListener('input', debouncedComputeTotals);
      el.addEventListener('change', debouncedComputeTotals);
    }
  });

  // Initial compute on load: calculate individual totals and overall summaries
  if (typeof calculateTransactionTotals === 'function') calculateTransactionTotals();

  // Link numberOfDepositWithdrawal to Cash and Transfer count fields
  function syncNumberOfDepositWithdrawal(e) {
    // Get the value from the input that triggered this event, or from the first input with this name
    let numVal = '';
    if (e && e.target && e.target.value !== undefined) {
      numVal = e.target.value;
    } else {
      // Fallback: get from first input with this name
      const inputs = document.querySelectorAll('input[name="numberOfDepositWithdrawal"]');
      if (inputs.length > 0) numVal = inputs[0].value || '';
    }
    // Sync all inputs with same name to have same value
    document.querySelectorAll('input[name="numberOfDepositWithdrawal"]').forEach(inp => {
      if (inp.value !== numVal) inp.value = numVal;
    });
    // Deposit counts
    if (form.elements['depositCashCount']) form.elements['depositCashCount'].value = numVal;
    if (form.elements['depositTransferCount']) form.elements['depositTransferCount'].value = numVal;
    // Withdrawal counts
    if (form.elements['withdrawalCashCount']) form.elements['withdrawalCashCount'].value = numVal;
    if (form.elements['withdrawalTransferCount']) form.elements['withdrawalTransferCount'].value = numVal;
    // Trigger recalculation
    if (typeof calculateTransactionTotals === 'function') calculateTransactionTotals();
    if (typeof updateOverlays === 'function') updateOverlays();
  }
  // Listen to all numberOfDepositWithdrawal inputs (KYC and Transaction Profile sections)
  document.querySelectorAll('input[name="numberOfDepositWithdrawal"]').forEach(input => {
    input.addEventListener('input', syncNumberOfDepositWithdrawal);
    input.addEventListener('change', syncNumberOfDepositWithdrawal);
  });

  // If present address parts change and nominee-same is checked, update nominee address live
  ['presentHouse','presentRoad','presentPO','presentPostCode','presentThana','presentDistrict'].forEach(name => {
    const el = form.elements[name];
    if (el) el.addEventListener('input', () => {
      if (nomineeSameCheckbox && nomineeSameCheckbox.checked) handleNomineeSameAddress();
      if (guardianSameCheckbox && guardianSameCheckbox.checked) handleGuardianSameAddress();
    });
  });

  // Keyboard shortcuts
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closePresetsPanel();
    }
  });

  // Initialize
  initializeOverlays();
  loadFormData();
  // If loading from storage changed the main branch field, keep slide input in sync
  try {
    const branchInputMain = form.elements['branchName'];
    if (slideBranchInput && branchInputMain) {
      // If FORM_KEY load cleared branch but we have a separately saved branch, restore it
      const savedBranch = (() => { try { return localStorage.getItem('ucb_branch_name_v1'); } catch (e) { return null; } })();
      if ((!branchInputMain.value || String(branchInputMain.value).trim() === '') && savedBranch) {
        branchInputMain.value = savedBranch;
        slideBranchInput.value = savedBranch;
      } else {
        slideBranchInput.value = branchInputMain.value || '';
      }
    }
  } catch (e) {}
  // Apply ownership & nominee-same visibility before rendering overlays
  try { handleOwnershipChange(); } catch (e) {}
  try { handleNomineeSameAddress(); } catch (e) {}
  try { handleGuardianSameAddress(); } catch (e) {}
  updateOverlays();

  // Set initial nav visibility: show the button to switch to the other page
  try { switchPage('info'); } catch (e) { /* ignore if switchPage not ready */ }

  // Ensure all pages are visible in the preview (user requested "show all pages")
  formPages.forEach(page => page.classList.add('active'));

  // Apply form type visibility
  try { handleFormTypeChange(); } catch (e) {}

  // Left Slide Menu Toggle Logic
  const slideMenuToggle = document.getElementById('slideMenuToggle');
  const slideMenu = document.getElementById('slideMenu');
  const slideMenuBackdrop = document.getElementById('slideMenuBackdrop');
  const slideMenuClose = document.getElementById('slideMenuClose');

  function openSlideMenu() {
    slideMenu.classList.add('open');
    slideMenuBackdrop.classList.add('show');
  }
  function closeSlideMenu() {
    slideMenu.classList.remove('open');
    slideMenuBackdrop.classList.remove('show');
  }

  if (slideMenuToggle) slideMenuToggle.addEventListener('click', openSlideMenu);
  if (slideMenuClose) slideMenuClose.addEventListener('click', closeSlideMenu);
  if (slideMenuBackdrop) slideMenuBackdrop.addEventListener('click', closeSlideMenu);

  // Account Type Popup
  const accountTypeBackdrop = document.getElementById('accountTypeBackdrop');
  const accountTypeClose = document.getElementById('accountTypeClose');
  const slideMenuAccountType = document.getElementById('slideMenuAccountType');

  function openAccountTypePopup() {
    accountTypeBackdrop.classList.add('show');
  }
  function closeAccountTypePopup() {
    accountTypeBackdrop.classList.remove('show');
  }

  if (slideMenuAccountType) {
    slideMenuAccountType.addEventListener('click', (e) => {
      e.preventDefault();
      closeSlideMenu();
      openAccountTypePopup();
    });
  }
  if (accountTypeClose) accountTypeClose.addEventListener('click', closeAccountTypePopup);
  if (accountTypeBackdrop) {
    accountTypeBackdrop.addEventListener('click', (e) => {
      if (e.target === accountTypeBackdrop) closeAccountTypePopup();
    });
  }

  // Officer Seal Popup
  const officerSealBackdrop = document.getElementById('officerSealBackdrop');
  const officerSealClose = document.getElementById('officerSealClose');
  const slideMenuOfficerSeal = document.getElementById('slideMenuOfficerSeal');
  const officer1Input = document.getElementById('officer1Name');
  const officer2Input = document.getElementById('officer2Name');
  const officer3Input = document.getElementById('officer3Name');
  const sealPreview1 = document.getElementById('sealPreview1');
  const sealPreview2 = document.getElementById('sealPreview2');
  const sealPreview3 = document.getElementById('sealPreview3');
  const saveOfficerSealBtn = document.getElementById('saveOfficerSealBtn');
  const officerSealSizeInput = document.getElementById('officerSealSize');
  const officerSealSizeValue = document.getElementById('officerSealSizeValue');
  const OFFICER_SEALS_KEY = 'ucb_officer_seals_v1';

  function openOfficerSealPopup() {
    // Load saved seals
    const savedSeals = JSON.parse(localStorage.getItem(OFFICER_SEALS_KEY) || '{}');
    if (officer1Input) officer1Input.value = savedSeals.officer1 || '';
    if (officer2Input) officer2Input.value = savedSeals.officer2 || '';
    if (officer3Input) officer3Input.value = savedSeals.officer3 || '';
    // Load saved size (fallback to 140)
    const savedSize = parseInt(savedSeals.size || 140, 10) || 140;
    if (officerSealSizeInput) officerSealSizeInput.value = savedSize;
    if (officerSealSizeValue) officerSealSizeValue.textContent = savedSize + 'px';
    updateSealPreviews();
    officerSealBackdrop.classList.add('show');
  }
  function closeOfficerSealPopup() {
    officerSealBackdrop.classList.remove('show');
  }
  function updateSealPreviews() {
    const text1 = officer1Input ? officer1Input.value || 'Officer 1' : 'Officer 1';
    const text2 = officer2Input ? officer2Input.value || 'Officer 2' : 'Officer 2';
    const text3 = officer3Input ? officer3Input.value || 'Officer 3' : 'Officer 3';
    const sizeVal = officerSealSizeInput ? parseInt(officerSealSizeInput.value || 140, 10) : 140;
    // Render seals wider than tall: width = size * 1.6 (rectangular stamp)
    const widthVal = Math.round(sizeVal * 1.6);
    const fontSizeRem = 0.65 * (sizeVal / 140);
    if (sealPreview1) {
      const preview1 = sealPreview1.querySelector('.seal-item-text');
      if (preview1) preview1.textContent = text1;
      sealPreview1.style.width = widthVal + 'px';
      sealPreview1.style.height = sizeVal + 'px';
      sealPreview1.style.fontSize = fontSizeRem + 'rem';
      sealPreview1.style.padding = Math.max(8, Math.round(sizeVal * 0.06)) + 'px';
    }
    if (sealPreview2) {
      const preview2 = sealPreview2.querySelector('.seal-item-text');
      if (preview2) preview2.textContent = text2;
      sealPreview2.style.width = widthVal + 'px';
      sealPreview2.style.height = sizeVal + 'px';
      sealPreview2.style.fontSize = fontSizeRem + 'rem';
      sealPreview2.style.padding = Math.max(8, Math.round(sizeVal * 0.06)) + 'px';
    }
    if (sealPreview3) {
      const preview3 = sealPreview3.querySelector('.seal-item-text');
      if (preview3) preview3.textContent = text3;
      sealPreview3.style.width = widthVal + 'px';
      sealPreview3.style.height = sizeVal + 'px';
      sealPreview3.style.fontSize = fontSizeRem + 'rem';
      sealPreview3.style.padding = Math.max(8, Math.round(sizeVal * 0.06)) + 'px';
    }
    if (officerSealSizeValue) officerSealSizeValue.textContent = sizeVal + 'px';
  }
  function saveOfficerSeals() {
    const seals = {
      officer1: officer1Input ? officer1Input.value : '',
      officer2: officer2Input ? officer2Input.value : '',
      officer3: officer3Input ? officer3Input.value : '',
      size: officerSealSizeInput ? parseInt(officerSealSizeInput.value || 140, 10) : 140
    };
    localStorage.setItem(OFFICER_SEALS_KEY, JSON.stringify(seals));
    showToast('Officer seals saved!');
    closeOfficerSealPopup();
  }

  if (slideMenuOfficerSeal) {
    slideMenuOfficerSeal.addEventListener('click', (e) => {
      e.preventDefault();
      closeSlideMenu();
      openOfficerSealPopup();
    });
  }
  if (officerSealClose) officerSealClose.addEventListener('click', closeOfficerSealPopup);
  if (officerSealBackdrop) {
    officerSealBackdrop.addEventListener('click', (e) => {
      if (e.target === officerSealBackdrop) closeOfficerSealPopup();
    });
  }
  if (officer1Input) officer1Input.addEventListener('input', updateSealPreviews);
  if (officer2Input) officer2Input.addEventListener('input', updateSealPreviews);
  if (officer3Input) officer3Input.addEventListener('input', updateSealPreviews);
  if (officerSealSizeInput) officerSealSizeInput.addEventListener('input', updateSealPreviews);
  if (saveOfficerSealBtn) saveOfficerSealBtn.addEventListener('click', saveOfficerSeals);

  // Account Type CRUD functionality
  const ACCOUNT_TYPES_KEY = 'ucb_account_types_v1';
  const accountTypeTableBody = document.getElementById('accountTypeTableBody');
  const accountTypeEmpty = document.getElementById('accountTypeEmpty');
  const accountTypeCodeInput = document.getElementById('accountTypeCode');
  const accountTypeNameInput = document.getElementById('accountTypeName');
  const addAccountTypeBtn = document.getElementById('addAccountTypeBtn');

  let accountTypes = JSON.parse(localStorage.getItem(ACCOUNT_TYPES_KEY) || '[]');
  // Seed default account types if none exist
  function seedDefaultAccountTypes() {
    accountTypes = [
      { code: '3201', name: 'Savings' },
      { code: '3209', name: 'Woman Savings' },
      { code: '3211', name: 'Dynamic Savings' },
      { code: '3210', name: 'Imperial Savings' },
      { code: '3206', name: 'Youngstars Savings' },
      { code: '3249', name: 'Mudarabah Savings' },
      { code: '3241', name: 'Mudarabah Savings' },
      { code: '3245', name: 'Mudarabah Imperial Savings' },
      { code: '3215', name: 'Retail Shomota Account' },
      { code: '2113', name: 'Current' }
    ];
    saveAccountTypes();
  }
  if (!accountTypes || accountTypes.length === 0) {
    seedDefaultAccountTypes();
  }
  let editingIndex = -1;

  function saveAccountTypes() {
    localStorage.setItem(ACCOUNT_TYPES_KEY, JSON.stringify(accountTypes));
  }

  function renderAccountTypes() {
    accountTypeTableBody.innerHTML = '';
    if (accountTypes.length === 0) {
      accountTypeEmpty.style.display = 'block';
      return;
    }
    accountTypeEmpty.style.display = 'none';
    accountTypes.forEach((item, index) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${escapeHtml(item.code)}</td>
        <td>${escapeHtml(item.name)}</td>
        <td class="action-btns">
          <button class="btn-edit" data-index="${index}" title="Edit"><i class="fas fa-edit"></i></button>
          <button class="btn-delete" data-index="${index}" title="Delete"><i class="fas fa-trash"></i></button>
        </td>
      `;
      accountTypeTableBody.appendChild(tr);
    });

    // Attach edit/delete handlers
    accountTypeTableBody.querySelectorAll('.btn-edit').forEach(btn => {
      btn.addEventListener('click', () => {
        const idx = parseInt(btn.dataset.index);
        editingIndex = idx;
        accountTypeCodeInput.value = accountTypes[idx].code;
        accountTypeNameInput.value = accountTypes[idx].name;
        addAccountTypeBtn.innerHTML = '<i class="fas fa-save"></i> Update';
        accountTypeCodeInput.focus();
      });
    });
    accountTypeTableBody.querySelectorAll('.btn-delete').forEach(btn => {
      btn.addEventListener('click', () => {
        const idx = parseInt(btn.dataset.index);
        if (confirm('Delete this account type?')) {
          accountTypes.splice(idx, 1);
          saveAccountTypes();
          renderAccountTypes();
          resetAccountTypeForm();
        }
      });
    });
  }

  function escapeHtml(str) {
    const div = document.createElement('div');
    div.textContent = str;
    return div.innerHTML;
  }

  function resetAccountTypeForm() {
    accountTypeCodeInput.value = '';
    accountTypeNameInput.value = '';
    editingIndex = -1;
    addAccountTypeBtn.innerHTML = '<i class="fas fa-plus"></i> Add';
  }

  addAccountTypeBtn.addEventListener('click', () => {
    const code = accountTypeCodeInput.value.trim();
    const name = accountTypeNameInput.value.trim();
    if (!code || !name) {
      showToast('Please fill in both fields', 'warning');
      return;
    }
    if (editingIndex >= 0) {
      // Update existing
      accountTypes[editingIndex] = { code, name };
    } else {
      // Add new
      accountTypes.push({ code, name });
    }
    saveAccountTypes();
    renderAccountTypes();
    resetAccountTypeForm();
    showToast(editingIndex >= 0 ? 'Account type updated!' : 'Account type added!', 'success');
  });

  // Initialize account types table
  renderAccountTypes();

  // Close menu when a nav link is clicked and scroll to section
  document.querySelectorAll('.slide-menu-nav a').forEach(link => {
    link.addEventListener('click', (e) => {
      closeSlideMenu();
      // Smooth scroll handled by browser if section ids exist
    });
  });

  // Section collapse/expand toggle
  document.querySelectorAll('.form-section .section-header').forEach(header => {
    header.addEventListener('click', () => {
      const section = header.closest('.form-section');
      section.classList.toggle('collapsed');
    });
  });

  // Initialize all sections as collapsed on app load
  document.querySelectorAll('.form-section').forEach(section => {
    section.classList.add('collapsed');
  });

  // Others Popup Functionality (editable fields)
  const othersBtn = document.getElementById('othersBtn');
  const othersBackdrop = document.getElementById('othersBackdrop');
  const othersClose = document.getElementById('othersClose');

  function openOthersPopup() {
    if (!othersBackdrop) return;
    othersBackdrop.classList.add('open');
    updateOthersPopupData();
  }

  function closeOthersPopup() {
    if (!othersBackdrop) return;
    othersBackdrop.classList.remove('open');
  }

  // Create or update a text input (or textarea) inside a popup container and sync with form
  function makeEditableInput(containerId, formFieldName, value, isTextarea, onChangeCallback) {
    const container = document.getElementById(containerId);
    if (!container) return;
    let input = container.querySelector('input, textarea');
    if (!input) {
      input = isTextarea ? document.createElement('textarea') : document.createElement('input');
      if (!isTextarea) input.type = 'text';
      input.className = 'others-input';
      container.innerHTML = '';
      container.appendChild(input);
    }
    if (input.value !== value) input.value = value;
    input.addEventListener('input', () => {
      try {
        // When there are multiple elements with the same name, update all of them
        const formEls = form.elements[formFieldName];
        if (formEls) {
          if (formEls.length) {
            // Multiple elements with same name - update all
            for (let i = 0; i < formEls.length; i++) {
              formEls[i].value = input.value;
            }
          } else {
            // Single element
            formEls.value = input.value;
          }
        }
      } catch (e) {}
      try { if (typeof updateOverlays === 'function') updateOverlays(); } catch (e) {}
      try { if (onChangeCallback && typeof onChangeCallback === 'function') onChangeCallback({ target: input }); } catch (e) {}
    });
  }

  // Create or update a select inside a popup container by cloning options from a source select (from the form)
  function makeEditableSelect(containerId, formFieldName, sourceSelectName) {
    const container = document.getElementById(containerId);
    if (!container) return;
    let select = container.querySelector('select');
    const source = form ? form.elements[sourceSelectName] : null;
    if (!select) {
      select = document.createElement('select');
      select.className = 'others-input';
      container.innerHTML = '';
      container.appendChild(select);
    }
    // Populate options from source select if available
    if (source && source.options) {
      // only rebuild if different length (avoid losing cursor)
      if (select.options.length !== source.options.length) {
        select.innerHTML = '';
        Array.from(source.options).forEach(opt => {
          const o = document.createElement('option');
          o.value = opt.value;
          o.textContent = opt.textContent;
          select.appendChild(o);
        });
      }
      select.value = source.value || '';
    } else {
      // fallback: if the form has a corresponding element value, show it as a single option
      const fallbackVal = form && form.elements[formFieldName] ? form.elements[formFieldName].value : '';
      if (select.options.length === 0) {
        select.innerHTML = '';
        const o = document.createElement('option');
        o.value = fallbackVal || '';
        o.textContent = fallbackVal || '—';
        select.appendChild(o);
      }
      select.value = fallbackVal || '';
    }

    select.addEventListener('change', () => {
      try { if (form && form.elements[formFieldName]) form.elements[formFieldName].value = select.value; } catch (e) {}
      try {
        // If user selects Client's Profession, reset Client's Business and vice-versa
        if (form) {
          if (formFieldName === 'clientProfession' && form.elements['clientBusiness']) {
            form.elements['clientBusiness'].value = '';
          } else if (formFieldName === 'clientBusiness' && form.elements['clientProfession']) {
            form.elements['clientProfession'].value = '';
          }
        }
      } catch (e) {}
      try { if (typeof updateOverlays === 'function') updateOverlays(); } catch (e) {}
      try { if (typeof updateOthersPopupData === 'function') updateOthersPopupData(); } catch (e) {}
    });
  }

  function updateOthersPopupData() {
    // Basic fields
    const accountNumber = form.elements['accountNumber']?.value || '';
    const fullName = form.elements['fullNameEn']?.value || '';
    const nid = form.elements['nid']?.value || '';
    // occupation maps: personal 'occupation' (detailed) and kyc 'occupationProfession'
    const occupationPersonal = form.elements['occupation']?.value || '';
    const occupationKyc = form.elements['occupationProfession']?.value || '';

    // KYC fields and selects
    const transection = form.elements['transectionProfile']?.value || '';
    const sectorCode = form.elements['sectorCode']?.value || '';
    const sourceOfFund = form.elements['sourceOfFund']?.value || '';
    const sourceOfFundsVerify = form.elements['sourceOfFundsVerify']?.value || '';

    // Build editable fields in the popup and sync
    makeEditableInput('othersAccountNumber', 'accountNumber', accountNumber, false);
    makeEditableInput('othersFullName', 'fullNameEn', fullName, false);
    makeEditableInput('othersNID', 'nid', nid, false);
    // Birth cert and passport
    makeEditableInput('othersBirthCertNo', 'birthCertNo', form.elements['birthCertNo']?.value || '', false);
    makeEditableInput('othersPassportNo', 'passportNo', form.elements['passportNo']?.value || '', false);
    // For the basic Occupation show personal occupation if present else KYC occupation
    // Use single-line inputs to match Transection Profile size
    makeEditableInput('othersOccupation', 'occupation', occupationPersonal || occupationKyc, false);
    // Monthly Income (BDT) — show and sync with main form
    makeEditableInput('othersMonthlyIncome', 'monthlyIncome', form.elements['monthlyIncome']?.value || '', false);
    // Number of Deposit/Withdrawal — show and sync with main form, also trigger count sync
    makeEditableInput('othersNumberOfDepositWithdrawal', 'numberOfDepositWithdrawal', form.elements['numberOfDepositWithdrawal']?.value || '', false, typeof syncNumberOfDepositWithdrawal === 'function' ? syncNumberOfDepositWithdrawal : null);

    // KYC editable fields (clone selects where appropriate)
    // Use single-line input for occupation to match Transection Profile
    makeEditableInput('kycOccupationProfession', 'occupationProfession', occupationKyc, false);
    makeEditableInput('kycTransection', 'transectionProfile', transection, false, syncTransectionProfile);
    // Sector Code in popup: mirror same hint as main form
    makeEditableInput('kycSectorCode', 'sectorCode', sectorCode, false);
    const popupSectorContainer = document.getElementById('kycSectorCode');
    if (popupSectorContainer) {
      const popupSectorInput = popupSectorContainer.querySelector('input');
      if (popupSectorInput) {
        popupSectorInput.setAttribute('list', 'sectorCodeHints');
      }
    }
    makeEditableSelect('kycClientBusiness', 'clientBusiness', 'clientBusiness');
    makeEditableSelect('kycClientProfession', 'clientProfession', 'clientProfession');
    makeEditableSelect('kycTypeOfOnboarding', 'typeOfOnboardingScore', 'typeOfOnboardingScore');
    makeEditableSelect('kycPepIpCeo', 'pepIpCeo', 'pepIpCeo');
    makeEditableSelect('kycCloseAssociatePep', 'closeAssociatePepIpCeo', 'closeAssociatePepIpCeo');
    makeEditableSelect('kycAvgYearlyTransaction', 'avgYearlyTransaction', 'avgYearlyTransaction');
    makeEditableSelect('kycCredibleSourceOfFunds', 'credibleSourceOfFunds', 'credibleSourceOfFunds');
    makeEditableInput('kycSourceOfFundsVerify', 'sourceOfFundsVerify', sourceOfFundsVerify, false);
    makeEditableSelect('kycBeneficialOwners', 'beneficialOwners', 'beneficialOwners');
    makeEditableInput('kycSourceOfFund', 'sourceOfFund', sourceOfFund, false);
  }

  if (othersBtn) {
    othersBtn.addEventListener('click', openOthersPopup);
  }

  if (othersClose) {
    othersClose.addEventListener('click', closeOthersPopup);
  }

  if (othersBackdrop) {
    othersBackdrop.addEventListener('click', (e) => {
      if (e.target === othersBackdrop) closeOthersPopup();
    });
  }

  // Update Others popup when form data changes
  if (form) {
    form.addEventListener('change', updateOthersPopupData);
    form.addEventListener('input', updateOthersPopupData);

    // Ensure selecting one of the KYC selects clears the other on the main form
    try {
      const prof = form.elements['clientProfession'];
      const bus = form.elements['clientBusiness'];
      if (prof) {
        prof.addEventListener('change', () => {
          try { if (bus) bus.value = ''; } catch(e) {}
          try { if (typeof updateOthersPopupData === 'function') updateOthersPopupData(); } catch(e) {}
        });
      }
      if (bus) {
        bus.addEventListener('change', () => {
          try { if (prof) prof.value = ''; } catch(e) {}
          try { if (typeof updateOthersPopupData === 'function') updateOthersPopupData(); } catch(e) {}
        });
      }
    } catch(e) {}
  }

})();
  </script>
  <script>
    (function() {
      const nomineeDobEl = document.querySelector('input[name="nomineeDob"]');
      const guardianSection = document.getElementById('guardian-info');

      function updateGuardianVisibility() {
        try {
          if (!guardianSection) return;
          const val = nomineeDobEl && nomineeDobEl.value ? nomineeDobEl.value : '';
          if (!val) {
            guardianSection.style.display = 'none';
            return;
          }
          const dob = new Date(val);
          if (isNaN(dob.getTime())) {
            guardianSection.style.display = 'none';
            return;
          }
          const today = new Date();
          let age = today.getFullYear() - dob.getFullYear();
          const m = today.getMonth() - dob.getMonth();
          if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) age--;
          guardianSection.style.display = (age < 18) ? '' : 'none';
        } catch (e) {
          console.error('updateGuardianVisibility error', e);
        }
      }

      if (nomineeDobEl) {
        nomineeDobEl.addEventListener('change', updateGuardianVisibility);
        nomineeDobEl.addEventListener('input', updateGuardianVisibility);
      }
      // Run immediately and after DOM content loaded to cover timing
      document.addEventListener('DOMContentLoaded', updateGuardianVisibility);
      setTimeout(updateGuardianVisibility, 200);
      // Introducer visibility: show when Personal Information NID is empty
      const nidEl = document.querySelector('input[name="nid"]');
      const introducerSection = document.getElementById('introducer-info');

      function updateIntroducerVisibility() {
        try {
          if (!introducerSection) return;
          const nidVal = nidEl && nidEl.value ? String(nidEl.value).trim() : '';
          introducerSection.style.display = (!nidVal) ? '' : 'none';
        } catch (e) {
          console.error('updateIntroducerVisibility error', e);
        }
      }

      if (nidEl) {
        nidEl.addEventListener('change', updateIntroducerVisibility);
        nidEl.addEventListener('input', updateIntroducerVisibility);
      }
      document.addEventListener('DOMContentLoaded', updateIntroducerVisibility);
      setTimeout(updateIntroducerVisibility, 200);
    })();
  </script>
</body>
</html>
